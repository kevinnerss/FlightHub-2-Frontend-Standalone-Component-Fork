{"ast":null,"code":"import { createRouter, createWebHistory } from 'vue-router';\n\n// Lazy-loaded route components\nconst Login = () => import('../views/Login.vue');\nconst UserManagement = () => import('../views/UserManagement.vue');\nconst DjiDashboard = () => import('../views/DjiDashboard.vue');\nconst AlarmManagement = () => import('../views/AlarmManagement.vue');\nconst AlarmStats = () => import('../views/AlarmStats.vue');\nconst routes = [{\n  path: '/login',\n  name: 'Login',\n  component: Login,\n  meta: {\n    title: '\\u767b\\u5f55',\n    requiresAuth: false\n  }\n}, {\n  path: '/user-management',\n  name: 'UserManagement',\n  component: UserManagement,\n  meta: {\n    title: '\\u4eba\\u5458\\u7ba1\\u7406',\n    requiresAuth: true,\n    requiresAdmin: true\n  }\n}, {\n  path: '/',\n  name: 'DjiDashboard',\n  component: DjiDashboard,\n  meta: {\n    title: '\\u4e3b\\u63a7\\u53f0',\n    requiresAuth: true\n  }\n}, {\n  path: '/alarm-management',\n  name: 'AlarmManagement',\n  component: AlarmManagement,\n  meta: {\n    title: '\\u544a\\u8b66\\u7ba1\\u7406',\n    requiresAuth: true\n  }\n}, {\n  path: '/alarm-stats',\n  name: 'AlarmStats',\n  component: AlarmStats,\n  meta: {\n    title: '\\u544a\\u8b66\\u7edf\\u8ba1',\n    requiresAuth: true\n  }\n},\n// 404 page\n{\n  path: '/:pathMatch(.*)*',\n  redirect: '/'\n}];\nconst router = createRouter({\n  history: createWebHistory(process.env.BASE_URL),\n  routes\n});\n\n// Global guard - authentication and authorization\nrouter.beforeEach((to, from, next) => {\n  // Set page title\n  document.title = to.meta.title || '\\u65e0\\u4eba\\u673a\\u5de1\\u68c0\\u6570\\u5b57\\u5b6a\\u751f\\u7cfb\\u7edf';\n\n  // Authentication state\n  const isAuthenticated = localStorage.getItem('token') !== null;\n\n  // Require authentication\n  if (to.meta.requiresAuth && !isAuthenticated) {\n    return next({\n      name: 'Login',\n      query: {\n        redirect: to.fullPath\n      }\n    });\n  }\n\n  // Require admin role\n  if (to.meta.requiresAdmin) {\n    const userStr = localStorage.getItem('userInfo');\n    let isAdmin = false;\n    if (userStr) {\n      try {\n        const userInfo = JSON.parse(userStr);\n        isAdmin = userInfo.role === 'admin';\n      } catch (e) {\n        console.error('Failed to parse user info:', e);\n      }\n    }\n    if (!isAdmin) {\n      return next({\n        name: 'DjiDashboard'\n      });\n    }\n  }\n\n  // Redirect authenticated users away from login\n  if (to.name === 'Login' && isAuthenticated) {\n    return next({\n      name: 'DjiDashboard'\n    });\n  }\n  next();\n});\nexport default router;","map":{"version":3,"names":["createRouter","createWebHistory","Login","UserManagement","DjiDashboard","AlarmManagement","AlarmStats","routes","path","name","component","meta","title","requiresAuth","requiresAdmin","redirect","router","history","process","env","BASE_URL","beforeEach","to","from","next","document","isAuthenticated","localStorage","getItem","query","fullPath","userStr","isAdmin","userInfo","JSON","parse","role","e","console","error"],"sources":["D:/projects/FlightHub-2-Frontend-Standalone-Component/frontend/src/router/index.js"],"sourcesContent":["import { createRouter, createWebHistory } from 'vue-router'\r\n\r\n// Lazy-loaded route components\r\nconst Login = () => import('../views/Login.vue')\r\nconst UserManagement = () => import('../views/UserManagement.vue')\r\nconst DjiDashboard = () => import('../views/DjiDashboard.vue')\r\nconst AlarmManagement = () => import('../views/AlarmManagement.vue')\r\nconst AlarmStats = () => import('../views/AlarmStats.vue')\r\n\r\nconst routes = [\r\n  {\r\n    path: '/login',\r\n    name: 'Login',\r\n    component: Login,\r\n    meta: {\r\n      title: '\\u767b\\u5f55',\r\n      requiresAuth: false\r\n    }\r\n  },\r\n  \r\n  {\r\n    path: '/user-management',\r\n    name: 'UserManagement',\r\n    component: UserManagement,\r\n    meta: {\r\n      title: '\\u4eba\\u5458\\u7ba1\\u7406',\r\n      requiresAuth: true,\r\n      requiresAdmin: true\r\n    }\r\n  },\r\n\r\n  {\r\n    path: '/',\r\n    name: 'DjiDashboard',\r\n    component: DjiDashboard,\r\n    meta: {\r\n      title: '\\u4e3b\\u63a7\\u53f0',\r\n      requiresAuth: true\r\n    }\r\n  },\r\n\r\n  {\r\n    path: '/alarm-management',\r\n    name: 'AlarmManagement',\r\n    component: AlarmManagement,\r\n    meta: {\r\n      title: '\\u544a\\u8b66\\u7ba1\\u7406',\r\n      requiresAuth: true\r\n    }\r\n  },\r\n\r\n  {\r\n    path: '/alarm-stats',\r\n    name: 'AlarmStats',\r\n    component: AlarmStats,\r\n    meta: {\r\n      title: '\\u544a\\u8b66\\u7edf\\u8ba1',\r\n      requiresAuth: true\r\n    }\r\n  },\r\n\r\n  \r\n  // 404 page\r\n  {\r\n    path: '/:pathMatch(.*)*',\r\n    redirect: '/'\r\n  }\r\n]\r\n\r\nconst router = createRouter({\r\n  history: createWebHistory(process.env.BASE_URL),\r\n  routes\r\n})\r\n\r\n// Global guard - authentication and authorization\r\nrouter.beforeEach((to, from, next) => {\r\n  // Set page title\r\n  document.title = to.meta.title || '\\u65e0\\u4eba\\u673a\\u5de1\\u68c0\\u6570\\u5b57\\u5b6a\\u751f\\u7cfb\\u7edf'\r\n  \r\n  // Authentication state\r\n  const isAuthenticated = localStorage.getItem('token') !== null\r\n  \r\n  // Require authentication\r\n  if (to.meta.requiresAuth && !isAuthenticated) {\r\n    return next({ name: 'Login', query: { redirect: to.fullPath } })\r\n  }\r\n  \r\n  // Require admin role\r\n  if (to.meta.requiresAdmin) {\r\n    const userStr = localStorage.getItem('userInfo')\r\n    let isAdmin = false\r\n    \r\n    if (userStr) {\r\n      try {\r\n        const userInfo = JSON.parse(userStr)\r\n        isAdmin = userInfo.role === 'admin'\r\n      } catch (e) {\r\n        console.error('Failed to parse user info:', e)\r\n      }\r\n    }\r\n    \r\n    if (!isAdmin) {\r\n      return next({ name: 'DjiDashboard' })\r\n    }\r\n  }\r\n  \r\n  // Redirect authenticated users away from login\r\n  if (to.name === 'Login' && isAuthenticated) {\r\n    return next({ name: 'DjiDashboard' })\r\n  }\r\n  \r\n  next()\r\n})\r\n\r\nexport default router\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}