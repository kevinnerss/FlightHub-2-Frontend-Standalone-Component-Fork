{"ast":null,"code":"export default {\n  name: 'MonitorPanel',\n  props: {\n    videoStreamUrl: {\n      type: String,\n      default: ''\n    },\n    isStreaming: {\n      type: Boolean,\n      default: false\n    },\n    droneStatus: {\n      type: String,\n      default: '待命'\n    },\n    batteryLevel: {\n      type: Number,\n      default: 100\n    },\n    altitude: {\n      type: Number,\n      default: 0\n    },\n    speed: {\n      type: Number,\n      default: 0\n    }\n  },\n  data() {\n    return {\n      videoErrorMessage: '',\n      // 默认的占位图像\n      defaultImage: 'https://picsum.photos/1280/720?random=default'\n    };\n  },\n  computed: {\n    // 安全的无人机状态\n    safeDroneStatus() {\n      return typeof this.droneStatus === 'string' && this.droneStatus.trim() ? this.droneStatus : '待命';\n    },\n    // 安全的电池电量\n    safeBatteryLevel() {\n      const level = Number(this.batteryLevel);\n      return isNaN(level) ? 100 : level;\n    },\n    // 安全的高度\n    safeAltitude() {\n      const alt = Number(this.altitude);\n      return isNaN(alt) ? 0 : alt;\n    },\n    // 安全的速度\n    safeSpeed() {\n      const spd = Number(this.speed);\n      return isNaN(spd) ? 0 : spd;\n    },\n    // 净化后的视频URL\n    sanitizedVideoUrl() {\n      if (typeof this.videoStreamUrl === 'string' && this.videoStreamUrl.trim()) {\n        return this.videoStreamUrl;\n      }\n      return this.isStreaming ? this.defaultImage : '';\n    }\n  },\n  methods: {\n    // 处理刷新视频流\n    handleRefreshStream() {\n      this.videoErrorMessage = '';\n      this.$emit('refresh-stream');\n    },\n    // 处理图像加载错误\n    handleImageError(event) {\n      console.error('视频流加载失败:', event);\n      this.videoErrorMessage = '视频流加载失败';\n      // 如果有错误，使用默认图像作为后备\n      event.target.src = this.defaultImage;\n    },\n    // 获取状态对应的颜色类\n    getStatusColorClass(status) {\n      const statusMap = {\n        '待命': 'bg-green-500',\n        '飞行中': 'bg-blue-500',\n        '暂停': 'bg-yellow-500',\n        '已停止': 'bg-red-500',\n        '返回中': 'bg-red-500'\n      };\n      return statusMap[status] || 'bg-gray-500';\n    },\n    // 获取电池对应的颜色类\n    getBatteryColorClass(level) {\n      if (level > 70) return 'bg-green-500';\n      if (level > 30) return 'bg-yellow-500';\n      return 'bg-red-500';\n    },\n    // 格式化数字，保留一位小数\n    formatNumber(num) {\n      return Number(num).toFixed(1);\n    }\n  }\n};","map":{"version":3,"names":["name","props","videoStreamUrl","type","String","default","isStreaming","Boolean","droneStatus","batteryLevel","Number","altitude","speed","data","videoErrorMessage","defaultImage","computed","safeDroneStatus","trim","safeBatteryLevel","level","isNaN","safeAltitude","alt","safeSpeed","spd","sanitizedVideoUrl","methods","handleRefreshStream","$emit","handleImageError","event","console","error","target","src","getStatusColorClass","status","statusMap","getBatteryColorClass","formatNumber","num","toFixed"],"sources":["D:\\projects\\FlightHub-2-Frontend-Standalone-Component\\frontend\\src\\components\\MonitorPanel.vue"],"sourcesContent":["<template>\n  <div class=\"bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden\">\n    <!-- 标题栏 -->\n    <div class=\"p-3 bg-gray-50 dark:bg-gray-700 border-b border-gray-200 dark:border-gray-600 flex justify-between items-center\">\n      <h3 class=\"text-base font-semibold text-gray-900 dark:text-white flex items-center\">\n        <i class=\"fa fa-video-camera text-purple-500 mr-2\"></i>\n        实时监控\n      </h3>\n      <div class=\"flex items-center space-x-2\">\n        <span v-if=\"isStreaming\" class=\"inline-block w-2 h-2 rounded-full bg-green-500 animate-pulse\"></span>\n        <span v-else class=\"inline-block w-2 h-2 rounded-full bg-red-500\"></span>\n        <button \n          class=\"text-xs text-gray-500 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400\"\n          @click=\"handleRefreshStream\"\n          title=\"刷新视频流\"\n        >\n          <i class=\"fa fa-refresh\"></i>\n        </button>\n      </div>\n    </div>\n    \n    <!-- 视频流 -->\n    <div class=\"relative\">\n      <div class=\"aspect-video bg-gray-900 relative overflow-hidden\">\n        <img \n          v-if=\"sanitizedVideoUrl\" \n          :src=\"sanitizedVideoUrl\" \n          alt=\"视频流\" \n          class=\"w-full h-full object-cover\"\n          @error=\"handleImageError\"\n        >\n        <div v-else class=\"w-full h-full flex flex-col items-center justify-center\">\n          <i class=\"fa fa-video-camera-slash text-gray-700 text-4xl mb-2\"></i>\n          <p class=\"text-gray-600 text-sm\">{{ videoErrorMessage || '暂无视频流' }}</p>\n        </div>\n        \n        <!-- 视频控制覆盖层 -->\n        <div class=\"absolute bottom-2 left-0 right-0 flex justify-center opacity-0 hover:opacity-100 transition-opacity duration-300\">\n          <div class=\"bg-black/50 backdrop-blur-sm rounded-full px-3 py-1.5 flex items-center space-x-3\">\n            <button class=\"text-white hover:text-gray-300\" @click.stop>\n              <i class=\"fa fa-play\"></i>\n            </button>\n            <button class=\"text-white hover:text-gray-300\" @click.stop>\n              <i class=\"fa fa-expand\"></i>\n            </button>\n            <button class=\"text-white hover:text-gray-300\" @click.stop>\n              <i class=\"fa fa-arrows-alt\"></i>\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n    \n    <!-- 状态信息 -->\n    <div class=\"p-3\">\n      <div class=\"grid grid-cols-2 gap-3\">\n        <div>\n          <p class=\"text-xs text-gray-500 dark:text-gray-400\">状态</p>\n          <p class=\"text-sm font-medium text-gray-900 dark:text-white flex items-center\">\n            <span \n              class=\"inline-block w-2 h-2 rounded-full mr-2\"\n              :class=\"getStatusColorClass(safeDroneStatus)\"\n            ></span>\n            {{ safeDroneStatus }}\n          </p>\n        </div>\n        <div>\n          <p class=\"text-xs text-gray-500 dark:text-gray-400\">电池电量</p>\n          <div class=\"flex items-center\">\n            <div class=\"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5 mr-2\">\n              <div \n                class=\"h-1.5 rounded-full\"\n                :class=\"getBatteryColorClass(safeBatteryLevel)\"\n                :style=\"{ width: Math.min(100, Math.max(0, safeBatteryLevel)) + '%' }\"\n              ></div>\n            </div>\n            <span class=\"text-sm font-medium text-gray-900 dark:text-white min-w-8 text-right\">{{ Math.min(100, Math.max(0, safeBatteryLevel)) }}%</span>\n          </div>\n        </div>\n        <div>\n          <p class=\"text-xs text-gray-500 dark:text-gray-400\">高度</p>\n          <p class=\"text-sm font-medium text-gray-900 dark:text-white\">{{ formatNumber(safeAltitude) }} m</p>\n        </div>\n        <div>\n          <p class=\"text-xs text-gray-500 dark:text-gray-400\">速度</p>\n          <p class=\"text-sm font-medium text-gray-900 dark:text-white\">{{ formatNumber(safeSpeed) }} m/s</p>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'MonitorPanel',\n  props: {\n    videoStreamUrl: {\n      type: String,\n      default: ''\n    },\n    isStreaming: {\n      type: Boolean,\n      default: false\n    },\n    droneStatus: {\n      type: String,\n      default: '待命'\n    },\n    batteryLevel: {\n      type: Number,\n      default: 100\n    },\n    altitude: {\n      type: Number,\n      default: 0\n    },\n    speed: {\n      type: Number,\n      default: 0\n    }\n  },\n  data() {\n    return {\n      videoErrorMessage: '',\n      // 默认的占位图像\n      defaultImage: 'https://picsum.photos/1280/720?random=default'\n    }\n  },\n  computed: {\n    // 安全的无人机状态\n    safeDroneStatus() {\n      return typeof this.droneStatus === 'string' && this.droneStatus.trim() ? this.droneStatus : '待命'\n    },\n    \n    // 安全的电池电量\n    safeBatteryLevel() {\n      const level = Number(this.batteryLevel)\n      return isNaN(level) ? 100 : level\n    },\n    \n    // 安全的高度\n    safeAltitude() {\n      const alt = Number(this.altitude)\n      return isNaN(alt) ? 0 : alt\n    },\n    \n    // 安全的速度\n    safeSpeed() {\n      const spd = Number(this.speed)\n      return isNaN(spd) ? 0 : spd\n    },\n    \n    // 净化后的视频URL\n    sanitizedVideoUrl() {\n      if (typeof this.videoStreamUrl === 'string' && this.videoStreamUrl.trim()) {\n        return this.videoStreamUrl\n      }\n      return this.isStreaming ? this.defaultImage : ''\n    }\n  },\n  methods: {\n    // 处理刷新视频流\n    handleRefreshStream() {\n      this.videoErrorMessage = ''\n      this.$emit('refresh-stream')\n    },\n    \n    // 处理图像加载错误\n    handleImageError(event) {\n      console.error('视频流加载失败:', event)\n      this.videoErrorMessage = '视频流加载失败'\n      // 如果有错误，使用默认图像作为后备\n      event.target.src = this.defaultImage\n    },\n    \n    // 获取状态对应的颜色类\n    getStatusColorClass(status) {\n      const statusMap = {\n        '待命': 'bg-green-500',\n        '飞行中': 'bg-blue-500',\n        '暂停': 'bg-yellow-500',\n        '已停止': 'bg-red-500',\n        '返回中': 'bg-red-500'\n      }\n      return statusMap[status] || 'bg-gray-500'\n    },\n    \n    // 获取电池对应的颜色类\n    getBatteryColorClass(level) {\n      if (level > 70) return 'bg-green-500'\n      if (level > 30) return 'bg-yellow-500'\n      return 'bg-red-500'\n    },\n    \n    // 格式化数字，保留一位小数\n    formatNumber(num) {\n      return Number(num).toFixed(1)\n    }\n  }\n}\n</script>\n\n<style scoped>\n/* 视频容器悬停效果 */\n.aspect-video:hover {\n  box-shadow: inset 0 0 0 2px rgba(59, 130, 246, 0.5);\n}\n\n\n/* 视频加载状态 */\nimg {\n  transition: opacity 0.3s ease-in-out;\n}\n\nimg:hover {\n  opacity: 0.95;\n}\n\n/* 错误提示样式 */\n.text-gray-600 {\n  color: #6b7280;\n}\n\n.dark .text-gray-600 {\n  color: #9ca3af;\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}