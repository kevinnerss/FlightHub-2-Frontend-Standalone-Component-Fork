{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, withCtx as _withCtx, openBlock as _openBlock, createElementBlock as _createElementBlock, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"header-container\"\n};\nconst _hoisted_2 = {\n  class: \"title-section\"\n};\nconst _hoisted_3 = {\n  class: \"status-section\"\n};\nconst _hoisted_4 = {\n  class: \"video-container-wrapper\"\n};\nconst _hoisted_5 = {\n  class: \"video-container\"\n};\nconst _hoisted_6 = [\"src\"];\nconst _hoisted_7 = {\n  key: 1,\n  class: \"error-container\"\n};\nconst _hoisted_8 = {\n  class: \"error-text\"\n};\nconst _hoisted_9 = {\n  class: \"status-info\"\n};\nconst _hoisted_10 = {\n  class: \"info-content\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_VideoCamera = _resolveComponent(\"VideoCamera\");\n  const _component_el_tag = _resolveComponent(\"el-tag\");\n  const _component_Refresh = _resolveComponent(\"Refresh\");\n  const _component_el_button = _resolveComponent(\"el-button\");\n  const _component_VideoPause = _resolveComponent(\"VideoPause\");\n  const _component_el_col = _resolveComponent(\"el-col\");\n  const _component_el_progress = _resolveComponent(\"el-progress\");\n  const _component_el_statistic = _resolveComponent(\"el-statistic\");\n  const _component_el_row = _resolveComponent(\"el-row\");\n  const _component_el_card = _resolveComponent(\"el-card\");\n  return _openBlock(), _createBlock(_component_el_card, {\n    shadow: \"hover\",\n    \"body-style\": {\n      padding: 0\n    }\n  }, {\n    header: _withCtx(() => [_createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createVNode(_component_VideoCamera, {\n      class: \"title-icon\"\n    }), _cache[1] || (_cache[1] = _createElementVNode(\"span\", null, \"实时监控\", -1 /* CACHED */))]), _createElementVNode(\"div\", _hoisted_3, [_createVNode(_component_el_tag, {\n      type: $props.isStreaming ? 'success' : 'danger',\n      size: \"small\",\n      effect: \"dark\"\n    }, {\n      default: _withCtx(() => [_createTextVNode(_toDisplayString($props.isStreaming ? '直播中' : '已断开'), 1 /* TEXT */)]),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"type\"]), _createVNode(_component_el_button, {\n      size: \"small\",\n      circle: \"\",\n      onClick: $options.handleRefreshStream,\n      title: \"刷新视频流\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_Refresh)]),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"onClick\"])])])]),\n    default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"div\", _hoisted_5, [$options.sanitizedVideoUrl ? (_openBlock(), _createElementBlock(\"img\", {\n      key: 0,\n      src: $options.sanitizedVideoUrl,\n      alt: \"视频流\",\n      class: \"video-image\",\n      onError: _cache[0] || (_cache[0] = (...args) => $options.handleImageError && $options.handleImageError(...args))\n    }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_6)) : (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [_createVNode(_component_VideoPause, {\n      class: \"error-icon\"\n    }), _createElementVNode(\"p\", _hoisted_8, _toDisplayString($data.videoErrorMessage || '暂无视频流'), 1 /* TEXT */)]))])]), _createElementVNode(\"div\", _hoisted_9, [_createVNode(_component_el_row, {\n      gutter: 20\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_col, {\n        span: 12\n      }, {\n        default: _withCtx(() => [_cache[2] || (_cache[2] = _createElementVNode(\"div\", {\n          class: \"info-label\"\n        }, \"状态\", -1 /* CACHED */)), _createElementVNode(\"div\", _hoisted_10, [_createVNode(_component_el_tag, {\n          type: $options.getStatusColor($options.safeDroneStatus),\n          size: \"small\"\n        }, {\n          default: _withCtx(() => [_createTextVNode(_toDisplayString($options.safeDroneStatus), 1 /* TEXT */)]),\n          _: 1 /* STABLE */\n        }, 8 /* PROPS */, [\"type\"])])]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_col, {\n        span: 12\n      }, {\n        default: _withCtx(() => [_cache[3] || (_cache[3] = _createElementVNode(\"div\", {\n          class: \"info-label\"\n        }, \"电池电量\", -1 /* CACHED */)), _createVNode(_component_el_progress, {\n          percentage: Math.min(100, Math.max(0, $options.safeBatteryLevel)),\n          status: $options.getBatteryStatus($options.safeBatteryLevel),\n          format: () => `${Math.min(100, Math.max(0, $options.safeBatteryLevel))}%`,\n          size: \"small\"\n        }, null, 8 /* PROPS */, [\"percentage\", \"status\", \"format\"])]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_col, {\n        span: 12\n      }, {\n        default: _withCtx(() => [_cache[4] || (_cache[4] = _createElementVNode(\"div\", {\n          class: \"info-label\"\n        }, \"高度\", -1 /* CACHED */)), _createVNode(_component_el_statistic, {\n          value: $options.formatNumber($options.safeAltitude),\n          suffix: \"m\"\n        }, null, 8 /* PROPS */, [\"value\"])]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_col, {\n        span: 12\n      }, {\n        default: _withCtx(() => [_cache[5] || (_cache[5] = _createElementVNode(\"div\", {\n          class: \"info-label\"\n        }, \"速度\", -1 /* CACHED */)), _createVNode(_component_el_statistic, {\n          value: $options.formatNumber($options.safeSpeed),\n          suffix: \"m/s\"\n        }, null, 8 /* PROPS */, [\"value\"])]),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    })])]),\n    _: 1 /* STABLE */\n  });\n}","map":{"version":3,"names":["class","_createBlock","_component_el_card","shadow","padding","header","_withCtx","_createElementVNode","_hoisted_1","_hoisted_2","_createVNode","_component_VideoCamera","_hoisted_3","_component_el_tag","type","$props","isStreaming","size","effect","_component_el_button","circle","onClick","$options","handleRefreshStream","title","_component_Refresh","_hoisted_4","_hoisted_5","sanitizedVideoUrl","_createElementBlock","src","alt","onError","_cache","args","handleImageError","_hoisted_7","_component_VideoPause","_hoisted_8","_toDisplayString","$data","videoErrorMessage","_hoisted_9","_component_el_row","gutter","_component_el_col","span","_hoisted_10","getStatusColor","safeDroneStatus","_component_el_progress","percentage","Math","min","max","safeBatteryLevel","status","getBatteryStatus","format","_component_el_statistic","value","formatNumber","safeAltitude","suffix","safeSpeed"],"sources":["D:\\projects\\FlightHub-2-Frontend-Standalone-Component\\frontend\\src\\components\\MonitorPanel.vue"],"sourcesContent":["<template>\n  <el-card shadow=\"hover\" :body-style=\"{ padding: 0 }\">\n    <!-- 标题栏 -->\n    <template #header>\n      <div class=\"header-container\">\n        <div class=\"title-section\">\n            <VideoCamera class=\"title-icon\" />\n            <span>实时监控</span>\n          </div>\n        <div class=\"status-section\">\n            <el-tag \n              :type=\"isStreaming ? 'success' : 'danger'\" \n              size=\"small\" \n              effect=\"dark\"\n            >\n              {{ isStreaming ? '直播中' : '已断开' }}\n            </el-tag>\n            <el-button \n                size=\"small\" \n                circle\n                @click=\"handleRefreshStream\"\n                title=\"刷新视频流\"\n              >\n                <Refresh />\n              </el-button>\n          </div>\n        </div>\n    </template>\n    \n    <!-- 视频流 -->\n    <div class=\"video-container-wrapper\">\n      <div class=\"video-container\">\n        <img \n            v-if=\"sanitizedVideoUrl\" \n            :src=\"sanitizedVideoUrl\" \n            alt=\"视频流\" \n            class=\"video-image\"\n            @error=\"handleImageError\"\n          >\n          <div v-else class=\"error-container\">\n            <VideoPause class=\"error-icon\" />\n            <p class=\"error-text\">{{ videoErrorMessage || '暂无视频流' }}</p>\n          </div>\n    </div>\n    </div>\n    \n    <!-- 状态信息 -->\n    <div class=\"status-info\">\n      <el-row :gutter=\"20\">\n        <el-col :span=\"12\">\n          <div class=\"info-label\">状态</div>\n          <div class=\"info-content\">\n            <el-tag \n              :type=\"getStatusColor(safeDroneStatus)\" \n              size=\"small\"\n            >\n              {{ safeDroneStatus }}\n            </el-tag>\n          </div>\n        </el-col>\n        <el-col :span=\"12\">\n          <div class=\"info-label\">电池电量</div>\n          <el-progress \n            :percentage=\"Math.min(100, Math.max(0, safeBatteryLevel))\" \n            :status=\"getBatteryStatus(safeBatteryLevel)\"\n            :format=\"() => `${Math.min(100, Math.max(0, safeBatteryLevel))}%`\"\n            size=\"small\"\n          ></el-progress>\n        </el-col>\n        <el-col :span=\"12\">\n          <div class=\"info-label\">高度</div>\n          <el-statistic \n            :value=\"formatNumber(safeAltitude)\" \n            suffix=\"m\"\n          ></el-statistic>\n        </el-col>\n        <el-col :span=\"12\">\n          <div class=\"info-label\">速度</div>\n          <el-statistic \n            :value=\"formatNumber(safeSpeed)\" \n            suffix=\"m/s\"\n          ></el-statistic>\n        </el-col>\n      </el-row>\n    </div>\n  </el-card>\n</template>\n\n<script>\nimport { VideoCamera, VideoPause, Refresh } from '@element-plus/icons-vue'\n\nexport default {\n  name: 'MonitorPanel',\n  components: {\n    VideoCamera,\n    VideoPause,\n    Refresh\n  },\n  props: {\n    videoStreamUrl: {\n      type: String,\n      default: ''\n    },\n    isStreaming: {\n      type: Boolean,\n      default: false\n    },\n    droneStatus: {\n      type: String,\n      default: '待命'\n    },\n    batteryLevel: {\n      type: Number,\n      default: 100\n    },\n    altitude: {\n      type: Number,\n      default: 0\n    },\n    speed: {\n      type: Number,\n      default: 0\n    }\n  },\n  data() {\n    return {\n      videoErrorMessage: '',\n      // 默认的占位图像\n      defaultImage: 'https://picsum.photos/1280/720?random=default'\n    }\n  },\n  computed: {\n    // 安全的无人机状态\n    safeDroneStatus() {\n      return typeof this.droneStatus === 'string' && this.droneStatus.trim() ? this.droneStatus : '待命'\n    },\n    \n    // 安全的电池电量\n    safeBatteryLevel() {\n      const level = Number(this.batteryLevel)\n      return isNaN(level) ? 100 : level\n    },\n    \n    // 安全的高度\n    safeAltitude() {\n      const alt = Number(this.altitude)\n      return isNaN(alt) ? 0 : alt\n    },\n    \n    // 安全的速度\n    safeSpeed() {\n      const spd = Number(this.speed)\n      return isNaN(spd) ? 0 : spd\n    },\n    \n    // 净化后的视频URL\n    sanitizedVideoUrl() {\n      if (typeof this.videoStreamUrl === 'string' && this.videoStreamUrl.trim()) {\n        return this.videoStreamUrl\n      }\n      return this.isStreaming ? this.defaultImage : ''\n    }\n  },\n  methods: {\n    // 处理刷新视频流\n    handleRefreshStream() {\n      this.videoErrorMessage = ''\n      this.$emit('refresh-stream')\n    },\n    \n    // 处理图像加载错误\n    handleImageError(event) {\n      console.error('视频流加载失败:', event)\n      this.videoErrorMessage = '视频流加载失败'\n      // 如果有错误，使用默认图像作为后备\n      event.target.src = this.defaultImage\n    },\n    \n    // 获取状态对应的颜色\n    getStatusColor(status) {\n      const statusMap = {\n        '待命': 'success',\n        '飞行中': 'primary',\n        '暂停': 'warning',\n        '已停止': 'danger',\n        '返回中': 'danger'\n      }\n      return statusMap[status] || 'info'\n    },\n    \n    // 获取电池状态\n    getBatteryStatus(level) {\n      if (level > 70) return ''\n      if (level > 30) return 'warning'\n      return 'exception'\n    },\n    \n    // 格式化数字，保留一位小数\n    formatNumber(num) {\n      return Number(num).toFixed(1)\n    }\n  }\n}\n</script>\n\n<style scoped>\n/* 标题栏样式 */\n.header-container {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.title-section {\n  display: flex;\n  align-items: center;\n}\n\n.title-icon {\n  margin-right: 8px;\n  color: #409eff;\n}\n\n.status-section {\n  display: flex;\n  align-items: center;\n}\n\n.status-section .el-tag {\n  margin-right: 8px;\n}\n\n/* 视频容器样式 */\n.video-container-wrapper {\n  position: relative;\n}\n\n.video-container {\n  width: 100%;\n  height: 0;\n  padding-bottom: 56.25%; /* 16:9 比例 */\n  background-color: #1f2937;\n  position: relative;\n  overflow: hidden;\n}\n\n.video-image {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n\n/* 错误提示样式 */\n.error-container {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n}\n\n.error-icon {\n  font-size: 48px;\n  color: #606266;\n  margin-bottom: 8px;\n}\n\n.error-text {\n  color: #606266;\n  font-size: 14px;\n}\n\n/* 状态信息样式 */\n.status-info {\n  padding: 16px;\n}\n\n.info-label {\n  font-size: 12px;\n  color: #909399;\n  margin-bottom: 4px;\n}\n\n.info-content {\n  display: flex;\n  align-items: center;\n}\n\n/* 响应式设计 */\n@media (max-width: 768px) {\n  .video-container {\n    padding-bottom: 75%; /* 4:3 比例 */\n  }\n  \n  .status-info {\n    padding: 12px;\n  }\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}