{"ast":null,"code":"import axios from 'axios';\nexport default {\n  name: 'ApiTest',\n  data() {\n    return {\n      alarmTypes: {\n        loading: false,\n        error: null,\n        data: null\n      },\n      alarms: {\n        loading: false,\n        error: null,\n        data: null\n      },\n      processAlarm: {\n        loading: false,\n        error: null,\n        success: false\n      },\n      alarmIdToProcess: '',\n      testResults: {\n        alarmTypes: false,\n        alarms: false,\n        processAlarm: false\n      }\n    };\n  },\n  methods: {\n    async testAlarmTypes() {\n      this.alarmTypes.loading = true;\n      this.alarmTypes.error = null;\n      try {\n        // 使用代理路径而不是直接访问后端地址\n        const response = await axios.get('/api/v1/alarmtypes/');\n        this.alarmTypes.data = response.data;\n        this.testResults.alarmTypes = true;\n      } catch (error) {\n        this.alarmTypes.error = error.message;\n        this.testResults.alarmTypes = false;\n      } finally {\n        this.alarmTypes.loading = false;\n      }\n    },\n    async testAlarms() {\n      this.alarms.loading = true;\n      this.alarms.error = null;\n      try {\n        // 使用代理路径而不是直接访问后端地址\n        const response = await axios.get('/api/v1/alarms/');\n        this.alarms.data = response.data;\n        this.testResults.alarms = true;\n      } catch (error) {\n        this.alarms.error = error.message;\n        this.testResults.alarms = false;\n      } finally {\n        this.alarms.loading = false;\n      }\n    },\n    async testProcessAlarm() {\n      if (!this.alarmIdToProcess) {\n        this.processAlarm.error = '请输入告警ID';\n        return;\n      }\n      this.processAlarm.loading = true;\n      this.processAlarm.error = null;\n      this.processAlarm.success = false;\n      try {\n        // 使用代理路径而不是直接访问后端地址\n        await axios.patch(`/api/v1/alarms/${this.alarmIdToProcess}/`, {\n          status: 'PROCESSING',\n          handler: 'Frontend Test'\n        });\n        this.processAlarm.success = true;\n        this.testResults.processAlarm = true;\n      } catch (error) {\n        this.processAlarm.error = error.response?.data || error.message;\n        this.testResults.processAlarm = false;\n      } finally {\n        this.processAlarm.loading = false;\n      }\n    },\n    async runAllTests() {\n      await this.testAlarmTypes();\n      await this.testAlarms();\n      // 不自动运行处理告警测试，因为需要用户输入ID\n    }\n  }\n};","map":{"version":3,"names":["axios","name","data","alarmTypes","loading","error","alarms","processAlarm","success","alarmIdToProcess","testResults","methods","testAlarmTypes","response","get","message","testAlarms","testProcessAlarm","patch","status","handler","runAllTests"],"sources":["D:\\projects\\FlightHub-2-Frontend-Standalone-Component\\frontend\\src\\views\\ApiTest.vue"],"sourcesContent":["<template>\n  <div class=\"api-test\">\n    <el-container class=\"h-screen overflow-hidden\">\n      <el-header class=\"bg-white shadow-sm p-4 flex items-center justify-between\">\n        <h1 class=\"text-2xl font-bold\">API连通性测试</h1>\n        <el-button type=\"primary\" @click=\"runAllTests\">运行全部测试</el-button>\n      </el-header>\n      \n      <el-container class=\"p-4 gap-4\">\n        <el-main class=\"p-0\">\n          <el-row :gutter=\"20\">\n            <el-col :span=\"12\">\n              <el-card class=\"h-full\">\n                <template #header>\n                  <div class=\"flex items-center justify-between\">\n                    <span class=\"font-medium\">告警类型测试</span>\n                    <el-button @click=\"testAlarmTypes\">测试</el-button>\n                  </div>\n                </template>\n                <div class=\"test-result\">\n                  <div v-if=\"alarmTypes.loading\" class=\"text-center py-4\">\n                    <i class=\"el-icon-loading\"></i> 测试中...\n                  </div>\n                  <div v-else-if=\"alarmTypes.error\" class=\"text-red-500\">\n                    错误: {{ alarmTypes.error }}\n                  </div>\n                  <div v-else-if=\"alarmTypes.data\" class=\"space-y-2\">\n                    <div v-for=\"type in alarmTypes.data\" :key=\"type.id\" class=\"border-b pb-2\">\n                      <p><strong>{{ type.name }}</strong> ({{ type.code }})</p>\n                      <p class=\"text-gray-600 text-sm\">{{ type.description }}</p>\n                    </div>\n                  </div>\n                  <div v-else class=\"text-gray-500 text-center py-4\">\n                    点击\"测试\"按钮运行测试\n                  </div>\n                </div>\n              </el-card>\n            </el-col>\n            \n            <el-col :span=\"12\">\n              <el-card class=\"h-full\">\n                <template #header>\n                  <div class=\"flex items-center justify-between\">\n                    <span class=\"font-medium\">告警信息测试</span>\n                    <el-button @click=\"testAlarms\">测试</el-button>\n                  </div>\n                </template>\n                <div class=\"test-result\">\n                  <div v-if=\"alarms.loading\" class=\"text-center py-4\">\n                    <i class=\"el-icon-loading\"></i> 测试中...\n                  </div>\n                  <div v-else-if=\"alarms.error\" class=\"text-red-500\">\n                    错误: {{ alarms.error }}\n                  </div>\n                  <div v-else-if=\"alarms.data\" class=\"space-y-2 max-h-96 overflow-y-auto\">\n                    <div v-for=\"alarm in alarms.data\" :key=\"alarm.id\" class=\"border-b pb-2\">\n                      <p><strong>{{ alarm.type_name }}</strong> - {{ alarm.status }}</p>\n                      <p class=\"text-gray-600 text-sm\">{{ alarm.content }}</p>\n                      <p class=\"text-gray-500 text-xs\">\n                        位置: {{ alarm.latitude }}, {{ alarm.longitude }}\n                      </p>\n                    </div>\n                  </div>\n                  <div v-else class=\"text-gray-500 text-center py-4\">\n                    点击\"测试\"按钮运行测试\n                  </div>\n                </div>\n              </el-card>\n            </el-col>\n          </el-row>\n          \n          <el-row :gutter=\"20\" class=\"mt-4\">\n            <el-col :span=\"12\">\n              <el-card class=\"h-full\">\n                <template #header>\n                  <div class=\"flex items-center justify-between\">\n                    <span class=\"font-medium\">处理告警测试</span>\n                    <el-button @click=\"testProcessAlarm\">测试</el-button>\n                  </div>\n                </template>\n                <div class=\"test-result\">\n                  <div class=\"mb-4\">\n                    <label class=\"block mb-2\">选择告警ID:</label>\n                    <el-input v-model=\"alarmIdToProcess\" placeholder=\"输入告警ID\"></el-input>\n                  </div>\n                  <div v-if=\"processAlarm.loading\" class=\"text-center py-4\">\n                    <i class=\"el-icon-loading\"></i> 处理中...\n                  </div>\n                  <div v-else-if=\"processAlarm.error\" class=\"text-red-500\">\n                    错误: {{ processAlarm.error }}\n                  </div>\n                  <div v-else-if=\"processAlarm.success\" class=\"text-green-500\">\n                    成功处理告警ID: {{ alarmIdToProcess }}\n                  </div>\n                  <div v-else class=\"text-gray-500\">\n                    输入告警ID并点击\"测试\"按钮处理告警\n                  </div>\n                </div>\n              </el-card>\n            </el-col>\n            \n            <el-col :span=\"12\">\n              <el-card class=\"h-full\">\n                <template #header>\n                  <div class=\"flex items-center justify-between\">\n                    <span class=\"font-medium\">综合测试结果</span>\n                    <el-button @click=\"runAllTests\">全部测试</el-button>\n                  </div>\n                </template>\n                <div class=\"test-result\">\n                  <div class=\"space-y-4\">\n                    <div class=\"flex items-center\">\n                      <span class=\"w-32\">告警类型接口:</span>\n                      <el-tag :type=\"testResults.alarmTypes ? 'success' : 'danger'\">\n                        {{ testResults.alarmTypes ? '通过' : '失败' }}\n                      </el-tag>\n                    </div>\n                    <div class=\"flex items-center\">\n                      <span class=\"w-32\">告警信息接口:</span>\n                      <el-tag :type=\"testResults.alarms ? 'success' : 'danger'\">\n                        {{ testResults.alarms ? '通过' : '失败' }}\n                      </el-tag>\n                    </div>\n                    <div class=\"flex items-center\">\n                      <span class=\"w-32\">处理告警接口:</span>\n                      <el-tag :type=\"testResults.processAlarm ? 'success' : 'danger'\">\n                        {{ testResults.processAlarm ? '通过' : '失败' }}\n                      </el-tag>\n                    </div>\n                  </div>\n                  \n                  <div class=\"mt-6 p-4 bg-blue-50 rounded\">\n                    <h3 class=\"font-medium mb-2\">测试说明:</h3>\n                    <ul class=\"text-sm text-gray-700 list-disc pl-5 space-y-1\">\n                      <li>点击各个测试按钮分别测试对应的API接口</li>\n                      <li>点击\"全部测试\"按钮运行所有测试</li>\n                      <li>处理告警测试需要输入一个有效的告警ID</li>\n                      <li>测试结果会显示在右侧综合测试结果区域</li>\n                    </ul>\n                  </div>\n                </div>\n              </el-card>\n            </el-col>\n          </el-row>\n        </el-main>\n      </el-container>\n    </el-container>\n  </div>\n</template>\n\n<script>\nimport axios from 'axios'\n\nexport default {\n  name: 'ApiTest',\n  data() {\n    return {\n      alarmTypes: {\n        loading: false,\n        error: null,\n        data: null\n      },\n      alarms: {\n        loading: false,\n        error: null,\n        data: null\n      },\n      processAlarm: {\n        loading: false,\n        error: null,\n        success: false\n      },\n      alarmIdToProcess: '',\n      testResults: {\n        alarmTypes: false,\n        alarms: false,\n        processAlarm: false\n      }\n    }\n  },\n  methods: {\n    async testAlarmTypes() {\n      this.alarmTypes.loading = true\n      this.alarmTypes.error = null\n      try {\n        // 使用代理路径而不是直接访问后端地址\n        const response = await axios.get('/api/v1/alarmtypes/')\n        this.alarmTypes.data = response.data\n        this.testResults.alarmTypes = true\n      } catch (error) {\n        this.alarmTypes.error = error.message\n        this.testResults.alarmTypes = false\n      } finally {\n        this.alarmTypes.loading = false\n      }\n    },\n    \n    async testAlarms() {\n      this.alarms.loading = true\n      this.alarms.error = null\n      try {\n        // 使用代理路径而不是直接访问后端地址\n        const response = await axios.get('/api/v1/alarms/')\n        this.alarms.data = response.data\n        this.testResults.alarms = true\n      } catch (error) {\n        this.alarms.error = error.message\n        this.testResults.alarms = false\n      } finally {\n        this.alarms.loading = false\n      }\n    },\n    \n    async testProcessAlarm() {\n      if (!this.alarmIdToProcess) {\n        this.processAlarm.error = '请输入告警ID'\n        return\n      }\n      \n      this.processAlarm.loading = true\n      this.processAlarm.error = null\n      this.processAlarm.success = false\n      \n      try {\n        // 使用代理路径而不是直接访问后端地址\n        await axios.patch(\n          `/api/v1/alarms/${this.alarmIdToProcess}/`,\n          {\n            status: 'PROCESSING',\n            handler: 'Frontend Test'\n          }\n        )\n        this.processAlarm.success = true\n        this.testResults.processAlarm = true\n      } catch (error) {\n        this.processAlarm.error = error.response?.data || error.message\n        this.testResults.processAlarm = false\n      } finally {\n        this.processAlarm.loading = false\n      }\n    },\n    \n    async runAllTests() {\n      await this.testAlarmTypes()\n      await this.testAlarms()\n      // 不自动运行处理告警测试，因为需要用户输入ID\n    }\n  }\n}\n</script>\n\n<style scoped>\n.test-result {\n  min-height: 200px;\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}