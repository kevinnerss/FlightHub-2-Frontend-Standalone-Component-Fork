{"ast":null,"code":"import Cartesian3 from \"../Core/Cartesian3.js\";\nimport Check from \"../Core/Check.js\";\nimport createGuid from \"../Core/createGuid.js\";\nimport Frozen from \"../Core/Frozen.js\";\nimport defined from \"../Core/defined.js\";\nimport destroyObject from \"../Core/destroyObject.js\";\nimport DeveloperError from \"../Core/DeveloperError.js\";\nimport PixelFormat from \"../Core/PixelFormat.js\";\nimport ContextLimits from \"./ContextLimits.js\";\nimport MipmapHint from \"./MipmapHint.js\";\nimport PixelDatatype from \"./PixelDatatype.js\";\nimport Sampler from \"./Sampler.js\";\nimport TextureMagnificationFilter from \"./TextureMagnificationFilter.js\";\nimport TextureMinificationFilter from \"./TextureMinificationFilter.js\";\n\n/**\n * @typedef {object} Texture3D.Source\n * @property {number} width The width (in pixels) of the 3D texture source data.\n * @property {number} height The height (in pixels) of the 3D texture source data.\n * @property {number} depth The depth (in pixels) of the 3D texture source data.\n * @property {TypedArray|DataView} arrayBufferView The source data for a 3D texture. The type of each element needs to match the pixelDatatype.\n * @property {TypedArray|DataView} [mipLevels] An array of mip level data. Each element in the array should be a TypedArray or DataView that matches the pixelDatatype.\n */\n\n/**\n * @typedef {object} Texture3D.ConstructorOptions\n *\n * @property {Context} context\n * @property {Texture3D.Source} [source] The source for texel values to be loaded into the 3D texture.\n * @property {PixelFormat} [pixelFormat=PixelFormat.RGBA] The format of each pixel, i.e., the number of components it has and what they represent.\n * @property {PixelDatatype} [pixelDatatype=PixelDatatype.UNSIGNED_BYTE] The data type of each pixel.\n * @property {boolean} [flipY=true] If true, the source values will be read as if the y-axis is inverted (y=0 at the top).\n * @property {boolean} [skipColorSpaceConversion=false] If true, color space conversions will be skipped when reading the texel values.\n * @property {Sampler} [sampler] Information about how to sample the 3D texture.\n * @property {number} [width] The width (in pixels) of the 3D texture. If not supplied, must be available from the source.\n * @property {number} [height] The height (in pixels) of the 3D texture. If not supplied, must be available from the source.\n * @property {number} [depth] The depth (in pixels) of the 3D texture. If not supplied, must be available from the source.\n * @property {boolean} [preMultiplyAlpha] If true, the alpha channel will be multiplied into the other channels.\n * @property {string} [id] A unique identifier for the 3D texture. If this is not given, then a GUID will be created.\n *\n * @private\n */\n\n/**\n * A wrapper for a {@link https://developer.mozilla.org/en-US/docs/Web/API/WebGLTexture|WebGLTexture}\n * to abstract away the verbose GL calls associated with setting up a texture3D.\n *\n * @alias Texture3D\n * @constructor\n *\n * @param {Texture3D.ConstructorOptions} options\n * @private\n */\nfunction Texture3D(options) {\n  options = options ?? Frozen.EMPTY_OBJECT;\n\n  //>>includeStart('debug', pragmas.debug);\n  Check.defined(\"options.context\", options.context);\n  //>>includeEnd('debug');\n\n  const {\n    context,\n    source,\n    pixelFormat = PixelFormat.RGBA,\n    pixelDatatype = PixelDatatype.UNSIGNED_BYTE,\n    flipY = true,\n    skipColorSpaceConversion = false,\n    sampler = new Sampler()\n  } = options;\n  if (!context.webgl2) {\n    throw new DeveloperError(\"WebGL1 does not support texture3D. Please use a WebGL2 context.\");\n  }\n  let {\n    width,\n    height,\n    depth\n  } = options;\n  if (defined(source)) {\n    // Make sure we are using the element's intrinsic width and height where available\n    if (!defined(width)) {\n      width = source.width;\n    }\n    if (!defined(height)) {\n      height = source.height;\n    }\n    // depth is not used for 2D textures, but is required for 3D textures\n    if (!defined(depth)) {\n      depth = source.depth;\n    }\n  }\n\n  // Use premultiplied alpha for opaque textures should perform better on Chrome:\n  // http://media.tojicode.com/webglCamp4/#20\n  const preMultiplyAlpha = options.preMultiplyAlpha || pixelFormat === PixelFormat.RGB || pixelFormat === PixelFormat.LUMINANCE;\n  const internalFormat = PixelFormat.toInternalFormat(pixelFormat, pixelDatatype, context);\n  const isCompressed = PixelFormat.isCompressedFormat(internalFormat);\n\n  //>>includeStart('debug', pragmas.debug);\n  if (!defined(width) || !defined(height) || !defined(depth)) {\n    throw new DeveloperError(\"options requires a source field to create an initialized texture3D or width, height and depth fields to create a blank texture3D.\");\n  }\n  Check.typeOf.number.greaterThan(\"width\", width, 0);\n  if (width > ContextLimits.maximumTextureSize) {\n    throw new DeveloperError(`Width must be less than or equal to the maximum texture3D size (${ContextLimits.maximumTextureSize}).  Check maximumTextureSize.`);\n  }\n  Check.typeOf.number.greaterThan(\"height\", height, 0);\n  if (height > ContextLimits.maximumTextureSize) {\n    throw new DeveloperError(`Height must be less than or equal to the maximum texture3D size (${ContextLimits.maximumTextureSize}).  Check maximumTextureSize.`);\n  }\n  Check.typeOf.number.greaterThan(\"depth\", depth, 0);\n  if (depth > ContextLimits.maximumTextureSize) {\n    throw new DeveloperError(`Depth must be less than or equal to the maximum texture3D size (${ContextLimits.maximumTextureSize}).  Check maximumTextureSize.`);\n  }\n  if (!PixelFormat.validate(pixelFormat)) {\n    throw new DeveloperError(\"Invalid options.pixelFormat.\");\n  }\n  if (!isCompressed && !PixelDatatype.validate(pixelDatatype)) {\n    throw new DeveloperError(\"Invalid options.pixelDatatype.\");\n  }\n  if (pixelFormat === PixelFormat.DEPTH_COMPONENT && pixelDatatype !== PixelDatatype.UNSIGNED_SHORT && pixelDatatype !== PixelDatatype.UNSIGNED_INT) {\n    throw new DeveloperError(\"When options.pixelFormat is DEPTH_COMPONENT, options.pixelDatatype must be UNSIGNED_SHORT or UNSIGNED_INT.\");\n  }\n  if (pixelFormat === PixelFormat.DEPTH_STENCIL && pixelDatatype !== PixelDatatype.UNSIGNED_INT_24_8) {\n    throw new DeveloperError(\"When options.pixelFormat is DEPTH_STENCIL, options.pixelDatatype must be UNSIGNED_INT_24_8.\");\n  }\n  if (pixelDatatype === PixelDatatype.FLOAT && !context.floatingPointTexture) {\n    throw new DeveloperError(\"When options.pixelDatatype is FLOAT, this WebGL implementation must support the OES_texture_float extension.  Check context.floatingPointTexture.\");\n  }\n  if (pixelDatatype === PixelDatatype.HALF_FLOAT && !context.halfFloatingPointTexture) {\n    throw new DeveloperError(\"When options.pixelDatatype is HALF_FLOAT, this WebGL implementation must support the OES_texture_half_float extension. Check context.halfFloatingPointTexture.\");\n  }\n  if (PixelFormat.isDepthFormat(pixelFormat)) {\n    if (defined(source)) {\n      throw new DeveloperError(\"When options.pixelFormat is DEPTH_COMPONENT or DEPTH_STENCIL, source cannot be provided.\");\n    }\n    if (!context.depthTexture) {\n      throw new DeveloperError(\"When options.pixelFormat is DEPTH_COMPONENT or DEPTH_STENCIL, this WebGL implementation must support WEBGL_depth_texture.  Check context.depthTexture.\");\n    }\n  }\n  if (isCompressed) {\n    throw new DeveloperError(\"Texture3D does not currently support compressed formats.\");\n  }\n  //>>includeEnd('debug');\n\n  const gl = context._gl;\n  const sizeInBytes = PixelFormat.texture3DSizeInBytes(pixelFormat, pixelDatatype, width, height, depth);\n  this._id = options.id ?? createGuid();\n  this._context = context;\n  this._textureFilterAnisotropic = context._textureFilterAnisotropic;\n  this._textureTarget = gl.TEXTURE_3D;\n  this._texture = gl.createTexture();\n  this._internalFormat = internalFormat;\n  this._pixelFormat = pixelFormat;\n  this._pixelDatatype = pixelDatatype;\n  this._width = width;\n  this._height = height;\n  this._depth = depth;\n  this._dimensions = new Cartesian3(width, height, depth);\n  this._hasMipmap = false;\n  this._sizeInBytes = sizeInBytes;\n  this._preMultiplyAlpha = preMultiplyAlpha;\n  this._flipY = flipY;\n  this._initialized = false;\n  this._sampler = undefined;\n  this._sampler = sampler;\n  setupSampler(this, sampler);\n  gl.activeTexture(gl.TEXTURE0);\n  gl.bindTexture(this._textureTarget, this._texture);\n  if (defined(source)) {\n    if (skipColorSpaceConversion) {\n      gl.pixelStorei(gl.UNPACK_COLORSPACE_CONVERSION_WEBGL, gl.NONE);\n    } else {\n      gl.pixelStorei(gl.UNPACK_COLORSPACE_CONVERSION_WEBGL, gl.BROWSER_DEFAULT_WEBGL);\n    }\n    if (!defined(source.arrayBufferView)) {\n      throw new DeveloperError(\"For Texture3D, options.source.arrayBufferView must be defined\");\n    }\n    loadBufferSource(this, source);\n    this._initialized = true;\n  } else {\n    loadNull(this);\n  }\n  gl.bindTexture(this._textureTarget, null);\n}\n\n/**\n * Load texel data from a buffer into a texture3D.\n *\n * @param {Texture3D} texture3D The texture3D to which texel values will be loaded.\n * @param {Texture3D.Source} source The source for texel values to be loaded into the texture3D.\n *\n * @private\n */\nfunction loadBufferSource(texture3D, source) {\n  const context = texture3D._context;\n  const gl = context._gl;\n  const textureTarget = texture3D._textureTarget;\n  const internalFormat = texture3D._internalFormat;\n  const {\n    width,\n    height,\n    depth,\n    pixelFormat,\n    pixelDatatype,\n    flipY\n  } = texture3D;\n  const unpackAlignment = PixelFormat.alignmentInBytes(pixelFormat, pixelDatatype, width);\n  gl.pixelStorei(gl.UNPACK_ALIGNMENT, unpackAlignment);\n  gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false);\n  gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, false);\n  const {\n    arrayBufferView\n  } = source;\n  if (flipY) {\n    console.warn(\"texture3D.flipY is not supported.\");\n  }\n  let levels = 1;\n  if (source.mipLevels && source.mipLevels.length) {\n    levels = source.mipLevels.length + 1;\n  }\n  gl.texStorage3D(textureTarget, levels, internalFormat, width, height, depth);\n  gl.texSubImage3D(textureTarget, 0, 0, 0, 0, width, height, depth, pixelFormat, PixelDatatype.toWebGLConstant(pixelDatatype, context), arrayBufferView);\n  if (levels > 1) {\n    let mipWidth = width;\n    let mipHeight = height;\n    let mipDepth = depth;\n    for (let i = 0; i < source.mipLevels.length; ++i) {\n      mipWidth = nextMipSize(mipWidth);\n      mipHeight = nextMipSize(mipHeight);\n      mipDepth = nextMipSize(mipDepth);\n      gl.texSubImage3D(textureTarget, i + 1, 0, 0, 0, mipWidth, mipHeight, mipDepth, pixelFormat, PixelDatatype.toWebGLConstant(pixelDatatype, context), source.mipLevels[i]);\n    }\n  }\n}\n\n/**\n * Compute a dimension of the image for the next mip level.\n *\n * @param {number} currentSize The size of the current mip level.\n * @returns {number} The size of the next mip level.\n *\n * @private\n */\nfunction nextMipSize(currentSize) {\n  const nextSize = Math.floor(currentSize / 2) | 0;\n  return Math.max(nextSize, 1);\n}\n\n/**\n * Allocate a texture3D in GPU memory, without providing any image data.\n *\n * @param {Texture3D} texture3D The texture3D to be initialized with null values.\n *\n * @private\n */\nfunction loadNull(texture3D) {\n  const context = texture3D._context;\n  context._gl.texImage3D(texture3D._textureTarget, 0, texture3D._internalFormat, texture3D._width, texture3D._height, texture3D._depth, 0, texture3D._pixelFormat, PixelDatatype.toWebGLConstant(texture3D._pixelDatatype, context), null);\n}\n\n/**\n * This function is identical to using the Texture3D constructor except that it can be\n * replaced with a mock/spy in tests.\n * @private\n */\nTexture3D.create = function (options) {\n  return new Texture3D(options);\n};\nObject.defineProperties(Texture3D.prototype, {\n  /**\n   * A unique id for the texture3D\n   * @memberof Texture3D.prototype\n   * @type {string}\n   * @readonly\n   * @private\n   */\n  id: {\n    get: function () {\n      return this._id;\n    }\n  },\n  /**\n   * The sampler to use when sampling this texture3D.\n   * Create a sampler by calling {@link Sampler}.  If this\n   * parameter is not specified, a default sampler is used.  The default sampler clamps texture3D\n   * coordinates in both directions, uses linear filtering for both magnification and minification,\n   * and uses a maximum anisotropy of 1.0.\n   * @memberof Texture3D.prototype\n   * @type {Sampler}\n   * @private\n   */\n  sampler: {\n    get: function () {\n      return this._sampler;\n    },\n    set: function (sampler) {\n      setupSampler(this, sampler);\n      this._sampler = sampler;\n    }\n  },\n  pixelFormat: {\n    get: function () {\n      return this._pixelFormat;\n    }\n  },\n  pixelDatatype: {\n    get: function () {\n      return this._pixelDatatype;\n    }\n  },\n  dimensions: {\n    get: function () {\n      return this._dimensions;\n    }\n  },\n  preMultiplyAlpha: {\n    get: function () {\n      return this._preMultiplyAlpha;\n    }\n  },\n  flipY: {\n    get: function () {\n      return this._flipY;\n    }\n  },\n  width: {\n    get: function () {\n      return this._width;\n    }\n  },\n  height: {\n    get: function () {\n      return this._height;\n    }\n  },\n  depth: {\n    get: function () {\n      return this._depth;\n    }\n  },\n  sizeInBytes: {\n    get: function () {\n      if (this._hasMipmap) {\n        return Math.floor(this._sizeInBytes * 8 / 7);\n      }\n      return this._sizeInBytes;\n    }\n  },\n  _target: {\n    get: function () {\n      return this._textureTarget;\n    }\n  }\n});\n\n/**\n * Set up a sampler for use with a texture3D\n * @param {Texture3D} texture3D The texture3D to be sampled by this sampler\n * @param {Sampler} sampler Information about how to sample the texture3D\n * @private\n */\nfunction setupSampler(texture3D, sampler) {\n  let {\n    minificationFilter,\n    magnificationFilter\n  } = sampler;\n  const mipmap = [TextureMinificationFilter.NEAREST_MIPMAP_NEAREST, TextureMinificationFilter.NEAREST_MIPMAP_LINEAR, TextureMinificationFilter.LINEAR_MIPMAP_NEAREST, TextureMinificationFilter.LINEAR_MIPMAP_LINEAR].includes(minificationFilter);\n  const context = texture3D._context;\n  const pixelFormat = texture3D._pixelFormat;\n  const pixelDatatype = texture3D._pixelDatatype;\n\n  // float textures only support nearest filtering unless the linear extensions are supported\n  if (pixelDatatype === PixelDatatype.FLOAT && !context.textureFloatLinear || pixelDatatype === PixelDatatype.HALF_FLOAT && !context.textureHalfFloatLinear) {\n    // override the sampler's settings\n    minificationFilter = mipmap ? TextureMinificationFilter.NEAREST_MIPMAP_NEAREST : TextureMinificationFilter.NEAREST;\n    magnificationFilter = TextureMagnificationFilter.NEAREST;\n  }\n\n  // WebGL 2 depth texture3D only support nearest filtering. See section 3.8.13 OpenGL ES 3 spec\n  if (PixelFormat.isDepthFormat(pixelFormat)) {\n    minificationFilter = TextureMinificationFilter.NEAREST;\n    magnificationFilter = TextureMagnificationFilter.NEAREST;\n  }\n  const gl = context._gl;\n  const target = texture3D._textureTarget;\n  gl.activeTexture(gl.TEXTURE0);\n  gl.bindTexture(target, texture3D._texture);\n  gl.texParameteri(target, gl.TEXTURE_MIN_FILTER, minificationFilter);\n  gl.texParameteri(target, gl.TEXTURE_MAG_FILTER, magnificationFilter);\n  gl.texParameteri(target, gl.TEXTURE_WRAP_R, sampler.wrapR);\n  gl.texParameteri(target, gl.TEXTURE_WRAP_S, sampler.wrapS);\n  gl.texParameteri(target, gl.TEXTURE_WRAP_T, sampler.wrapT);\n  if (defined(texture3D._textureFilterAnisotropic)) {\n    gl.texParameteri(target, texture3D._textureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT, sampler.maximumAnisotropy);\n  }\n  gl.bindTexture(target, null);\n}\n\n/**\n * @param {MipmapHint} [hint=MipmapHint.DONT_CARE] optional.\n * @private\n * @exception {DeveloperError} Cannot call generateMipmap when the texture3D pixel format is DEPTH_COMPONENT or DEPTH_STENCIL.\n * @exception {DeveloperError} Cannot call generateMipmap when the texture3D pixel format is a compressed format.\n * @exception {DeveloperError} hint is invalid.\n * @exception {DeveloperError} This texture3D's width must be a power of two to call generateMipmap() in a WebGL1 context.\n * @exception {DeveloperError} This texture3D's height must be a power of two to call generateMipmap() in a WebGL1 context.\n * @exception {DeveloperError} This texture3D was destroyed, i.e., destroy() was called.\n */\nTexture3D.prototype.generateMipmap = function (hint) {\n  hint = hint ?? MipmapHint.DONT_CARE;\n\n  //>>includeStart('debug', pragmas.debug);\n  if (PixelFormat.isDepthFormat(this._pixelFormat)) {\n    throw new DeveloperError(\"Cannot call generateMipmap when the texture3D pixel format is DEPTH_COMPONENT or DEPTH_STENCIL.\");\n  }\n  if (PixelFormat.isCompressedFormat(this._pixelFormat)) {\n    throw new DeveloperError(\"Cannot call generateMipmap with a compressed pixel format.\");\n  }\n  if (!MipmapHint.validate(hint)) {\n    throw new DeveloperError(\"hint is invalid.\");\n  }\n  //>>includeEnd('debug');\n\n  this._hasMipmap = true;\n  const gl = this._context._gl;\n  const target = this._textureTarget;\n  gl.hint(gl.GENERATE_MIPMAP_HINT, hint);\n  gl.activeTexture(gl.TEXTURE0);\n  gl.bindTexture(target, this._texture);\n  gl.generateMipmap(target);\n  gl.bindTexture(target, null);\n};\nTexture3D.prototype.isDestroyed = function () {\n  return false;\n};\nTexture3D.prototype.destroy = function () {\n  this._context._gl.deleteTexture(this._texture);\n  return destroyObject(this);\n};\nexport default Texture3D;","map":{"version":3,"names":["Cartesian3","Check","createGuid","Frozen","defined","destroyObject","DeveloperError","PixelFormat","ContextLimits","MipmapHint","PixelDatatype","Sampler","TextureMagnificationFilter","TextureMinificationFilter","Texture3D","options","EMPTY_OBJECT","context","source","pixelFormat","RGBA","pixelDatatype","UNSIGNED_BYTE","flipY","skipColorSpaceConversion","sampler","webgl2","width","height","depth","preMultiplyAlpha","RGB","LUMINANCE","internalFormat","toInternalFormat","isCompressed","isCompressedFormat","typeOf","number","greaterThan","maximumTextureSize","validate","DEPTH_COMPONENT","UNSIGNED_SHORT","UNSIGNED_INT","DEPTH_STENCIL","UNSIGNED_INT_24_8","FLOAT","floatingPointTexture","HALF_FLOAT","halfFloatingPointTexture","isDepthFormat","depthTexture","gl","_gl","sizeInBytes","texture3DSizeInBytes","_id","id","_context","_textureFilterAnisotropic","_textureTarget","TEXTURE_3D","_texture","createTexture","_internalFormat","_pixelFormat","_pixelDatatype","_width","_height","_depth","_dimensions","_hasMipmap","_sizeInBytes","_preMultiplyAlpha","_flipY","_initialized","_sampler","undefined","setupSampler","activeTexture","TEXTURE0","bindTexture","pixelStorei","UNPACK_COLORSPACE_CONVERSION_WEBGL","NONE","BROWSER_DEFAULT_WEBGL","arrayBufferView","loadBufferSource","loadNull","texture3D","textureTarget","unpackAlignment","alignmentInBytes","UNPACK_ALIGNMENT","UNPACK_PREMULTIPLY_ALPHA_WEBGL","UNPACK_FLIP_Y_WEBGL","console","warn","levels","mipLevels","length","texStorage3D","texSubImage3D","toWebGLConstant","mipWidth","mipHeight","mipDepth","i","nextMipSize","currentSize","nextSize","Math","floor","max","texImage3D","create","Object","defineProperties","prototype","get","set","dimensions","_target","minificationFilter","magnificationFilter","mipmap","NEAREST_MIPMAP_NEAREST","NEAREST_MIPMAP_LINEAR","LINEAR_MIPMAP_NEAREST","LINEAR_MIPMAP_LINEAR","includes","textureFloatLinear","textureHalfFloatLinear","NEAREST","target","texParameteri","TEXTURE_MIN_FILTER","TEXTURE_MAG_FILTER","TEXTURE_WRAP_R","wrapR","TEXTURE_WRAP_S","wrapS","TEXTURE_WRAP_T","wrapT","TEXTURE_MAX_ANISOTROPY_EXT","maximumAnisotropy","generateMipmap","hint","DONT_CARE","GENERATE_MIPMAP_HINT","isDestroyed","destroy","deleteTexture"],"sources":["D:/projects/FlightHub-2-Frontend-Standalone-Component/frontend/node_modules/@cesium/engine/Source/Renderer/Texture3D.js"],"sourcesContent":["import Cartesian3 from \"../Core/Cartesian3.js\";\nimport Check from \"../Core/Check.js\";\nimport createGuid from \"../Core/createGuid.js\";\nimport Frozen from \"../Core/Frozen.js\";\nimport defined from \"../Core/defined.js\";\nimport destroyObject from \"../Core/destroyObject.js\";\nimport DeveloperError from \"../Core/DeveloperError.js\";\nimport PixelFormat from \"../Core/PixelFormat.js\";\nimport ContextLimits from \"./ContextLimits.js\";\nimport MipmapHint from \"./MipmapHint.js\";\nimport PixelDatatype from \"./PixelDatatype.js\";\nimport Sampler from \"./Sampler.js\";\nimport TextureMagnificationFilter from \"./TextureMagnificationFilter.js\";\nimport TextureMinificationFilter from \"./TextureMinificationFilter.js\";\n\n/**\n * @typedef {object} Texture3D.Source\n * @property {number} width The width (in pixels) of the 3D texture source data.\n * @property {number} height The height (in pixels) of the 3D texture source data.\n * @property {number} depth The depth (in pixels) of the 3D texture source data.\n * @property {TypedArray|DataView} arrayBufferView The source data for a 3D texture. The type of each element needs to match the pixelDatatype.\n * @property {TypedArray|DataView} [mipLevels] An array of mip level data. Each element in the array should be a TypedArray or DataView that matches the pixelDatatype.\n */\n\n/**\n * @typedef {object} Texture3D.ConstructorOptions\n *\n * @property {Context} context\n * @property {Texture3D.Source} [source] The source for texel values to be loaded into the 3D texture.\n * @property {PixelFormat} [pixelFormat=PixelFormat.RGBA] The format of each pixel, i.e., the number of components it has and what they represent.\n * @property {PixelDatatype} [pixelDatatype=PixelDatatype.UNSIGNED_BYTE] The data type of each pixel.\n * @property {boolean} [flipY=true] If true, the source values will be read as if the y-axis is inverted (y=0 at the top).\n * @property {boolean} [skipColorSpaceConversion=false] If true, color space conversions will be skipped when reading the texel values.\n * @property {Sampler} [sampler] Information about how to sample the 3D texture.\n * @property {number} [width] The width (in pixels) of the 3D texture. If not supplied, must be available from the source.\n * @property {number} [height] The height (in pixels) of the 3D texture. If not supplied, must be available from the source.\n * @property {number} [depth] The depth (in pixels) of the 3D texture. If not supplied, must be available from the source.\n * @property {boolean} [preMultiplyAlpha] If true, the alpha channel will be multiplied into the other channels.\n * @property {string} [id] A unique identifier for the 3D texture. If this is not given, then a GUID will be created.\n *\n * @private\n */\n\n/**\n * A wrapper for a {@link https://developer.mozilla.org/en-US/docs/Web/API/WebGLTexture|WebGLTexture}\n * to abstract away the verbose GL calls associated with setting up a texture3D.\n *\n * @alias Texture3D\n * @constructor\n *\n * @param {Texture3D.ConstructorOptions} options\n * @private\n */\nfunction Texture3D(options) {\n  options = options ?? Frozen.EMPTY_OBJECT;\n\n  //>>includeStart('debug', pragmas.debug);\n  Check.defined(\"options.context\", options.context);\n  //>>includeEnd('debug');\n\n  const {\n    context,\n    source,\n    pixelFormat = PixelFormat.RGBA,\n    pixelDatatype = PixelDatatype.UNSIGNED_BYTE,\n    flipY = true,\n    skipColorSpaceConversion = false,\n    sampler = new Sampler(),\n  } = options;\n\n  if (!context.webgl2) {\n    throw new DeveloperError(\n      \"WebGL1 does not support texture3D. Please use a WebGL2 context.\",\n    );\n  }\n\n  let { width, height, depth } = options;\n  if (defined(source)) {\n    // Make sure we are using the element's intrinsic width and height where available\n    if (!defined(width)) {\n      width = source.width;\n    }\n    if (!defined(height)) {\n      height = source.height;\n    }\n    // depth is not used for 2D textures, but is required for 3D textures\n    if (!defined(depth)) {\n      depth = source.depth;\n    }\n  }\n\n  // Use premultiplied alpha for opaque textures should perform better on Chrome:\n  // http://media.tojicode.com/webglCamp4/#20\n  const preMultiplyAlpha =\n    options.preMultiplyAlpha ||\n    pixelFormat === PixelFormat.RGB ||\n    pixelFormat === PixelFormat.LUMINANCE;\n\n  const internalFormat = PixelFormat.toInternalFormat(\n    pixelFormat,\n    pixelDatatype,\n    context,\n  );\n\n  const isCompressed = PixelFormat.isCompressedFormat(internalFormat);\n\n  //>>includeStart('debug', pragmas.debug);\n  if (!defined(width) || !defined(height) || !defined(depth)) {\n    throw new DeveloperError(\n      \"options requires a source field to create an initialized texture3D or width, height and depth fields to create a blank texture3D.\",\n    );\n  }\n\n  Check.typeOf.number.greaterThan(\"width\", width, 0);\n\n  if (width > ContextLimits.maximumTextureSize) {\n    throw new DeveloperError(\n      `Width must be less than or equal to the maximum texture3D size (${ContextLimits.maximumTextureSize}).  Check maximumTextureSize.`,\n    );\n  }\n\n  Check.typeOf.number.greaterThan(\"height\", height, 0);\n\n  if (height > ContextLimits.maximumTextureSize) {\n    throw new DeveloperError(\n      `Height must be less than or equal to the maximum texture3D size (${ContextLimits.maximumTextureSize}).  Check maximumTextureSize.`,\n    );\n  }\n\n  Check.typeOf.number.greaterThan(\"depth\", depth, 0);\n\n  if (depth > ContextLimits.maximumTextureSize) {\n    throw new DeveloperError(\n      `Depth must be less than or equal to the maximum texture3D size (${ContextLimits.maximumTextureSize}).  Check maximumTextureSize.`,\n    );\n  }\n\n  if (!PixelFormat.validate(pixelFormat)) {\n    throw new DeveloperError(\"Invalid options.pixelFormat.\");\n  }\n\n  if (!isCompressed && !PixelDatatype.validate(pixelDatatype)) {\n    throw new DeveloperError(\"Invalid options.pixelDatatype.\");\n  }\n\n  if (\n    pixelFormat === PixelFormat.DEPTH_COMPONENT &&\n    pixelDatatype !== PixelDatatype.UNSIGNED_SHORT &&\n    pixelDatatype !== PixelDatatype.UNSIGNED_INT\n  ) {\n    throw new DeveloperError(\n      \"When options.pixelFormat is DEPTH_COMPONENT, options.pixelDatatype must be UNSIGNED_SHORT or UNSIGNED_INT.\",\n    );\n  }\n\n  if (\n    pixelFormat === PixelFormat.DEPTH_STENCIL &&\n    pixelDatatype !== PixelDatatype.UNSIGNED_INT_24_8\n  ) {\n    throw new DeveloperError(\n      \"When options.pixelFormat is DEPTH_STENCIL, options.pixelDatatype must be UNSIGNED_INT_24_8.\",\n    );\n  }\n\n  if (pixelDatatype === PixelDatatype.FLOAT && !context.floatingPointTexture) {\n    throw new DeveloperError(\n      \"When options.pixelDatatype is FLOAT, this WebGL implementation must support the OES_texture_float extension.  Check context.floatingPointTexture.\",\n    );\n  }\n\n  if (\n    pixelDatatype === PixelDatatype.HALF_FLOAT &&\n    !context.halfFloatingPointTexture\n  ) {\n    throw new DeveloperError(\n      \"When options.pixelDatatype is HALF_FLOAT, this WebGL implementation must support the OES_texture_half_float extension. Check context.halfFloatingPointTexture.\",\n    );\n  }\n\n  if (PixelFormat.isDepthFormat(pixelFormat)) {\n    if (defined(source)) {\n      throw new DeveloperError(\n        \"When options.pixelFormat is DEPTH_COMPONENT or DEPTH_STENCIL, source cannot be provided.\",\n      );\n    }\n\n    if (!context.depthTexture) {\n      throw new DeveloperError(\n        \"When options.pixelFormat is DEPTH_COMPONENT or DEPTH_STENCIL, this WebGL implementation must support WEBGL_depth_texture.  Check context.depthTexture.\",\n      );\n    }\n  }\n\n  if (isCompressed) {\n    throw new DeveloperError(\n      \"Texture3D does not currently support compressed formats.\",\n    );\n  }\n  //>>includeEnd('debug');\n\n  const gl = context._gl;\n\n  const sizeInBytes = PixelFormat.texture3DSizeInBytes(\n    pixelFormat,\n    pixelDatatype,\n    width,\n    height,\n    depth,\n  );\n\n  this._id = options.id ?? createGuid();\n  this._context = context;\n  this._textureFilterAnisotropic = context._textureFilterAnisotropic;\n  this._textureTarget = gl.TEXTURE_3D;\n  this._texture = gl.createTexture();\n  this._internalFormat = internalFormat;\n  this._pixelFormat = pixelFormat;\n  this._pixelDatatype = pixelDatatype;\n  this._width = width;\n  this._height = height;\n  this._depth = depth;\n  this._dimensions = new Cartesian3(width, height, depth);\n  this._hasMipmap = false;\n  this._sizeInBytes = sizeInBytes;\n  this._preMultiplyAlpha = preMultiplyAlpha;\n  this._flipY = flipY;\n  this._initialized = false;\n  this._sampler = undefined;\n\n  this._sampler = sampler;\n  setupSampler(this, sampler);\n\n  gl.activeTexture(gl.TEXTURE0);\n  gl.bindTexture(this._textureTarget, this._texture);\n\n  if (defined(source)) {\n    if (skipColorSpaceConversion) {\n      gl.pixelStorei(gl.UNPACK_COLORSPACE_CONVERSION_WEBGL, gl.NONE);\n    } else {\n      gl.pixelStorei(\n        gl.UNPACK_COLORSPACE_CONVERSION_WEBGL,\n        gl.BROWSER_DEFAULT_WEBGL,\n      );\n    }\n    if (!defined(source.arrayBufferView)) {\n      throw new DeveloperError(\n        \"For Texture3D, options.source.arrayBufferView must be defined\",\n      );\n    }\n\n    loadBufferSource(this, source);\n\n    this._initialized = true;\n  } else {\n    loadNull(this);\n  }\n\n  gl.bindTexture(this._textureTarget, null);\n}\n\n/**\n * Load texel data from a buffer into a texture3D.\n *\n * @param {Texture3D} texture3D The texture3D to which texel values will be loaded.\n * @param {Texture3D.Source} source The source for texel values to be loaded into the texture3D.\n *\n * @private\n */\nfunction loadBufferSource(texture3D, source) {\n  const context = texture3D._context;\n  const gl = context._gl;\n  const textureTarget = texture3D._textureTarget;\n  const internalFormat = texture3D._internalFormat;\n\n  const { width, height, depth, pixelFormat, pixelDatatype, flipY } = texture3D;\n\n  const unpackAlignment = PixelFormat.alignmentInBytes(\n    pixelFormat,\n    pixelDatatype,\n    width,\n  );\n  gl.pixelStorei(gl.UNPACK_ALIGNMENT, unpackAlignment);\n  gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false);\n  gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, false);\n\n  const { arrayBufferView } = source;\n  if (flipY) {\n    console.warn(\"texture3D.flipY is not supported.\");\n  }\n\n  let levels = 1;\n  if (source.mipLevels && source.mipLevels.length) {\n    levels = source.mipLevels.length + 1;\n  }\n  gl.texStorage3D(textureTarget, levels, internalFormat, width, height, depth);\n\n  gl.texSubImage3D(\n    textureTarget,\n    0,\n    0,\n    0,\n    0,\n    width,\n    height,\n    depth,\n    pixelFormat,\n    PixelDatatype.toWebGLConstant(pixelDatatype, context),\n    arrayBufferView,\n  );\n\n  if (levels > 1) {\n    let mipWidth = width;\n    let mipHeight = height;\n    let mipDepth = depth;\n    for (let i = 0; i < source.mipLevels.length; ++i) {\n      mipWidth = nextMipSize(mipWidth);\n      mipHeight = nextMipSize(mipHeight);\n      mipDepth = nextMipSize(mipDepth);\n      gl.texSubImage3D(\n        textureTarget,\n        i + 1,\n        0,\n        0,\n        0,\n        mipWidth,\n        mipHeight,\n        mipDepth,\n        pixelFormat,\n        PixelDatatype.toWebGLConstant(pixelDatatype, context),\n        source.mipLevels[i],\n      );\n    }\n  }\n}\n\n/**\n * Compute a dimension of the image for the next mip level.\n *\n * @param {number} currentSize The size of the current mip level.\n * @returns {number} The size of the next mip level.\n *\n * @private\n */\nfunction nextMipSize(currentSize) {\n  const nextSize = Math.floor(currentSize / 2) | 0;\n  return Math.max(nextSize, 1);\n}\n\n/**\n * Allocate a texture3D in GPU memory, without providing any image data.\n *\n * @param {Texture3D} texture3D The texture3D to be initialized with null values.\n *\n * @private\n */\nfunction loadNull(texture3D) {\n  const context = texture3D._context;\n\n  context._gl.texImage3D(\n    texture3D._textureTarget,\n    0,\n    texture3D._internalFormat,\n    texture3D._width,\n    texture3D._height,\n    texture3D._depth,\n    0,\n    texture3D._pixelFormat,\n    PixelDatatype.toWebGLConstant(texture3D._pixelDatatype, context),\n    null,\n  );\n}\n\n/**\n * This function is identical to using the Texture3D constructor except that it can be\n * replaced with a mock/spy in tests.\n * @private\n */\nTexture3D.create = function (options) {\n  return new Texture3D(options);\n};\n\nObject.defineProperties(Texture3D.prototype, {\n  /**\n   * A unique id for the texture3D\n   * @memberof Texture3D.prototype\n   * @type {string}\n   * @readonly\n   * @private\n   */\n  id: {\n    get: function () {\n      return this._id;\n    },\n  },\n  /**\n   * The sampler to use when sampling this texture3D.\n   * Create a sampler by calling {@link Sampler}.  If this\n   * parameter is not specified, a default sampler is used.  The default sampler clamps texture3D\n   * coordinates in both directions, uses linear filtering for both magnification and minification,\n   * and uses a maximum anisotropy of 1.0.\n   * @memberof Texture3D.prototype\n   * @type {Sampler}\n   * @private\n   */\n  sampler: {\n    get: function () {\n      return this._sampler;\n    },\n    set: function (sampler) {\n      setupSampler(this, sampler);\n      this._sampler = sampler;\n    },\n  },\n  pixelFormat: {\n    get: function () {\n      return this._pixelFormat;\n    },\n  },\n  pixelDatatype: {\n    get: function () {\n      return this._pixelDatatype;\n    },\n  },\n  dimensions: {\n    get: function () {\n      return this._dimensions;\n    },\n  },\n  preMultiplyAlpha: {\n    get: function () {\n      return this._preMultiplyAlpha;\n    },\n  },\n  flipY: {\n    get: function () {\n      return this._flipY;\n    },\n  },\n  width: {\n    get: function () {\n      return this._width;\n    },\n  },\n  height: {\n    get: function () {\n      return this._height;\n    },\n  },\n  depth: {\n    get: function () {\n      return this._depth;\n    },\n  },\n  sizeInBytes: {\n    get: function () {\n      if (this._hasMipmap) {\n        return Math.floor((this._sizeInBytes * 8) / 7);\n      }\n      return this._sizeInBytes;\n    },\n  },\n  _target: {\n    get: function () {\n      return this._textureTarget;\n    },\n  },\n});\n\n/**\n * Set up a sampler for use with a texture3D\n * @param {Texture3D} texture3D The texture3D to be sampled by this sampler\n * @param {Sampler} sampler Information about how to sample the texture3D\n * @private\n */\nfunction setupSampler(texture3D, sampler) {\n  let { minificationFilter, magnificationFilter } = sampler;\n\n  const mipmap = [\n    TextureMinificationFilter.NEAREST_MIPMAP_NEAREST,\n    TextureMinificationFilter.NEAREST_MIPMAP_LINEAR,\n    TextureMinificationFilter.LINEAR_MIPMAP_NEAREST,\n    TextureMinificationFilter.LINEAR_MIPMAP_LINEAR,\n  ].includes(minificationFilter);\n\n  const context = texture3D._context;\n  const pixelFormat = texture3D._pixelFormat;\n  const pixelDatatype = texture3D._pixelDatatype;\n\n  // float textures only support nearest filtering unless the linear extensions are supported\n  if (\n    (pixelDatatype === PixelDatatype.FLOAT && !context.textureFloatLinear) ||\n    (pixelDatatype === PixelDatatype.HALF_FLOAT &&\n      !context.textureHalfFloatLinear)\n  ) {\n    // override the sampler's settings\n    minificationFilter = mipmap\n      ? TextureMinificationFilter.NEAREST_MIPMAP_NEAREST\n      : TextureMinificationFilter.NEAREST;\n    magnificationFilter = TextureMagnificationFilter.NEAREST;\n  }\n\n  // WebGL 2 depth texture3D only support nearest filtering. See section 3.8.13 OpenGL ES 3 spec\n  if (PixelFormat.isDepthFormat(pixelFormat)) {\n    minificationFilter = TextureMinificationFilter.NEAREST;\n    magnificationFilter = TextureMagnificationFilter.NEAREST;\n  }\n\n  const gl = context._gl;\n  const target = texture3D._textureTarget;\n\n  gl.activeTexture(gl.TEXTURE0);\n  gl.bindTexture(target, texture3D._texture);\n  gl.texParameteri(target, gl.TEXTURE_MIN_FILTER, minificationFilter);\n  gl.texParameteri(target, gl.TEXTURE_MAG_FILTER, magnificationFilter);\n  gl.texParameteri(target, gl.TEXTURE_WRAP_R, sampler.wrapR);\n  gl.texParameteri(target, gl.TEXTURE_WRAP_S, sampler.wrapS);\n  gl.texParameteri(target, gl.TEXTURE_WRAP_T, sampler.wrapT);\n  if (defined(texture3D._textureFilterAnisotropic)) {\n    gl.texParameteri(\n      target,\n      texture3D._textureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,\n      sampler.maximumAnisotropy,\n    );\n  }\n  gl.bindTexture(target, null);\n}\n\n/**\n * @param {MipmapHint} [hint=MipmapHint.DONT_CARE] optional.\n * @private\n * @exception {DeveloperError} Cannot call generateMipmap when the texture3D pixel format is DEPTH_COMPONENT or DEPTH_STENCIL.\n * @exception {DeveloperError} Cannot call generateMipmap when the texture3D pixel format is a compressed format.\n * @exception {DeveloperError} hint is invalid.\n * @exception {DeveloperError} This texture3D's width must be a power of two to call generateMipmap() in a WebGL1 context.\n * @exception {DeveloperError} This texture3D's height must be a power of two to call generateMipmap() in a WebGL1 context.\n * @exception {DeveloperError} This texture3D was destroyed, i.e., destroy() was called.\n */\nTexture3D.prototype.generateMipmap = function (hint) {\n  hint = hint ?? MipmapHint.DONT_CARE;\n\n  //>>includeStart('debug', pragmas.debug);\n  if (PixelFormat.isDepthFormat(this._pixelFormat)) {\n    throw new DeveloperError(\n      \"Cannot call generateMipmap when the texture3D pixel format is DEPTH_COMPONENT or DEPTH_STENCIL.\",\n    );\n  }\n  if (PixelFormat.isCompressedFormat(this._pixelFormat)) {\n    throw new DeveloperError(\n      \"Cannot call generateMipmap with a compressed pixel format.\",\n    );\n  }\n\n  if (!MipmapHint.validate(hint)) {\n    throw new DeveloperError(\"hint is invalid.\");\n  }\n  //>>includeEnd('debug');\n\n  this._hasMipmap = true;\n\n  const gl = this._context._gl;\n  const target = this._textureTarget;\n\n  gl.hint(gl.GENERATE_MIPMAP_HINT, hint);\n  gl.activeTexture(gl.TEXTURE0);\n  gl.bindTexture(target, this._texture);\n  gl.generateMipmap(target);\n  gl.bindTexture(target, null);\n};\n\nTexture3D.prototype.isDestroyed = function () {\n  return false;\n};\n\nTexture3D.prototype.destroy = function () {\n  this._context._gl.deleteTexture(this._texture);\n  return destroyObject(this);\n};\nexport default Texture3D;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}