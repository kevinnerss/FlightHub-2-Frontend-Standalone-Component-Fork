{"ast":null,"code":"import { VideoCamera, VideoPause, Refresh } from '@element-plus/icons-vue';\nexport default {\n  name: 'MonitorPanel',\n  components: {\n    VideoCamera,\n    VideoPause,\n    Refresh\n  },\n  props: {\n    videoStreamUrl: {\n      type: String,\n      default: ''\n    },\n    isStreaming: {\n      type: Boolean,\n      default: false\n    },\n    droneStatus: {\n      type: String,\n      default: '待命'\n    },\n    batteryLevel: {\n      type: Number,\n      default: 100\n    },\n    altitude: {\n      type: Number,\n      default: 0\n    },\n    speed: {\n      type: Number,\n      default: 0\n    }\n  },\n  data() {\n    return {\n      videoErrorMessage: '',\n      // 默认的占位图像\n      defaultImage: 'https://picsum.photos/1280/720?random=default'\n    };\n  },\n  computed: {\n    // 安全的无人机状态\n    safeDroneStatus() {\n      return typeof this.droneStatus === 'string' && this.droneStatus.trim() ? this.droneStatus : '待命';\n    },\n    // 安全的电池电量\n    safeBatteryLevel() {\n      const level = Number(this.batteryLevel);\n      return isNaN(level) ? 100 : level;\n    },\n    // 安全的高度\n    safeAltitude() {\n      const alt = Number(this.altitude);\n      return isNaN(alt) ? 0 : alt;\n    },\n    // 安全的速度\n    safeSpeed() {\n      const spd = Number(this.speed);\n      return isNaN(spd) ? 0 : spd;\n    },\n    // 净化后的视频URL\n    sanitizedVideoUrl() {\n      if (typeof this.videoStreamUrl === 'string' && this.videoStreamUrl.trim()) {\n        return this.videoStreamUrl;\n      }\n      return this.isStreaming ? this.defaultImage : '';\n    }\n  },\n  methods: {\n    // 处理刷新视频流\n    handleRefreshStream() {\n      this.videoErrorMessage = '';\n      this.$emit('refresh-stream');\n    },\n    // 处理图像加载错误\n    handleImageError(event) {\n      console.error('视频流加载失败:', event);\n      this.videoErrorMessage = '视频流加载失败';\n      // 如果有错误，使用默认图像作为后备\n      event.target.src = this.defaultImage;\n    },\n    // 获取状态对应的颜色\n    getStatusColor(status) {\n      const statusMap = {\n        '待命': 'success',\n        '飞行中': 'primary',\n        '暂停': 'warning',\n        '已停止': 'danger',\n        '返回中': 'danger'\n      };\n      return statusMap[status] || 'info';\n    },\n    // 获取电池状态\n    getBatteryStatus(level) {\n      if (level > 70) return '';\n      if (level > 30) return 'warning';\n      return 'exception';\n    },\n    // 格式化数字，保留一位小数\n    formatNumber(num) {\n      return Number(num).toFixed(1);\n    }\n  }\n};","map":{"version":3,"names":["VideoCamera","VideoPause","Refresh","name","components","props","videoStreamUrl","type","String","default","isStreaming","Boolean","droneStatus","batteryLevel","Number","altitude","speed","data","videoErrorMessage","defaultImage","computed","safeDroneStatus","trim","safeBatteryLevel","level","isNaN","safeAltitude","alt","safeSpeed","spd","sanitizedVideoUrl","methods","handleRefreshStream","$emit","handleImageError","event","console","error","target","src","getStatusColor","status","statusMap","getBatteryStatus","formatNumber","num","toFixed"],"sources":["D:\\projects\\FlightHub-2-Frontend-Standalone-Component\\frontend\\src\\components\\MonitorPanel.vue"],"sourcesContent":["<template>\n  <el-card class=\"h-full\" shadow=\"hover\" :body-style=\"{ padding: 0 }\">\n    <!-- 标题栏 -->\n    <template #header>\n      <div class=\"flex justify-between items-center\">\n        <div class=\"flex items-center\">\n            <VideoCamera class=\"mr-2 text-primary\" />\n            <span>实时监控</span>\n          </div>\n        <div class=\"flex items-center space-x-2\">\n          <el-tag \n            :type=\"isStreaming ? 'success' : 'danger'\" \n            size=\"small\" \n            effect=\"dark\"\n          >\n            {{ isStreaming ? '直播中' : '已断开' }}\n          </el-tag>\n          <el-button \n              size=\"small\" \n              circle\n              @click=\"handleRefreshStream\"\n              title=\"刷新视频流\"\n            >\n              <Refresh />\n            </el-button>\n        </div>\n      </div>\n    </template>\n    \n    <!-- 视频流 -->\n    <div class=\"relative\">\n      <div class=\"aspect-video bg-gray-900 relative overflow-hidden\">\n        <img \n          v-if=\"sanitizedVideoUrl\" \n          :src=\"sanitizedVideoUrl\" \n          alt=\"视频流\" \n          class=\"w-full h-full object-cover\"\n          @error=\"handleImageError\"\n        >\n        <div v-else class=\"w-full h-full flex flex-col items-center justify-center\">\n            <VideoPause class=\"text-gray-700 text-4xl mb-2\" />\n            <p class=\"text-gray-600 text-sm\">{{ videoErrorMessage || '暂无视频流' }}</p>\n          </div>\n      </div>\n    </div>\n    \n    <!-- 状态信息 -->\n    <div class=\"p-4\">\n      <el-row :gutter=\"20\">\n        <el-col :span=\"12\">\n          <div class=\"mb-1 text-xs text-gray-500\">状态</div>\n          <div class=\"flex items-center\">\n            <el-tag \n              :type=\"getStatusColor(safeDroneStatus)\" \n              size=\"small\" \n              class=\"mr-2\"\n            >\n              {{ safeDroneStatus }}\n            </el-tag>\n          </div>\n        </el-col>\n        <el-col :span=\"12\">\n          <div class=\"mb-1 text-xs text-gray-500\">电池电量</div>\n          <el-progress \n            :percentage=\"Math.min(100, Math.max(0, safeBatteryLevel))\" \n            :status=\"getBatteryStatus(safeBatteryLevel)\"\n            :format=\"() => `${Math.min(100, Math.max(0, safeBatteryLevel))}%`\"\n            size=\"small\"\n          ></el-progress>\n        </el-col>\n        <el-col :span=\"12\">\n          <div class=\"mb-1 text-xs text-gray-500\">高度</div>\n          <el-statistic \n            :value=\"formatNumber(safeAltitude)\" \n            suffix=\"m\"\n            class=\"text-sm\"\n          ></el-statistic>\n        </el-col>\n        <el-col :span=\"12\">\n          <div class=\"mb-1 text-xs text-gray-500\">速度</div>\n          <el-statistic \n            :value=\"formatNumber(safeSpeed)\" \n            suffix=\"m/s\"\n            class=\"text-sm\"\n          ></el-statistic>\n        </el-col>\n      </el-row>\n    </div>\n  </el-card>\n</template>\n\n<script>\nimport { VideoCamera, VideoPause, Refresh } from '@element-plus/icons-vue'\n\nexport default {\n  name: 'MonitorPanel',\n  components: {\n    VideoCamera,\n    VideoPause,\n    Refresh\n  },\n  props: {\n    videoStreamUrl: {\n      type: String,\n      default: ''\n    },\n    isStreaming: {\n      type: Boolean,\n      default: false\n    },\n    droneStatus: {\n      type: String,\n      default: '待命'\n    },\n    batteryLevel: {\n      type: Number,\n      default: 100\n    },\n    altitude: {\n      type: Number,\n      default: 0\n    },\n    speed: {\n      type: Number,\n      default: 0\n    }\n  },\n  data() {\n    return {\n      videoErrorMessage: '',\n      // 默认的占位图像\n      defaultImage: 'https://picsum.photos/1280/720?random=default'\n    }\n  },\n  computed: {\n    // 安全的无人机状态\n    safeDroneStatus() {\n      return typeof this.droneStatus === 'string' && this.droneStatus.trim() ? this.droneStatus : '待命'\n    },\n    \n    // 安全的电池电量\n    safeBatteryLevel() {\n      const level = Number(this.batteryLevel)\n      return isNaN(level) ? 100 : level\n    },\n    \n    // 安全的高度\n    safeAltitude() {\n      const alt = Number(this.altitude)\n      return isNaN(alt) ? 0 : alt\n    },\n    \n    // 安全的速度\n    safeSpeed() {\n      const spd = Number(this.speed)\n      return isNaN(spd) ? 0 : spd\n    },\n    \n    // 净化后的视频URL\n    sanitizedVideoUrl() {\n      if (typeof this.videoStreamUrl === 'string' && this.videoStreamUrl.trim()) {\n        return this.videoStreamUrl\n      }\n      return this.isStreaming ? this.defaultImage : ''\n    }\n  },\n  methods: {\n    // 处理刷新视频流\n    handleRefreshStream() {\n      this.videoErrorMessage = ''\n      this.$emit('refresh-stream')\n    },\n    \n    // 处理图像加载错误\n    handleImageError(event) {\n      console.error('视频流加载失败:', event)\n      this.videoErrorMessage = '视频流加载失败'\n      // 如果有错误，使用默认图像作为后备\n      event.target.src = this.defaultImage\n    },\n    \n    // 获取状态对应的颜色\n    getStatusColor(status) {\n      const statusMap = {\n        '待命': 'success',\n        '飞行中': 'primary',\n        '暂停': 'warning',\n        '已停止': 'danger',\n        '返回中': 'danger'\n      }\n      return statusMap[status] || 'info'\n    },\n    \n    // 获取电池状态\n    getBatteryStatus(level) {\n      if (level > 70) return ''\n      if (level > 30) return 'warning'\n      return 'exception'\n    },\n    \n    // 格式化数字，保留一位小数\n    formatNumber(num) {\n      return Number(num).toFixed(1)\n    }\n  }\n}\n</script>\n\n<style scoped>\n/* 视频容器悬停效果 */\n.aspect-video {\n  transition: all 0.3s ease;\n  position: relative;\n  overflow: hidden;\n}\n\n.aspect-video:hover {\n  box-shadow: inset 0 0 0 2px rgba(59, 130, 246, 0.7);\n}\n\n/* 视频加载状态 */\nimg {\n  transition: opacity 0.5s ease-in-out, transform 0.3s ease;\n}\n\nimg:hover {\n  opacity: 0.95;\n  transform: scale(1.02);\n}\n\n/* 骨架屏加载动画 */\n:deep(.el-skeleton) {\n  animation: skeleton-loading 1.5s linear infinite alternate;\n}\n\n@keyframes skeleton-loading {\n  0% {\n    background-color: rgba(255, 255, 255, 0.1);\n  }\n  100% {\n    background-color: rgba(255, 255, 255, 0.2);\n  }\n}\n\n/* 视频控制栏样式 */\n.video-control-overlay {\n  transition: opacity 0.3s ease;\n}\n\n.video-control-overlay:hover {\n  opacity: 1;\n}\n\n/* 进度条样式 */\n:deep(.el-progress-bar__inner) {\n  transition: width 0.8s ease-in-out;\n}\n\n/* 悬停提示样式 */\n:deep(.el-tooltip__popper) {\n  font-size: 12px;\n  line-height: 1.4;\n}\n\n/* 状态标签样式 */\n:deep(.el-tag) {\n  transition: all 0.3s ease;\n}\n\n:deep(.el-tag:hover) {\n  transform: translateY(-1px);\n}\n\n/* 按钮悬停效果 */\n:deep(.el-button--plain:hover) {\n  transform: translateY(-1px);\n  box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);\n}\n\n/* 录制动画效果 */\n@keyframes pulse-red {\n  0%, 100% {\n    transform: scale(1);\n  }\n  50% {\n    transform: scale(1.1);\n  }\n}\n\n.recording-indicator {\n  animation: pulse-red 2s infinite;\n}\n\n/* 卡片样式调整 */\n:deep(.el-card) {\n  transition: all 0.3s ease;\n}\n\n/* 响应式设计 */\n@media (max-width: 768px) {\n  .aspect-video {\n    aspect-ratio: 16 / 9;\n  }\n  \n  .control-buttons .el-button {\n    width: 32px;\n    height: 32px;\n    padding: 4px;\n  }\n  \n  .control-buttons .el-icon {\n    font-size: 16px;\n  }\n  \n  .text-xs {\n    font-size: 10px;\n  }\n  \n  .text-sm {\n    font-size: 12px;\n  }\n}\n\n/* 动画效果优化 */\n.animate-pulse {\n  animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;\n}\n\n@keyframes pulse {\n  0%, 100% {\n    opacity: 1;\n  }\n  50% {\n    opacity: 0.5;\n  }\n}\n\n/* 卡片悬停效果 */\n:deep(.el-card__body) {\n  transition: all 0.3s ease;\n}\n\n/* 统计数字样式 */\n:deep(.el-statistic__content) {\n  font-weight: 600;\n  letter-spacing: -0.5px;\n}\n\n/* 渐变背景 */\n.gradient-overlay {\n  background: linear-gradient(to bottom, transparent, rgba(0, 0, 0, 0.7));\n}\n\n/* 时间显示样式 */\n.time-display {\n  background: rgba(0, 0, 0, 0.5);\n  border-radius: 12px;\n  padding: 2px 8px;\n  font-family: monospace;\n}\n\n/* 错误提示样式 */\n.text-gray-600 {\n  color: #6b7280;\n}\n\n.dark .text-gray-600 {\n  color: #9ca3af;\n}\n\n/* 确保元素在深色模式下正常显示 */\n.dark .aspect-video {\n  background-color: #1f2937;\n}\n\n.dark .bg-gray-900 {\n  background-color: #111827;\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}