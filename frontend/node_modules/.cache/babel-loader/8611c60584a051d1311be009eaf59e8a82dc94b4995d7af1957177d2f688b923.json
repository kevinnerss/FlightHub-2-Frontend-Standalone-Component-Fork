{"ast":null,"code":"// 认证相关API调用\nconst API_BASE_URL = 'http://localhost:8001/api/v1';\n\n// 创建axios实例\nconst createRequest = async (url, options = {}) => {\n  const headers = {\n    'Content-Type': 'application/json',\n    ...options.headers\n  };\n\n  // 如果有token，添加到请求头\n  const token = localStorage.getItem('token');\n  if (token) {\n    headers['Authorization'] = `Token ${token}`;\n  }\n  try {\n    const response = await fetch(`${API_BASE_URL}${url}`, {\n      ...options,\n      headers\n    });\n    const data = await response.json();\n    if (!response.ok) {\n      throw new Error(data.detail || '请求失败');\n    }\n    return data;\n  } catch (error) {\n    console.error('API请求错误:', error);\n    throw error;\n  }\n};\nconst authApi = {\n  // 用户登录\n  login: async credentials => {\n    const response = await createRequest('/auth/login/', {\n      method: 'POST',\n      body: JSON.stringify(credentials)\n    });\n    // 转换响应格式，使后端返回的key字段变为token\n    return {\n      token: response.key,\n      user: response.user\n    };\n  },\n  // 用户注册\n  register: async userData => {\n    return createRequest('/users/', {\n      method: 'POST',\n      body: JSON.stringify(userData)\n    });\n  },\n  // 获取当前用户信息\n  getCurrentUser: async () => {\n    return createRequest('/users/me/');\n  },\n  // 用户注销\n  logout: async () => {\n    return createRequest('/auth/logout/', {\n      method: 'POST'\n    });\n  },\n  // 获取所有用户（管理员权限）\n  getUsers: async () => {\n    return createRequest('/users/');\n  },\n  // 更新用户信息\n  updateUser: async (userId, userData) => {\n    return createRequest(`/users/${userId}/`, {\n      method: 'PUT',\n      body: JSON.stringify(userData)\n    });\n  },\n  // 删除用户\n  deleteUser: async userId => {\n    return createRequest(`/users/${userId}/`, {\n      method: 'DELETE'\n    });\n  }\n};\nexport default authApi;","map":{"version":3,"names":["API_BASE_URL","createRequest","url","options","headers","token","localStorage","getItem","response","fetch","data","json","ok","Error","detail","error","console","authApi","login","credentials","method","body","JSON","stringify","key","user","register","userData","getCurrentUser","logout","getUsers","updateUser","userId","deleteUser"],"sources":["D:/projects/FlightHub-2-Frontend-Standalone-Component/frontend/src/api/authApi.js"],"sourcesContent":["// 认证相关API调用\nconst API_BASE_URL = 'http://localhost:8001/api/v1'\n\n// 创建axios实例\nconst createRequest = async (url, options = {}) => {\n  const headers = {\n    'Content-Type': 'application/json',\n    ...options.headers\n  }\n  \n  // 如果有token，添加到请求头\n  const token = localStorage.getItem('token')\n  if (token) {\n    headers['Authorization'] = `Token ${token}`\n  }\n  \n  try {\n    const response = await fetch(`${API_BASE_URL}${url}`, {\n      ...options,\n      headers\n    })\n    \n    const data = await response.json()\n    \n    if (!response.ok) {\n      throw new Error(data.detail || '请求失败')\n    }\n    \n    return data\n  } catch (error) {\n    console.error('API请求错误:', error)\n    throw error\n  }\n}\n\nconst authApi = {\n  // 用户登录\n  login: async (credentials) => {\n    const response = await createRequest('/auth/login/', {\n      method: 'POST',\n      body: JSON.stringify(credentials)\n    })\n    // 转换响应格式，使后端返回的key字段变为token\n    return {\n      token: response.key,\n      user: response.user\n    }\n  },\n  \n  // 用户注册\n  register: async (userData) => {\n    return createRequest('/users/', {\n      method: 'POST',\n      body: JSON.stringify(userData)\n    })\n  },\n  \n  // 获取当前用户信息\n  getCurrentUser: async () => {\n    return createRequest('/users/me/')\n  },\n  \n  // 用户注销\n  logout: async () => {\n    return createRequest('/auth/logout/', {\n      method: 'POST'\n    })\n  },\n  \n  // 获取所有用户（管理员权限）\n  getUsers: async () => {\n    return createRequest('/users/')\n  },\n  \n  // 更新用户信息\n  updateUser: async (userId, userData) => {\n    return createRequest(`/users/${userId}/`, {\n      method: 'PUT',\n      body: JSON.stringify(userData)\n    })\n  },\n  \n  // 删除用户\n  deleteUser: async (userId) => {\n    return createRequest(`/users/${userId}/`, {\n      method: 'DELETE'\n    })\n  }\n}\n\nexport default authApi"],"mappings":"AAAA;AACA,MAAMA,YAAY,GAAG,8BAA8B;;AAEnD;AACA,MAAMC,aAAa,GAAG,MAAAA,CAAOC,GAAG,EAAEC,OAAO,GAAG,CAAC,CAAC,KAAK;EACjD,MAAMC,OAAO,GAAG;IACd,cAAc,EAAE,kBAAkB;IAClC,GAAGD,OAAO,CAACC;EACb,CAAC;;EAED;EACA,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;EAC3C,IAAIF,KAAK,EAAE;IACTD,OAAO,CAAC,eAAe,CAAC,GAAG,SAASC,KAAK,EAAE;EAC7C;EAEA,IAAI;IACF,MAAMG,QAAQ,GAAG,MAAMC,KAAK,CAAC,GAAGT,YAAY,GAAGE,GAAG,EAAE,EAAE;MACpD,GAAGC,OAAO;MACVC;IACF,CAAC,CAAC;IAEF,MAAMM,IAAI,GAAG,MAAMF,QAAQ,CAACG,IAAI,CAAC,CAAC;IAElC,IAAI,CAACH,QAAQ,CAACI,EAAE,EAAE;MAChB,MAAM,IAAIC,KAAK,CAACH,IAAI,CAACI,MAAM,IAAI,MAAM,CAAC;IACxC;IAEA,OAAOJ,IAAI;EACb,CAAC,CAAC,OAAOK,KAAK,EAAE;IACdC,OAAO,CAACD,KAAK,CAAC,UAAU,EAAEA,KAAK,CAAC;IAChC,MAAMA,KAAK;EACb;AACF,CAAC;AAED,MAAME,OAAO,GAAG;EACd;EACAC,KAAK,EAAE,MAAOC,WAAW,IAAK;IAC5B,MAAMX,QAAQ,GAAG,MAAMP,aAAa,CAAC,cAAc,EAAE;MACnDmB,MAAM,EAAE,MAAM;MACdC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACJ,WAAW;IAClC,CAAC,CAAC;IACF;IACA,OAAO;MACLd,KAAK,EAAEG,QAAQ,CAACgB,GAAG;MACnBC,IAAI,EAAEjB,QAAQ,CAACiB;IACjB,CAAC;EACH,CAAC;EAED;EACAC,QAAQ,EAAE,MAAOC,QAAQ,IAAK;IAC5B,OAAO1B,aAAa,CAAC,SAAS,EAAE;MAC9BmB,MAAM,EAAE,MAAM;MACdC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACI,QAAQ;IAC/B,CAAC,CAAC;EACJ,CAAC;EAED;EACAC,cAAc,EAAE,MAAAA,CAAA,KAAY;IAC1B,OAAO3B,aAAa,CAAC,YAAY,CAAC;EACpC,CAAC;EAED;EACA4B,MAAM,EAAE,MAAAA,CAAA,KAAY;IAClB,OAAO5B,aAAa,CAAC,eAAe,EAAE;MACpCmB,MAAM,EAAE;IACV,CAAC,CAAC;EACJ,CAAC;EAED;EACAU,QAAQ,EAAE,MAAAA,CAAA,KAAY;IACpB,OAAO7B,aAAa,CAAC,SAAS,CAAC;EACjC,CAAC;EAED;EACA8B,UAAU,EAAE,MAAAA,CAAOC,MAAM,EAAEL,QAAQ,KAAK;IACtC,OAAO1B,aAAa,CAAC,UAAU+B,MAAM,GAAG,EAAE;MACxCZ,MAAM,EAAE,KAAK;MACbC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACI,QAAQ;IAC/B,CAAC,CAAC;EACJ,CAAC;EAED;EACAM,UAAU,EAAE,MAAOD,MAAM,IAAK;IAC5B,OAAO/B,aAAa,CAAC,UAAU+B,MAAM,GAAG,EAAE;MACxCZ,MAAM,EAAE;IACV,CAAC,CAAC;EACJ;AACF,CAAC;AAED,eAAeH,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}