{"ast":null,"code":"import { createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, createCommentVNode as _createCommentVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString } from \"vue\";\nconst _hoisted_1 = {\n  class: \"cesium-test h-screen flex flex-col\"\n};\nconst _hoisted_2 = {\n  class: \"flex-grow flex flex-col\"\n};\nconst _hoisted_3 = {\n  class: \"controls p-2 bg-gray-100 flex-shrink-0\"\n};\nconst _hoisted_4 = {\n  class: \"flex-grow relative\"\n};\nconst _hoisted_5 = {\n  id: \"cesiumContainer\",\n  ref: \"cesiumContainer\",\n  class: \"absolute inset-0 w-full h-full\"\n};\nconst _hoisted_6 = {\n  key: 0,\n  class: \"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center z-10\"\n};\nconst _hoisted_7 = {\n  key: 1,\n  class: \"absolute inset-0 bg-black bg-opacity-70 flex items-center justify-center z-10\"\n};\nconst _hoisted_8 = {\n  class: \"text-red-500 text-xl bg-white p-4 rounded\"\n};\nconst _hoisted_9 = {\n  key: 2,\n  class: \"absolute top-0 left-0 bg-black bg-opacity-70 text-white p-2 text-sm z-20\"\n};\nconst _hoisted_10 = {\n  key: 3,\n  class: \"absolute top-8 left-0 bg-black bg-opacity-70 text-white p-2 text-sm z-20\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[6] || (_cache[6] = _createElementVNode(\"div\", {\n    class: \"header bg-blue-600 text-white p-4 flex-shrink-0\"\n  }, [_createElementVNode(\"h1\", {\n    class: \"text-xl font-bold\"\n  }, \"Cesium 测试页面\")], -1 /* CACHED */)), _createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [_withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.modelPath = $event),\n    placeholder: \"输入模型路径\",\n    class: \"border p-2 mr-2 w-80\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.modelPath]]), _createElementVNode(\"button\", {\n    onClick: _cache[1] || (_cache[1] = (...args) => $options.loadModel && $options.loadModel(...args)),\n    class: \"bg-blue-500 text-white px-4 py-2 rounded\"\n  }, \" 加载模型 \"), _createElementVNode(\"button\", {\n    onClick: _cache[2] || (_cache[2] = (...args) => $options.resetView && $options.resetView(...args)),\n    class: \"bg-green-500 text-white px-4 py-2 rounded ml-2\"\n  }, \" 重置视角 \"), _createElementVNode(\"button\", {\n    onClick: _cache[3] || (_cache[3] = (...args) => $options.checkContainerSize && $options.checkContainerSize(...args)),\n    class: \"bg-purple-500 text-white px-4 py-2 rounded ml-2\"\n  }, \" 检查容器尺寸 \"), _createElementVNode(\"button\", {\n    onClick: _cache[4] || (_cache[4] = (...args) => $options.addTestPrimitive && $options.addTestPrimitive(...args)),\n    class: \"bg-yellow-500 text-white px-4 py-2 rounded ml-2\"\n  }, \" 添加测试图形 \")]), _createCommentVNode(\" Cesium容器 - 占据剩余所有空间 \"), _createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"div\", _hoisted_5, null, 512 /* NEED_PATCH */), _createCommentVNode(\" 加载指示器 \"), $data.loading ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [...(_cache[5] || (_cache[5] = [_createElementVNode(\"div\", {\n    class: \"text-white text-xl\"\n  }, \"正在加载模型...\", -1 /* CACHED */)]))])) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" 错误信息 \"), $data.error ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [_createElementVNode(\"div\", _hoisted_8, _toDisplayString($data.error), 1 /* TEXT */)])) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" 调试信息 \"), $data.containerInfo ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9, \" 容器尺寸: \" + _toDisplayString($data.containerInfo.width) + \" x \" + _toDisplayString($data.containerInfo.height), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" 模型信息 \"), $data.modelInfo ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, \" 模型状态: \" + _toDisplayString($data.modelInfo), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)])])]);\n}","map":{"version":3,"names":["class","id","ref","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","$data","modelPath","$event","placeholder","onClick","_cache","args","$options","loadModel","resetView","checkContainerSize","addTestPrimitive","_createCommentVNode","_hoisted_4","_hoisted_5","loading","_hoisted_6","error","_hoisted_7","_hoisted_8","_toDisplayString","containerInfo","_hoisted_9","width","height","modelInfo","_hoisted_10"],"sources":["D:\\projects\\FlightHub-2-Frontend-Standalone-Component\\frontend\\src\\views\\CesiumTest.vue"],"sourcesContent":["<template>\n  <div class=\"cesium-test h-screen flex flex-col\">\n    <div class=\"header bg-blue-600 text-white p-4 flex-shrink-0\">\n      <h1 class=\"text-xl font-bold\">Cesium 测试页面</h1>\n    </div>\n    \n    <div class=\"flex-grow flex flex-col\">\n      <div class=\"controls p-2 bg-gray-100 flex-shrink-0\">\n        <input \n          v-model=\"modelPath\" \n          placeholder=\"输入模型路径\" \n          class=\"border p-2 mr-2 w-80\"\n        />\n        <button @click=\"loadModel\" class=\"bg-blue-500 text-white px-4 py-2 rounded\">\n          加载模型\n        </button>\n        <button @click=\"resetView\" class=\"bg-green-500 text-white px-4 py-2 rounded ml-2\">\n          重置视角\n        </button>\n        <button @click=\"checkContainerSize\" class=\"bg-purple-500 text-white px-4 py-2 rounded ml-2\">\n          检查容器尺寸\n        </button>\n        <button @click=\"addTestPrimitive\" class=\"bg-yellow-500 text-white px-4 py-2 rounded ml-2\">\n          添加测试图形\n        </button>\n      </div>\n      \n      <!-- Cesium容器 - 占据剩余所有空间 -->\n      <div class=\"flex-grow relative\">\n        <div \n          id=\"cesiumContainer\" \n          ref=\"cesiumContainer\" \n          class=\"absolute inset-0 w-full h-full\">\n        </div>\n        \n        <!-- 加载指示器 -->\n        <div \n          v-if=\"loading\" \n          class=\"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center z-10\">\n          <div class=\"text-white text-xl\">正在加载模型...</div>\n        </div>\n        \n        <!-- 错误信息 -->\n        <div \n          v-if=\"error\" \n          class=\"absolute inset-0 bg-black bg-opacity-70 flex items-center justify-center z-10\">\n          <div class=\"text-red-500 text-xl bg-white p-4 rounded\">{{ error }}</div>\n        </div>\n        \n        <!-- 调试信息 -->\n        <div \n          v-if=\"containerInfo\" \n          class=\"absolute top-0 left-0 bg-black bg-opacity-70 text-white p-2 text-sm z-20\">\n          容器尺寸: {{ containerInfo.width }} x {{ containerInfo.height }}\n        </div>\n        \n        <!-- 模型信息 -->\n        <div \n          v-if=\"modelInfo\" \n          class=\"absolute top-8 left-0 bg-black bg-opacity-70 text-white p-2 text-sm z-20\">\n          模型状态: {{ modelInfo }}\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'CesiumTest',\n  data() {\n    return {\n      viewer: null,\n      tileset: null,\n      loading: false,\n      error: '',\n      modelPath: '/models/Model_0/tileset.json',\n      containerInfo: null,\n      modelInfo: null\n    }\n  },\n  async mounted() {\n    // 确保DOM完全渲染后再初始化\n    this.$nextTick(async () => {\n      await this.initCesium()\n      // 先不自动加载模型，手动点击加载\n      // await this.loadModel()\n    })\n  },\n  beforeUnmount() {\n    if (this.viewer) {\n      this.viewer.destroy()\n    }\n  },\n  methods: {\n    async initCesium() {\n      try {\n        // 动态导入Cesium\n        const Cesium = await import('cesium')\n        \n        // 设置Cesium的access token为空（因为我们使用的是本地资源）\n        Cesium.Ion.defaultAccessToken = ''\n        \n        // 确保容器元素存在\n        const container = document.getElementById('cesiumContainer')\n        if (!container) {\n          throw new Error('找不到 cesiumContainer 元素')\n        }\n        \n        // 获取容器尺寸\n        this.containerInfo = {\n          width: container.offsetWidth,\n          height: container.offsetHeight\n        }\n        console.log('容器尺寸:', this.containerInfo)\n        \n        // 初始化Cesium Viewer\n        this.viewer = new Cesium.Viewer('cesiumContainer', {\n          animation: false,\n          baseLayerPicker: false,\n          fullscreenButton: false,\n          vrButton: false,\n          geocoder: false,\n          homeButton: false,\n          infoBox: false,\n          sceneModePicker: false,\n          selectionIndicator: false,\n          timeline: false,\n          navigationHelpButton: false,\n          navigationInstructionsInitiallyVisible: false,\n          scene3DOnly: true,\n          shadows: true,\n          shouldAnimate: true\n        })\n\n        // 设置初始视角\n        this.viewer.camera.setView({\n          destination: Cesium.Cartesian3.fromDegrees(116.3913, 39.9075, 100000),\n          orientation: {\n            heading: Cesium.Math.toRadians(0),\n            pitch: Cesium.Math.toRadians(-30),\n            roll: 0.0\n          }\n        })\n        \n        // 监听窗口大小变化\n        window.addEventListener('resize', this.handleResize)\n      } catch (err) {\n        this.error = '初始化Cesium失败: ' + err.message\n        console.error('Cesium initialization error:', err)\n      }\n    },\n    \n    handleResize() {\n      if (this.viewer) {\n        this.viewer.resize()\n        console.log('Cesium容器已调整大小')\n        \n        // 更新容器尺寸信息\n        const container = document.getElementById('cesiumContainer')\n        if (container) {\n          this.containerInfo = {\n            width: container.offsetWidth,\n            height: container.offsetHeight\n          }\n          console.log('更新后的容器尺寸:', this.containerInfo)\n        }\n      }\n    },\n    \n    checkContainerSize() {\n      const container = document.getElementById('cesiumContainer')\n      if (container) {\n        this.containerInfo = {\n          width: container.offsetWidth,\n          height: container.offsetHeight\n        }\n        console.log('手动检查容器尺寸:', this.containerInfo)\n      }\n    },\n    \n    addTestPrimitive() {\n      if (!this.viewer) return;\n      \n      const Cesium = window.CESIUM_BASE_URL ? window.CESIUM_BASE_URL : require('cesium');\n      \n      // 添加一个简单的测试图形\n      const entity = this.viewer.entities.add({\n        position: Cesium.Cartesian3.fromDegrees(116.3913, 39.9075, 100),\n        point: {\n          pixelSize: 10,\n          color: Cesium.Color.RED\n        }\n      });\n      \n      this.viewer.flyTo(entity);\n      console.log('已添加测试图形');\n    },\n    \n    async loadModel() {\n      if (!this.viewer || !this.modelPath) return\n      \n      this.loading = true\n      this.error = ''\n      this.modelInfo = '正在加载...'\n      \n      try {\n        // 动态导入Cesium\n        const Cesium = await import('cesium')\n        \n        // 如果已有模型，先移除\n        if (this.tileset) {\n          this.viewer.scene.primitives.remove(this.tileset)\n          this.tileset = null\n        }\n        \n        // 加载3D Tiles数据集\n        console.log('正在加载模型:', this.modelPath)\n        this.tileset = await Cesium.Cesium3DTileset.fromUrl(this.modelPath)\n        \n        this.viewer.scene.primitives.add(this.tileset)\n        \n        // 缩放到模型\n        if (this.tileset.readyPromise) {\n          this.tileset.readyPromise.then(() => {\n            console.log('模型加载完成')\n            this.modelInfo = '模型加载完成'\n            this.viewer.zoomTo(this.tileset)\n          }).catch(error => {\n            this.error = '模型加载失败: ' + error.message\n            this.modelInfo = '模型加载失败: ' + error.message\n            console.error('Tileset loading error:', error)\n          }).finally(() => {\n            this.loading = false\n          })\n        } else {\n          // 如果没有readyPromise，直接缩放\n          console.log('模型加载完成（无readyPromise）')\n          this.modelInfo = '模型加载完成（无readyPromise）'\n          this.viewer.zoomTo(this.tileset)\n          this.loading = false\n        }\n      } catch (err) {\n        this.error = '模型加载失败: ' + err.message\n        this.modelInfo = '模型加载失败: ' + err.message\n        this.loading = false\n        console.error('Model loading error:', err)\n      }\n    },\n    \n    resetView() {\n      if (this.viewer) {\n        const Cesium = window.CESIUM_BASE_URL ? window.CESIUM_BASE_URL : require('cesium')\n        this.viewer.camera.setView({\n          destination: Cesium.Cartesian3.fromDegrees(116.3913, 39.9075, 100000),\n          orientation: {\n            heading: Cesium.Math.toRadians(0),\n            pitch: Cesium.Math.toRadians(-30),\n            roll: 0.0\n          }\n        })\n      }\n    }\n  }\n}\n</script>\n\n<style>\n.cesium-test {\n  width: 100%;\n  height: 100%;\n}\n\n#cesiumContainer {\n  width: 100%;\n  height: 100%;\n  margin: 0;\n  padding: 0;\n  overflow: hidden;\n}\n</style>"],"mappings":";;EACOA,KAAK,EAAC;AAAoC;;EAKxCA,KAAK,EAAC;AAAyB;;EAC7BA,KAAK,EAAC;AAAwC;;EAqB9CA,KAAK,EAAC;AAAoB;;EAE3BC,EAAE,EAAC,iBAAiB;EACpBC,GAAG,EAAC,iBAAiB;EACrBF,KAAK,EAAC;;;;EAMNA,KAAK,EAAC;;;;EAONA,KAAK,EAAC;;;EACDA,KAAK,EAAC;AAA2C;;;EAMtDA,KAAK,EAAC;;;;EAONA,KAAK,EAAC;;;uBA1DdG,mBAAA,CA+DM,OA/DNC,UA+DM,G,0BA9DJC,mBAAA,CAEM;IAFDL,KAAK,EAAC;EAAiD,IAC1DK,mBAAA,CAA8C;IAA1CL,KAAK,EAAC;EAAmB,GAAC,aAAW,E,qBAG3CK,mBAAA,CAyDM,OAzDNC,UAyDM,GAxDJD,mBAAA,CAkBM,OAlBNE,UAkBM,G,gBAjBJF,mBAAA,CAIE;+DAHSG,KAAA,CAAAC,SAAS,GAAAC,MAAA;IAClBC,WAAW,EAAC,QAAQ;IACpBX,KAAK,EAAC;iDAFGQ,KAAA,CAAAC,SAAS,E,GAIpBJ,mBAAA,CAES;IAFAO,OAAK,EAAAC,MAAA,QAAAA,MAAA,UAAAC,IAAA,KAAEC,QAAA,CAAAC,SAAA,IAAAD,QAAA,CAAAC,SAAA,IAAAF,IAAA,CAAS;IAAEd,KAAK,EAAC;KAA2C,QAE5E,GACAK,mBAAA,CAES;IAFAO,OAAK,EAAAC,MAAA,QAAAA,MAAA,UAAAC,IAAA,KAAEC,QAAA,CAAAE,SAAA,IAAAF,QAAA,CAAAE,SAAA,IAAAH,IAAA,CAAS;IAAEd,KAAK,EAAC;KAAiD,QAElF,GACAK,mBAAA,CAES;IAFAO,OAAK,EAAAC,MAAA,QAAAA,MAAA,UAAAC,IAAA,KAAEC,QAAA,CAAAG,kBAAA,IAAAH,QAAA,CAAAG,kBAAA,IAAAJ,IAAA,CAAkB;IAAEd,KAAK,EAAC;KAAkD,UAE5F,GACAK,mBAAA,CAES;IAFAO,OAAK,EAAAC,MAAA,QAAAA,MAAA,UAAAC,IAAA,KAAEC,QAAA,CAAAI,gBAAA,IAAAJ,QAAA,CAAAI,gBAAA,IAAAL,IAAA,CAAgB;IAAEd,KAAK,EAAC;KAAkD,UAE1F,E,GAGFoB,mBAAA,yBAA4B,EAC5Bf,mBAAA,CAkCM,OAlCNgB,UAkCM,GAjCJhB,mBAAA,CAIM,OAJNiB,UAIM,+BAENF,mBAAA,WAAc,EAENZ,KAAA,CAAAe,OAAO,I,cADfpB,mBAAA,CAIM,OAJNqB,UAIM,OAAAX,MAAA,QAAAA,MAAA,OADJR,mBAAA,CAA+C;IAA1CL,KAAK,EAAC;EAAoB,GAAC,WAAS,mB,2CAG3CoB,mBAAA,UAAa,EAELZ,KAAA,CAAAiB,KAAK,I,cADbtB,mBAAA,CAIM,OAJNuB,UAIM,GADJrB,mBAAA,CAAwE,OAAxEsB,UAAwE,EAAAC,gBAAA,CAAdpB,KAAA,CAAAiB,KAAK,iB,wCAGjEL,mBAAA,UAAa,EAELZ,KAAA,CAAAqB,aAAa,I,cADrB1B,mBAAA,CAIM,OAJN2B,UAIM,EAF6E,SAC3E,GAAAF,gBAAA,CAAGpB,KAAA,CAAAqB,aAAa,CAACE,KAAK,IAAG,KAAG,GAAAH,gBAAA,CAAGpB,KAAA,CAAAqB,aAAa,CAACG,MAAM,oB,mCAG3DZ,mBAAA,UAAa,EAELZ,KAAA,CAAAyB,SAAS,I,cADjB9B,mBAAA,CAIM,OAJN+B,WAIM,EAF6E,SAC3E,GAAAN,gBAAA,CAAGpB,KAAA,CAAAyB,SAAS,oB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}