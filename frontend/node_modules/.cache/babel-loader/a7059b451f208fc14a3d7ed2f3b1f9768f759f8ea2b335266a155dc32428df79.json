{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nimport { mapState, mapActions } from 'vuex';\nimport DroneRouteList from '../components/DroneRouteList.vue';\nimport TaskProgressBar from '../components/TaskProgressBar.vue';\nimport AlarmPanel from '../components/AlarmPanel.vue';\nimport MonitorPanel from '../components/MonitorPanel.vue';\nimport ControlPanel from '../components/ControlPanel.vue';\nimport VisualizationPanel from '../components/VisualizationPanel.vue';\nexport default {\n  name: 'Dashboard',\n  components: {\n    DroneRouteList,\n    TaskProgressBar,\n    AlarmPanel,\n    MonitorPanel,\n    ControlPanel,\n    VisualizationPanel\n  },\n  computed: {\n    ...mapState(['droneRoutes', 'selectedRoute', 'taskProgress', 'currentTask', 'remainingTime', 'completedTasks', 'totalTasks', 'alarms', 'droneStatus', 'batteryLevel', 'currentAltitude', 'currentSpeed', 'targetAltitude', 'targetSpeed', 'videoStreamUrl', 'isStreaming'])\n  },\n  async mounted() {\n    try {\n      // 初始化系统数据\n      console.log('开始初始化系统数据...');\n      await this.initializeSystem();\n      console.log('系统数据初始化完成');\n\n      // 启动数据模拟更新\n      this.startDataSimulation();\n    } catch (error) {\n      console.error('初始化系统时出错:', error);\n    }\n  },\n  methods: {\n    ...mapActions(['initializeSystem', 'selectRoute', 'processAlarm', 'controlDrone', 'updateTargetAltitude', 'updateTargetSpeed', 'emergencyStop', 'refreshStream']),\n    // 处理航线选择\n    handleRouteSelected(routeId) {\n      const route = this.droneRoutes.find(r => r.id === routeId);\n      this.selectRoute(route);\n    },\n    // 处理报警\n    handleAlarmProcessed(alarmId) {\n      this.processAlarm(alarmId);\n    },\n    // 处理控制动作\n    handleControlAction(action) {\n      this.controlDrone(action);\n    },\n    // 处理高度更新\n    handleUpdateAltitude(altitude) {\n      this.updateTargetAltitude(altitude);\n    },\n    // 处理速度更新\n    handleUpdateSpeed(speed) {\n      this.updateTargetSpeed(speed);\n    },\n    // 处理紧急停止\n    handleEmergencyStop() {\n      this.$confirm('确定执行紧急停止？这将立即中断所有飞行操作。', '紧急操作', {\n        confirmButtonText: '确认',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        this.emergencyStop();\n        this.$message.success('紧急停止指令已执行');\n      }).catch(() => {\n        this.$message.info('已取消紧急停止操作');\n      });\n    },\n    // 获取状态标签类型\n    getStatusTagType(status) {\n      switch (status) {\n        case '飞行中':\n          return 'success';\n        case '悬停中':\n          return 'info';\n        case '待命':\n          return 'primary';\n        case '返回中':\n          return 'warning';\n        case '已停止':\n          return 'danger';\n        default:\n          return 'info';\n      }\n    },\n    // 处理刷新视频流\n    handleRefreshStream() {\n      this.refreshStream();\n    },\n    // 处理视图模式变更\n    handleViewModeChanged(viewMode) {\n      console.log('视图模式变更为:', viewMode);\n    },\n    // 处理图层变更\n    handleLayersChanged(layers) {\n      console.log('图层设置变更:', layers);\n    },\n    // 启动数据模拟\n    startDataSimulation() {\n      // 模拟电池电量逐渐下降\n      setInterval(() => {\n        if (this.droneStatus === '飞行中' && this.batteryLevel > 0) {\n          this.$store.commit('SET_BATTERY_LEVEL', Math.max(0, this.batteryLevel - 0.5));\n        }\n      }, 10000);\n\n      // 模拟当前高度和目标高度逐渐接近\n      setInterval(() => {\n        if (this.droneStatus === '飞行中' && Math.abs(this.currentAltitude - this.targetAltitude) > 1) {\n          const newAltitude = this.currentAltitude + (this.targetAltitude > this.currentAltitude ? 1 : -1);\n          this.$store.commit('SET_CURRENT_ALTITUDE', newAltitude);\n        }\n        if (this.droneStatus === '飞行中' && Math.abs(this.currentSpeed - this.targetSpeed) > 0.5) {\n          const newSpeed = this.currentSpeed + (this.targetSpeed > this.currentSpeed ? 0.5 : -0.5);\n          this.$store.commit('SET_CURRENT_SPEED', newSpeed);\n        }\n      }, 2000);\n\n      // 模拟任务进度更新\n      setInterval(() => {\n        if (this.droneStatus === '飞行中' && this.taskProgress < 100) {\n          this.$store.commit('SET_TASK_PROGRESS', Math.min(100, this.taskProgress + 0.5));\n        }\n      }, 5000);\n    }\n  }\n};","map":{"version":3,"names":["mapState","mapActions","DroneRouteList","TaskProgressBar","AlarmPanel","MonitorPanel","ControlPanel","VisualizationPanel","name","components","computed","mounted","console","log","initializeSystem","startDataSimulation","error","methods","handleRouteSelected","routeId","route","droneRoutes","find","r","id","selectRoute","handleAlarmProcessed","alarmId","processAlarm","handleControlAction","action","controlDrone","handleUpdateAltitude","altitude","updateTargetAltitude","handleUpdateSpeed","speed","updateTargetSpeed","handleEmergencyStop","$confirm","confirmButtonText","cancelButtonText","type","then","emergencyStop","$message","success","catch","info","getStatusTagType","status","handleRefreshStream","refreshStream","handleViewModeChanged","viewMode","handleLayersChanged","layers","setInterval","droneStatus","batteryLevel","$store","commit","Math","max","abs","currentAltitude","targetAltitude","newAltitude","currentSpeed","targetSpeed","newSpeed","taskProgress","min"],"sources":["D:\\projects\\FlightHub-2-Frontend-Standalone-Component\\frontend\\src\\views\\Dashboard.vue"],"sourcesContent":["<template>\n  <el-container class=\"h-screen overflow-hidden bg-gray-50\">\n    <!-- 左侧导航 -->\n    <el-aside width=\"240px\" class=\"bg-white shadow-sm overflow-hidden\">\n      <el-card shadow=\"never\" class=\"h-full border-0\">\n        <template #header>\n          <div class=\"flex items-center justify-between\">\n            <span class=\"text-lg font-medium\">航线管理</span>\n            <el-button type=\"primary\" size=\"small\" plain>\n              新增\n            </el-button>\n          </div>\n        </template>\n        <el-scrollbar class=\"h-[calc(100%-50px)]\">\n          <drone-route-list \n            :routes=\"droneRoutes\" \n            :selected-route-id=\"selectedRoute?.id\"\n            @route-selected=\"handleRouteSelected\"\n          />\n        </el-scrollbar>\n      </el-card>\n    </el-aside>\n    \n    <el-container>\n      <!-- 顶部进度条 -->\n      <el-header height=\"60px\" class=\"bg-white border-b p-0\">\n        <task-progress-bar \n          :progress=\"taskProgress\" \n          :current-task=\"currentTask\" \n          :remaining-time=\"remainingTime\"\n          :completed-tasks=\"completedTasks\" \n          :total-tasks=\"totalTasks\"\n        />\n      </el-header>\n      \n      <el-container class=\"p-4 gap-4\">\n        <!-- 主内容区 - 3D可视化 -->\n        <el-main class=\"p-0\">\n          <el-card shadow=\"hover\" class=\"h-full border-0\">\n            <template #header>\n              <div class=\"flex items-center justify-between\">\n                <span class=\"text-lg font-medium\">3D可视化</span>\n                <div class=\"flex items-center gap-2\">\n                  <el-dropdown>\n                    <el-button type=\"primary\" size=\"small\" plain>\n                      视图模式\n                    </el-button>\n                    <template #dropdown>\n                      <el-dropdown-menu>\n                        <el-dropdown-item>标准视图</el-dropdown-item>\n                        <el-dropdown-item>俯视图</el-dropdown-item>\n                        <el-dropdown-item>侧视图</el-dropdown-item>\n                        <el-dropdown-item>第一人称视图</el-dropdown-item>\n                      </el-dropdown-menu>\n                    </template>\n                  </el-dropdown>\n                  <el-button type=\"primary\" size=\"small\" plain>\n                    刷新\n                  </el-button>\n                </div>\n              </div>\n            </template>\n            <visualization-panel \n              :selected-route=\"selectedRoute\"\n              :alarm-points=\"alarms\"\n              @view-mode-changed=\"handleViewModeChanged\"\n              @layers-changed=\"handleLayersChanged\"\n              class=\"h-[calc(100%-60px)]\"\n            />\n          </el-card>\n        </el-main>\n        \n        <!-- 右侧面板 -->\n        <el-aside width=\"320px\" class=\"space-y-4 overflow-hidden\">\n          <!-- 报警信息面板 -->\n          <el-card shadow=\"hover\" class=\"h-[35%] border-0\">\n            <template #header>\n              <div class=\"flex items-center justify-between\">\n                <span class=\"text-base font-medium\">报警信息</span>\n                <el-badge \n                  v-if=\"alarms.length > 0\" \n                  :value=\"alarms.length\" \n                  type=\"danger\"\n                />\n              </div>\n            </template>\n            <alarm-panel \n              :alarms=\"alarms\" \n              @alarm-processed=\"handleAlarmProcessed\"\n              class=\"h-[calc(100%-50px)]\"\n            />\n          </el-card>\n          \n          <!-- 实时监控面板 -->\n          <el-card shadow=\"hover\" class=\"h-[30%] border-0\">\n            <template #header>\n              <div class=\"flex items-center justify-between\">\n                <span class=\"text-base font-medium\">实时监控</span>\n                <el-button \n                  type=\"primary\" \n                  size=\"small\" \n                  plain \n                  @click=\"handleRefreshStream\"\n                  :loading=\"!isStreaming\"\n                >\n                  {{ isStreaming ? '刷新' : '加载中' }}\n                </el-button>\n              </div>\n            </template>\n            <monitor-panel \n              :video-stream-url=\"videoStreamUrl\"\n              :is-streaming=\"isStreaming\"\n              :drone-status=\"droneStatus\"\n              :battery-level=\"batteryLevel\"\n              :altitude=\"currentAltitude\"\n              :speed=\"currentSpeed\"\n              class=\"h-[calc(100%-50px)]\"\n            />\n          </el-card>\n          \n          <!-- 控制面板 -->\n          <el-card shadow=\"hover\" class=\"h-[35%] border-0\">\n            <template #header>\n              <div class=\"flex items-center justify-between\">\n                <span class=\"text-base font-medium\">无人机控制</span>\n                <el-tag :type=\"getStatusTagType(droneStatus)\">\n                  {{ droneStatus }}\n                </el-tag>\n              </div>\n            </template>\n            <control-panel \n              :current-status=\"droneStatus\"\n              :target-altitude=\"targetAltitude\"\n              :target-speed=\"targetSpeed\"\n              @control-action=\"handleControlAction\"\n              @update-altitude=\"handleUpdateAltitude\"\n              @update-speed=\"handleUpdateSpeed\"\n              @emergency-stop=\"handleEmergencyStop\"\n              class=\"h-[calc(100%-50px)]\"\n            />\n          </el-card>\n        </el-aside>\n      </el-container>\n    </el-container>\n  </el-container>\n</template>\n\n<script>\nimport { mapState, mapActions } from 'vuex'\nimport DroneRouteList from '../components/DroneRouteList.vue'\nimport TaskProgressBar from '../components/TaskProgressBar.vue'\nimport AlarmPanel from '../components/AlarmPanel.vue'\nimport MonitorPanel from '../components/MonitorPanel.vue'\nimport ControlPanel from '../components/ControlPanel.vue'\nimport VisualizationPanel from '../components/VisualizationPanel.vue'\n\nexport default {\n  name: 'Dashboard',\n  components: {\n    DroneRouteList,\n    TaskProgressBar,\n    AlarmPanel,\n    MonitorPanel,\n    ControlPanel,\n    VisualizationPanel\n  },\n  computed: {\n    ...mapState([\n      'droneRoutes',\n      'selectedRoute',\n      'taskProgress',\n      'currentTask',\n      'remainingTime',\n      'completedTasks',\n      'totalTasks',\n      'alarms',\n      'droneStatus',\n      'batteryLevel',\n      'currentAltitude',\n      'currentSpeed',\n      'targetAltitude',\n      'targetSpeed',\n      'videoStreamUrl',\n      'isStreaming'\n    ])\n  },\n  async mounted() {\n    try {\n      // 初始化系统数据\n      console.log('开始初始化系统数据...')\n      await this.initializeSystem()\n      console.log('系统数据初始化完成')\n      \n      // 启动数据模拟更新\n      this.startDataSimulation()\n    } catch (error) {\n      console.error('初始化系统时出错:', error)\n    }\n  },\n  methods: {\n    ...mapActions([\n      'initializeSystem',\n      'selectRoute',\n      'processAlarm',\n      'controlDrone',\n      'updateTargetAltitude',\n      'updateTargetSpeed',\n      'emergencyStop',\n      'refreshStream'\n    ]),\n\n    // 处理航线选择\n    handleRouteSelected(routeId) {\n      const route = this.droneRoutes.find(r => r.id === routeId)\n      this.selectRoute(route)\n    },\n\n    // 处理报警\n    handleAlarmProcessed(alarmId) {\n      this.processAlarm(alarmId)\n    },\n\n    // 处理控制动作\n    handleControlAction(action) {\n      this.controlDrone(action)\n    },\n\n    // 处理高度更新\n    handleUpdateAltitude(altitude) {\n      this.updateTargetAltitude(altitude)\n    },\n\n    // 处理速度更新\n    handleUpdateSpeed(speed) {\n      this.updateTargetSpeed(speed)\n    },\n\n    // 处理紧急停止\n    handleEmergencyStop() {\n      this.$confirm('确定执行紧急停止？这将立即中断所有飞行操作。', '紧急操作', {\n        confirmButtonText: '确认',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        this.emergencyStop()\n        this.$message.success('紧急停止指令已执行')\n      }).catch(() => {\n        this.$message.info('已取消紧急停止操作')\n      })\n    },\n\n    // 获取状态标签类型\n    getStatusTagType(status) {\n      switch (status) {\n        case '飞行中':\n          return 'success'\n        case '悬停中':\n          return 'info'\n        case '待命':\n          return 'primary'\n        case '返回中':\n          return 'warning'\n        case '已停止':\n          return 'danger'\n        default:\n          return 'info'\n      }\n    },\n\n    // 处理刷新视频流\n    handleRefreshStream() {\n      this.refreshStream()\n    },\n\n    // 处理视图模式变更\n    handleViewModeChanged(viewMode) {\n      console.log('视图模式变更为:', viewMode)\n    },\n\n    // 处理图层变更\n    handleLayersChanged(layers) {\n      console.log('图层设置变更:', layers)\n    },\n\n    // 启动数据模拟\n    startDataSimulation() {\n      // 模拟电池电量逐渐下降\n      setInterval(() => {\n        if (this.droneStatus === '飞行中' && this.batteryLevel > 0) {\n          this.$store.commit('SET_BATTERY_LEVEL', Math.max(0, this.batteryLevel - 0.5))\n        }\n      }, 10000)\n\n      // 模拟当前高度和目标高度逐渐接近\n      setInterval(() => {\n        if (this.droneStatus === '飞行中' && Math.abs(this.currentAltitude - this.targetAltitude) > 1) {\n          const newAltitude = this.currentAltitude + (this.targetAltitude > this.currentAltitude ? 1 : -1)\n          this.$store.commit('SET_CURRENT_ALTITUDE', newAltitude)\n        }\n        if (this.droneStatus === '飞行中' && Math.abs(this.currentSpeed - this.targetSpeed) > 0.5) {\n          const newSpeed = this.currentSpeed + (this.targetSpeed > this.currentSpeed ? 0.5 : -0.5)\n          this.$store.commit('SET_CURRENT_SPEED', newSpeed)\n        }\n      }, 2000)\n\n      // 模拟任务进度更新\n      setInterval(() => {\n        if (this.droneStatus === '飞行中' && this.taskProgress < 100) {\n          this.$store.commit('SET_TASK_PROGRESS', Math.min(100, this.taskProgress + 0.5))\n        }\n      }, 5000)\n    }\n  }\n}\n</script>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}