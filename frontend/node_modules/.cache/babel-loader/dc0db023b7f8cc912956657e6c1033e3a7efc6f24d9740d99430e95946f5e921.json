{"ast":null,"code":"import combine from \"../../Core/combine.js\";\n\n/**\n * The batch texture stage is responsible for setting up the batch texture for the primitive.\n *\n * @namespace BatchTexturePipelineStage\n * @private\n */\nconst BatchTexturePipelineStage = {\n  name: \"BatchTexturePipelineStage\" // Helps with debugging\n};\n\n/**\n * Processes a primitive. This modifies the following parts of the render resources:\n * <ul>\n *  <li>adds uniforms for the batch texture</li>\n *  <li>adds defines for multiline batch textures</li>\n * </ul>\n *\n * @param {PrimitiveRenderResources} renderResources The render resources for this primitive.\n * @param {ModelComponents.Primitive} primitive The primitive.\n * @param {FrameState} frameState The frame state.\n */\nBatchTexturePipelineStage.process = function (renderResources, primitive, frameState) {\n  const shaderBuilder = renderResources.shaderBuilder;\n  const batchTextureUniforms = {};\n  const model = renderResources.model;\n  const featureTable = model.featureTables[model.featureTableId];\n\n  // Number of features in the feature table.\n  const featuresLength = featureTable.featuresLength;\n  shaderBuilder.addUniform(\"int\", \"model_featuresLength\");\n  batchTextureUniforms.model_featuresLength = function () {\n    return featuresLength;\n  };\n\n  // Batch texture\n  const batchTexture = featureTable.batchTexture;\n  shaderBuilder.addUniform(\"sampler2D\", \"model_batchTexture\");\n  batchTextureUniforms.model_batchTexture = function () {\n    return batchTexture.batchTexture ?? batchTexture.defaultTexture;\n  };\n\n  // Batch texture step size\n  shaderBuilder.addUniform(\"vec4\", \"model_textureStep\");\n  batchTextureUniforms.model_textureStep = function () {\n    return batchTexture.textureStep;\n  };\n\n  // Batch texture dimensions\n  if (batchTexture.textureDimensions.y > 1) {\n    shaderBuilder.addDefine(\"MULTILINE_BATCH_TEXTURE\");\n    shaderBuilder.addUniform(\"vec2\", \"model_textureDimensions\");\n    batchTextureUniforms.model_textureDimensions = function () {\n      return batchTexture.textureDimensions;\n    };\n  }\n  renderResources.uniformMap = combine(batchTextureUniforms, renderResources.uniformMap);\n};\nexport default BatchTexturePipelineStage;","map":{"version":3,"names":["combine","BatchTexturePipelineStage","name","process","renderResources","primitive","frameState","shaderBuilder","batchTextureUniforms","model","featureTable","featureTables","featureTableId","featuresLength","addUniform","model_featuresLength","batchTexture","model_batchTexture","defaultTexture","model_textureStep","textureStep","textureDimensions","y","addDefine","model_textureDimensions","uniformMap"],"sources":["D:/projects/FlightHub-2-Frontend-Standalone-Component/frontend/node_modules/@cesium/engine/Source/Scene/Model/BatchTexturePipelineStage.js"],"sourcesContent":["import combine from \"../../Core/combine.js\";\n\n/**\n * The batch texture stage is responsible for setting up the batch texture for the primitive.\n *\n * @namespace BatchTexturePipelineStage\n * @private\n */\nconst BatchTexturePipelineStage = {\n  name: \"BatchTexturePipelineStage\", // Helps with debugging\n};\n\n/**\n * Processes a primitive. This modifies the following parts of the render resources:\n * <ul>\n *  <li>adds uniforms for the batch texture</li>\n *  <li>adds defines for multiline batch textures</li>\n * </ul>\n *\n * @param {PrimitiveRenderResources} renderResources The render resources for this primitive.\n * @param {ModelComponents.Primitive} primitive The primitive.\n * @param {FrameState} frameState The frame state.\n */\nBatchTexturePipelineStage.process = function (\n  renderResources,\n  primitive,\n  frameState,\n) {\n  const shaderBuilder = renderResources.shaderBuilder;\n  const batchTextureUniforms = {};\n\n  const model = renderResources.model;\n\n  const featureTable = model.featureTables[model.featureTableId];\n\n  // Number of features in the feature table.\n  const featuresLength = featureTable.featuresLength;\n  shaderBuilder.addUniform(\"int\", \"model_featuresLength\");\n  batchTextureUniforms.model_featuresLength = function () {\n    return featuresLength;\n  };\n\n  // Batch texture\n  const batchTexture = featureTable.batchTexture;\n  shaderBuilder.addUniform(\"sampler2D\", \"model_batchTexture\");\n  batchTextureUniforms.model_batchTexture = function () {\n    return batchTexture.batchTexture ?? batchTexture.defaultTexture;\n  };\n\n  // Batch texture step size\n  shaderBuilder.addUniform(\"vec4\", \"model_textureStep\");\n  batchTextureUniforms.model_textureStep = function () {\n    return batchTexture.textureStep;\n  };\n\n  // Batch texture dimensions\n  if (batchTexture.textureDimensions.y > 1) {\n    shaderBuilder.addDefine(\"MULTILINE_BATCH_TEXTURE\");\n    shaderBuilder.addUniform(\"vec2\", \"model_textureDimensions\");\n    batchTextureUniforms.model_textureDimensions = function () {\n      return batchTexture.textureDimensions;\n    };\n  }\n\n  renderResources.uniformMap = combine(\n    batchTextureUniforms,\n    renderResources.uniformMap,\n  );\n};\n\nexport default BatchTexturePipelineStage;\n"],"mappings":"AAAA,OAAOA,OAAO,MAAM,uBAAuB;;AAE3C;AACA;AACA;AACA;AACA;AACA;AACA,MAAMC,yBAAyB,GAAG;EAChCC,IAAI,EAAE,2BAA2B,CAAE;AACrC,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAD,yBAAyB,CAACE,OAAO,GAAG,UAClCC,eAAe,EACfC,SAAS,EACTC,UAAU,EACV;EACA,MAAMC,aAAa,GAAGH,eAAe,CAACG,aAAa;EACnD,MAAMC,oBAAoB,GAAG,CAAC,CAAC;EAE/B,MAAMC,KAAK,GAAGL,eAAe,CAACK,KAAK;EAEnC,MAAMC,YAAY,GAAGD,KAAK,CAACE,aAAa,CAACF,KAAK,CAACG,cAAc,CAAC;;EAE9D;EACA,MAAMC,cAAc,GAAGH,YAAY,CAACG,cAAc;EAClDN,aAAa,CAACO,UAAU,CAAC,KAAK,EAAE,sBAAsB,CAAC;EACvDN,oBAAoB,CAACO,oBAAoB,GAAG,YAAY;IACtD,OAAOF,cAAc;EACvB,CAAC;;EAED;EACA,MAAMG,YAAY,GAAGN,YAAY,CAACM,YAAY;EAC9CT,aAAa,CAACO,UAAU,CAAC,WAAW,EAAE,oBAAoB,CAAC;EAC3DN,oBAAoB,CAACS,kBAAkB,GAAG,YAAY;IACpD,OAAOD,YAAY,CAACA,YAAY,IAAIA,YAAY,CAACE,cAAc;EACjE,CAAC;;EAED;EACAX,aAAa,CAACO,UAAU,CAAC,MAAM,EAAE,mBAAmB,CAAC;EACrDN,oBAAoB,CAACW,iBAAiB,GAAG,YAAY;IACnD,OAAOH,YAAY,CAACI,WAAW;EACjC,CAAC;;EAED;EACA,IAAIJ,YAAY,CAACK,iBAAiB,CAACC,CAAC,GAAG,CAAC,EAAE;IACxCf,aAAa,CAACgB,SAAS,CAAC,yBAAyB,CAAC;IAClDhB,aAAa,CAACO,UAAU,CAAC,MAAM,EAAE,yBAAyB,CAAC;IAC3DN,oBAAoB,CAACgB,uBAAuB,GAAG,YAAY;MACzD,OAAOR,YAAY,CAACK,iBAAiB;IACvC,CAAC;EACH;EAEAjB,eAAe,CAACqB,UAAU,GAAGzB,OAAO,CAClCQ,oBAAoB,EACpBJ,eAAe,CAACqB,UAClB,CAAC;AACH,CAAC;AAED,eAAexB,yBAAyB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}