{"ast":null,"code":"import { VideoCamera, VideoPause, Refresh } from '@element-plus/icons-vue';\nexport default {\n  name: 'MonitorPanel',\n  components: {\n    VideoCamera,\n    VideoPause,\n    Refresh\n  },\n  props: {\n    videoStreamUrl: {\n      type: String,\n      default: ''\n    },\n    isStreaming: {\n      type: Boolean,\n      default: false\n    },\n    droneStatus: {\n      type: String,\n      default: '待命'\n    },\n    batteryLevel: {\n      type: Number,\n      default: 100\n    },\n    altitude: {\n      type: Number,\n      default: 0\n    },\n    speed: {\n      type: Number,\n      default: 0\n    }\n  },\n  data() {\n    return {\n      videoErrorMessage: '',\n      // 默认的占位图像\n      defaultImage: 'https://picsum.photos/1280/720?random=default'\n    };\n  },\n  computed: {\n    // 安全的无人机状态\n    safeDroneStatus() {\n      return typeof this.droneStatus === 'string' && this.droneStatus.trim() ? this.droneStatus : '待命';\n    },\n    // 安全的电池电量\n    safeBatteryLevel() {\n      const level = Number(this.batteryLevel);\n      return isNaN(level) ? 100 : level;\n    },\n    // 安全的高度\n    safeAltitude() {\n      const alt = Number(this.altitude);\n      return isNaN(alt) ? 0 : alt;\n    },\n    // 安全的速度\n    safeSpeed() {\n      const spd = Number(this.speed);\n      return isNaN(spd) ? 0 : spd;\n    },\n    // 净化后的视频URL\n    sanitizedVideoUrl() {\n      if (typeof this.videoStreamUrl === 'string' && this.videoStreamUrl.trim()) {\n        return this.videoStreamUrl;\n      }\n      return this.isStreaming ? this.defaultImage : '';\n    }\n  },\n  methods: {\n    // 处理刷新视频流\n    handleRefreshStream() {\n      this.videoErrorMessage = '';\n      this.$emit('refresh-stream');\n    },\n    // 处理图像加载错误\n    handleImageError(event) {\n      console.error('视频流加载失败:', event);\n      this.videoErrorMessage = '视频流加载失败';\n      // 如果有错误，使用默认图像作为后备\n      event.target.src = this.defaultImage;\n    },\n    // 获取状态对应的颜色\n    getStatusColor(status) {\n      const statusMap = {\n        '待命': 'success',\n        '飞行中': 'primary',\n        '暂停': 'warning',\n        '已停止': 'danger',\n        '返回中': 'danger'\n      };\n      return statusMap[status] || 'info';\n    },\n    // 获取电池状态\n    getBatteryStatus(level) {\n      if (level > 70) return '';\n      if (level > 30) return 'warning';\n      return 'exception';\n    },\n    // 格式化数字，保留一位小数\n    formatNumber(num) {\n      return Number(num).toFixed(1);\n    }\n  }\n};","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}