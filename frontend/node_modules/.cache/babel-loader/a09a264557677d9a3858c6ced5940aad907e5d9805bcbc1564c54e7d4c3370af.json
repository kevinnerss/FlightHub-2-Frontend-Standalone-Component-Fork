{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nimport { mapState, mapActions } from 'vuex';\nimport { ArrowDown, Refresh, RefreshLeft, Plus } from '@element-plus/icons-vue';\nimport DroneRouteList from '../components/DroneRouteList.vue';\nimport TaskProgressBar from '../components/TaskProgressBar.vue';\nimport AlarmPanel from '../components/AlarmPanel.vue';\nimport MonitorPanel from '../components/MonitorPanel.vue';\nimport ControlPanel from '../components/ControlPanel.vue';\nimport VisualizationPanel from '../components/VisualizationPanel.vue';\nexport default {\n  name: 'Dashboard',\n  components: {\n    DroneRouteList,\n    TaskProgressBar,\n    AlarmPanel,\n    MonitorPanel,\n    ControlPanel,\n    VisualizationPanel\n  },\n  computed: {\n    ...mapState(['droneRoutes', 'selectedRoute', 'taskProgress', 'currentTask', 'remainingTime', 'completedTasks', 'totalTasks', 'alarms', 'droneStatus', 'batteryLevel', 'currentAltitude', 'currentSpeed', 'targetAltitude', 'targetSpeed', 'videoStreamUrl', 'isStreaming'])\n  },\n  async mounted() {\n    // 初始化系统数据\n    await this.initializeSystem();\n\n    // 启动数据模拟更新\n    this.startDataSimulation();\n  },\n  methods: {\n    ...mapActions(['initializeSystem', 'selectRoute', 'processAlarm', 'controlDrone', 'updateTargetAltitude', 'updateTargetSpeed', 'emergencyStop', 'refreshStream']),\n    // 处理航线选择\n    handleRouteSelected(routeId) {\n      const route = this.droneRoutes.find(r => r.id === routeId);\n      this.selectRoute(route);\n    },\n    // 处理报警\n    handleAlarmProcessed(alarmId) {\n      this.processAlarm(alarmId);\n    },\n    // 处理控制动作\n    handleControlAction(action) {\n      this.controlDrone(action);\n    },\n    // 处理高度更新\n    handleUpdateAltitude(altitude) {\n      this.updateTargetAltitude(altitude);\n    },\n    // 处理速度更新\n    handleUpdateSpeed(speed) {\n      this.updateTargetSpeed(speed);\n    },\n    // 处理紧急停止\n    handleEmergencyStop() {\n      this.$confirm('确定执行紧急停止？这将立即中断所有飞行操作。', '紧急操作', {\n        confirmButtonText: '确认',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        this.emergencyStop();\n        this.$message.success('紧急停止指令已执行');\n      }).catch(() => {\n        this.$message.info('已取消紧急停止操作');\n      });\n    },\n    // 获取状态标签类型\n    getStatusTagType(status) {\n      switch (status) {\n        case '飞行中':\n          return 'success';\n        case '悬停中':\n          return 'info';\n        case '待命':\n          return 'primary';\n        case '返回中':\n          return 'warning';\n        case '已停止':\n          return 'danger';\n        default:\n          return 'info';\n      }\n    },\n    // 处理刷新视频流\n    handleRefreshStream() {\n      this.refreshStream();\n    },\n    // 处理视图模式变更\n    handleViewModeChanged(viewMode) {\n      console.log('视图模式变更为:', viewMode);\n    },\n    // 处理图层变更\n    handleLayersChanged(layers) {\n      console.log('图层设置变更:', layers);\n    },\n    // 启动数据模拟\n    startDataSimulation() {\n      // 模拟电池电量逐渐下降\n      setInterval(() => {\n        if (this.droneStatus === '飞行中' && this.batteryLevel > 0) {\n          this.$store.commit('SET_BATTERY_LEVEL', Math.max(0, this.batteryLevel - 0.5));\n        }\n      }, 10000);\n\n      // 模拟当前高度和目标高度逐渐接近\n      setInterval(() => {\n        if (this.droneStatus === '飞行中' && Math.abs(this.currentAltitude - this.targetAltitude) > 1) {\n          const newAltitude = this.currentAltitude + (this.targetAltitude > this.currentAltitude ? 1 : -1);\n          this.$store.commit('SET_CURRENT_ALTITUDE', newAltitude);\n        }\n        if (this.droneStatus === '飞行中' && Math.abs(this.currentSpeed - this.targetSpeed) > 0.5) {\n          const newSpeed = this.currentSpeed + (this.targetSpeed > this.currentSpeed ? 0.5 : -0.5);\n          this.$store.commit('SET_CURRENT_SPEED', newSpeed);\n        }\n      }, 2000);\n\n      // 模拟任务进度更新\n      setInterval(() => {\n        if (this.droneStatus === '飞行中' && this.taskProgress < 100) {\n          this.$store.commit('SET_TASK_PROGRESS', Math.min(100, this.taskProgress + 0.5));\n        }\n      }, 5000);\n    }\n  }\n};","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}