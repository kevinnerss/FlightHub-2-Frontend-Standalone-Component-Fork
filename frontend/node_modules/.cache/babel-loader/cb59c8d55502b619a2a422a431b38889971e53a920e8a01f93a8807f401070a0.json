{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, withCtx as _withCtx, openBlock as _openBlock, createElementBlock as _createElementBlock, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"flex justify-between items-center\"\n};\nconst _hoisted_2 = {\n  class: \"flex items-center\"\n};\nconst _hoisted_3 = {\n  class: \"flex items-center space-x-2\"\n};\nconst _hoisted_4 = {\n  class: \"relative\"\n};\nconst _hoisted_5 = {\n  class: \"aspect-video bg-gray-900 relative overflow-hidden\"\n};\nconst _hoisted_6 = [\"src\"];\nconst _hoisted_7 = {\n  key: 1,\n  class: \"w-full h-full flex flex-col items-center justify-center\"\n};\nconst _hoisted_8 = {\n  class: \"text-gray-600 text-sm\"\n};\nconst _hoisted_9 = {\n  class: \"p-4\"\n};\nconst _hoisted_10 = {\n  class: \"flex items-center\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_VideoCamera = _resolveComponent(\"VideoCamera\");\n  const _component_el_tag = _resolveComponent(\"el-tag\");\n  const _component_Refresh = _resolveComponent(\"Refresh\");\n  const _component_el_button = _resolveComponent(\"el-button\");\n  const _component_VideoPause = _resolveComponent(\"VideoPause\");\n  const _component_el_col = _resolveComponent(\"el-col\");\n  const _component_el_progress = _resolveComponent(\"el-progress\");\n  const _component_el_statistic = _resolveComponent(\"el-statistic\");\n  const _component_el_row = _resolveComponent(\"el-row\");\n  const _component_el_card = _resolveComponent(\"el-card\");\n  return _openBlock(), _createBlock(_component_el_card, {\n    class: \"h-full\",\n    shadow: \"hover\",\n    \"body-style\": {\n      padding: 0\n    }\n  }, {\n    header: _withCtx(() => [_createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createVNode(_component_VideoCamera, {\n      class: \"mr-2 text-primary\"\n    }), _cache[1] || (_cache[1] = _createElementVNode(\"span\", null, \"实时监控\", -1 /* CACHED */))]), _createElementVNode(\"div\", _hoisted_3, [_createVNode(_component_el_tag, {\n      type: $props.isStreaming ? 'success' : 'danger',\n      size: \"small\",\n      effect: \"dark\"\n    }, {\n      default: _withCtx(() => [_createTextVNode(_toDisplayString($props.isStreaming ? '直播中' : '已断开'), 1 /* TEXT */)]),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"type\"]), _createVNode(_component_el_button, {\n      size: \"small\",\n      circle: \"\",\n      onClick: $options.handleRefreshStream,\n      title: \"刷新视频流\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_Refresh)]),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"onClick\"])])])]),\n    default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"div\", _hoisted_5, [$options.sanitizedVideoUrl ? (_openBlock(), _createElementBlock(\"img\", {\n      key: 0,\n      src: $options.sanitizedVideoUrl,\n      alt: \"视频流\",\n      class: \"w-full h-full object-cover\",\n      onError: _cache[0] || (_cache[0] = (...args) => $options.handleImageError && $options.handleImageError(...args))\n    }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_6)) : (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [_createVNode(_component_VideoPause, {\n      class: \"text-gray-700 text-4xl mb-2\"\n    }), _createElementVNode(\"p\", _hoisted_8, _toDisplayString($data.videoErrorMessage || '暂无视频流'), 1 /* TEXT */)]))])]), _createElementVNode(\"div\", _hoisted_9, [_createVNode(_component_el_row, {\n      gutter: 20\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_col, {\n        span: 12\n      }, {\n        default: _withCtx(() => [_cache[2] || (_cache[2] = _createElementVNode(\"div\", {\n          class: \"mb-1 text-xs text-gray-500\"\n        }, \"状态\", -1 /* CACHED */)), _createElementVNode(\"div\", _hoisted_10, [_createVNode(_component_el_tag, {\n          type: $options.getStatusColor($options.safeDroneStatus),\n          size: \"small\",\n          class: \"mr-2\"\n        }, {\n          default: _withCtx(() => [_createTextVNode(_toDisplayString($options.safeDroneStatus), 1 /* TEXT */)]),\n          _: 1 /* STABLE */\n        }, 8 /* PROPS */, [\"type\"])])]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_col, {\n        span: 12\n      }, {\n        default: _withCtx(() => [_cache[3] || (_cache[3] = _createElementVNode(\"div\", {\n          class: \"mb-1 text-xs text-gray-500\"\n        }, \"电池电量\", -1 /* CACHED */)), _createVNode(_component_el_progress, {\n          percentage: Math.min(100, Math.max(0, $options.safeBatteryLevel)),\n          status: $options.getBatteryStatus($options.safeBatteryLevel),\n          format: () => `${Math.min(100, Math.max(0, $options.safeBatteryLevel))}%`,\n          size: \"small\"\n        }, null, 8 /* PROPS */, [\"percentage\", \"status\", \"format\"])]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_col, {\n        span: 12\n      }, {\n        default: _withCtx(() => [_cache[4] || (_cache[4] = _createElementVNode(\"div\", {\n          class: \"mb-1 text-xs text-gray-500\"\n        }, \"高度\", -1 /* CACHED */)), _createVNode(_component_el_statistic, {\n          value: $options.formatNumber($options.safeAltitude),\n          suffix: \"m\",\n          class: \"text-sm\"\n        }, null, 8 /* PROPS */, [\"value\"])]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_col, {\n        span: 12\n      }, {\n        default: _withCtx(() => [_cache[5] || (_cache[5] = _createElementVNode(\"div\", {\n          class: \"mb-1 text-xs text-gray-500\"\n        }, \"速度\", -1 /* CACHED */)), _createVNode(_component_el_statistic, {\n          value: $options.formatNumber($options.safeSpeed),\n          suffix: \"m/s\",\n          class: \"text-sm\"\n        }, null, 8 /* PROPS */, [\"value\"])]),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    })])]),\n    _: 1 /* STABLE */\n  });\n}","map":{"version":3,"names":["class","_createBlock","_component_el_card","shadow","padding","header","_withCtx","_createElementVNode","_hoisted_1","_hoisted_2","_createVNode","_component_VideoCamera","_hoisted_3","_component_el_tag","type","$props","isStreaming","size","effect","_component_el_button","circle","onClick","$options","handleRefreshStream","title","_component_Refresh","_hoisted_4","_hoisted_5","sanitizedVideoUrl","_createElementBlock","src","alt","onError","_cache","args","handleImageError","_hoisted_7","_component_VideoPause","_hoisted_8","_toDisplayString","$data","videoErrorMessage","_hoisted_9","_component_el_row","gutter","_component_el_col","span","_hoisted_10","getStatusColor","safeDroneStatus","_component_el_progress","percentage","Math","min","max","safeBatteryLevel","status","getBatteryStatus","format","_component_el_statistic","value","formatNumber","safeAltitude","suffix","safeSpeed"],"sources":["D:\\projects\\FlightHub-2-Frontend-Standalone-Component\\frontend\\src\\components\\MonitorPanel.vue"],"sourcesContent":["<template>\n  <el-card class=\"h-full\" shadow=\"hover\" :body-style=\"{ padding: 0 }\">\n    <!-- 标题栏 -->\n    <template #header>\n      <div class=\"flex justify-between items-center\">\n        <div class=\"flex items-center\">\n            <VideoCamera class=\"mr-2 text-primary\" />\n            <span>实时监控</span>\n          </div>\n        <div class=\"flex items-center space-x-2\">\n          <el-tag \n            :type=\"isStreaming ? 'success' : 'danger'\" \n            size=\"small\" \n            effect=\"dark\"\n          >\n            {{ isStreaming ? '直播中' : '已断开' }}\n          </el-tag>\n          <el-button \n              size=\"small\" \n              circle\n              @click=\"handleRefreshStream\"\n              title=\"刷新视频流\"\n            >\n              <Refresh />\n            </el-button>\n        </div>\n      </div>\n    </template>\n    \n    <!-- 视频流 -->\n    <div class=\"relative\">\n      <div class=\"aspect-video bg-gray-900 relative overflow-hidden\">\n        <img \n          v-if=\"sanitizedVideoUrl\" \n          :src=\"sanitizedVideoUrl\" \n          alt=\"视频流\" \n          class=\"w-full h-full object-cover\"\n          @error=\"handleImageError\"\n        >\n        <div v-else class=\"w-full h-full flex flex-col items-center justify-center\">\n            <VideoPause class=\"text-gray-700 text-4xl mb-2\" />\n            <p class=\"text-gray-600 text-sm\">{{ videoErrorMessage || '暂无视频流' }}</p>\n          </div>\n      </div>\n    </div>\n    \n    <!-- 状态信息 -->\n    <div class=\"p-4\">\n      <el-row :gutter=\"20\">\n        <el-col :span=\"12\">\n          <div class=\"mb-1 text-xs text-gray-500\">状态</div>\n          <div class=\"flex items-center\">\n            <el-tag \n              :type=\"getStatusColor(safeDroneStatus)\" \n              size=\"small\" \n              class=\"mr-2\"\n            >\n              {{ safeDroneStatus }}\n            </el-tag>\n          </div>\n        </el-col>\n        <el-col :span=\"12\">\n          <div class=\"mb-1 text-xs text-gray-500\">电池电量</div>\n          <el-progress \n            :percentage=\"Math.min(100, Math.max(0, safeBatteryLevel))\" \n            :status=\"getBatteryStatus(safeBatteryLevel)\"\n            :format=\"() => `${Math.min(100, Math.max(0, safeBatteryLevel))}%`\"\n            size=\"small\"\n          ></el-progress>\n        </el-col>\n        <el-col :span=\"12\">\n          <div class=\"mb-1 text-xs text-gray-500\">高度</div>\n          <el-statistic \n            :value=\"formatNumber(safeAltitude)\" \n            suffix=\"m\"\n            class=\"text-sm\"\n          ></el-statistic>\n        </el-col>\n        <el-col :span=\"12\">\n          <div class=\"mb-1 text-xs text-gray-500\">速度</div>\n          <el-statistic \n            :value=\"formatNumber(safeSpeed)\" \n            suffix=\"m/s\"\n            class=\"text-sm\"\n          ></el-statistic>\n        </el-col>\n      </el-row>\n    </div>\n  </el-card>\n</template>\n\n<script>\nimport { VideoCamera, VideoPause, Refresh } from '@element-plus/icons-vue'\n\nexport default {\n  name: 'MonitorPanel',\n  components: {\n    VideoCamera,\n    VideoPause,\n    Refresh\n  },\n  props: {\n    videoStreamUrl: {\n      type: String,\n      default: ''\n    },\n    isStreaming: {\n      type: Boolean,\n      default: false\n    },\n    droneStatus: {\n      type: String,\n      default: '待命'\n    },\n    batteryLevel: {\n      type: Number,\n      default: 100\n    },\n    altitude: {\n      type: Number,\n      default: 0\n    },\n    speed: {\n      type: Number,\n      default: 0\n    }\n  },\n  data() {\n    return {\n      videoErrorMessage: '',\n      // 默认的占位图像\n      defaultImage: 'https://picsum.photos/1280/720?random=default'\n    }\n  },\n  computed: {\n    // 安全的无人机状态\n    safeDroneStatus() {\n      return typeof this.droneStatus === 'string' && this.droneStatus.trim() ? this.droneStatus : '待命'\n    },\n    \n    // 安全的电池电量\n    safeBatteryLevel() {\n      const level = Number(this.batteryLevel)\n      return isNaN(level) ? 100 : level\n    },\n    \n    // 安全的高度\n    safeAltitude() {\n      const alt = Number(this.altitude)\n      return isNaN(alt) ? 0 : alt\n    },\n    \n    // 安全的速度\n    safeSpeed() {\n      const spd = Number(this.speed)\n      return isNaN(spd) ? 0 : spd\n    },\n    \n    // 净化后的视频URL\n    sanitizedVideoUrl() {\n      if (typeof this.videoStreamUrl === 'string' && this.videoStreamUrl.trim()) {\n        return this.videoStreamUrl\n      }\n      return this.isStreaming ? this.defaultImage : ''\n    }\n  },\n  methods: {\n    // 处理刷新视频流\n    handleRefreshStream() {\n      this.videoErrorMessage = ''\n      this.$emit('refresh-stream')\n    },\n    \n    // 处理图像加载错误\n    handleImageError(event) {\n      console.error('视频流加载失败:', event)\n      this.videoErrorMessage = '视频流加载失败'\n      // 如果有错误，使用默认图像作为后备\n      event.target.src = this.defaultImage\n    },\n    \n    // 获取状态对应的颜色\n    getStatusColor(status) {\n      const statusMap = {\n        '待命': 'success',\n        '飞行中': 'primary',\n        '暂停': 'warning',\n        '已停止': 'danger',\n        '返回中': 'danger'\n      }\n      return statusMap[status] || 'info'\n    },\n    \n    // 获取电池状态\n    getBatteryStatus(level) {\n      if (level > 70) return ''\n      if (level > 30) return 'warning'\n      return 'exception'\n    },\n    \n    // 格式化数字，保留一位小数\n    formatNumber(num) {\n      return Number(num).toFixed(1)\n    }\n  }\n}\n</script>\n\n<style scoped>\n/* 视频容器悬停效果 */\n.aspect-video {\n  transition: all 0.3s ease;\n  position: relative;\n  overflow: hidden;\n}\n\n.aspect-video:hover {\n  box-shadow: inset 0 0 0 2px rgba(59, 130, 246, 0.7);\n}\n\n/* 视频加载状态 */\nimg {\n  transition: opacity 0.5s ease-in-out, transform 0.3s ease;\n}\n\nimg:hover {\n  opacity: 0.95;\n  transform: scale(1.02);\n}\n\n/* 骨架屏加载动画 */\n:deep(.el-skeleton) {\n  animation: skeleton-loading 1.5s linear infinite alternate;\n}\n\n@keyframes skeleton-loading {\n  0% {\n    background-color: rgba(255, 255, 255, 0.1);\n  }\n  100% {\n    background-color: rgba(255, 255, 255, 0.2);\n  }\n}\n\n/* 视频控制栏样式 */\n.video-control-overlay {\n  transition: opacity 0.3s ease;\n}\n\n.video-control-overlay:hover {\n  opacity: 1;\n}\n\n/* 进度条样式 */\n:deep(.el-progress-bar__inner) {\n  transition: width 0.8s ease-in-out;\n}\n\n/* 悬停提示样式 */\n:deep(.el-tooltip__popper) {\n  font-size: 12px;\n  line-height: 1.4;\n}\n\n/* 状态标签样式 */\n:deep(.el-tag) {\n  transition: all 0.3s ease;\n}\n\n:deep(.el-tag:hover) {\n  transform: translateY(-1px);\n}\n\n/* 按钮悬停效果 */\n:deep(.el-button--plain:hover) {\n  transform: translateY(-1px);\n  box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);\n}\n\n/* 录制动画效果 */\n@keyframes pulse-red {\n  0%, 100% {\n    transform: scale(1);\n  }\n  50% {\n    transform: scale(1.1);\n  }\n}\n\n.recording-indicator {\n  animation: pulse-red 2s infinite;\n}\n\n/* 卡片样式调整 */\n:deep(.el-card) {\n  transition: all 0.3s ease;\n}\n\n/* 响应式设计 */\n@media (max-width: 768px) {\n  .aspect-video {\n    aspect-ratio: 16 / 9;\n  }\n  \n  .control-buttons .el-button {\n    width: 32px;\n    height: 32px;\n    padding: 4px;\n  }\n  \n  .control-buttons .el-icon {\n    font-size: 16px;\n  }\n  \n  .text-xs {\n    font-size: 10px;\n  }\n  \n  .text-sm {\n    font-size: 12px;\n  }\n}\n\n/* 动画效果优化 */\n.animate-pulse {\n  animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;\n}\n\n@keyframes pulse {\n  0%, 100% {\n    opacity: 1;\n  }\n  50% {\n    opacity: 0.5;\n  }\n}\n\n/* 卡片悬停效果 */\n:deep(.el-card__body) {\n  transition: all 0.3s ease;\n}\n\n/* 统计数字样式 */\n:deep(.el-statistic__content) {\n  font-weight: 600;\n  letter-spacing: -0.5px;\n}\n\n/* 渐变背景 */\n.gradient-overlay {\n  background: linear-gradient(to bottom, transparent, rgba(0, 0, 0, 0.7));\n}\n\n/* 时间显示样式 */\n.time-display {\n  background: rgba(0, 0, 0, 0.5);\n  border-radius: 12px;\n  padding: 2px 8px;\n  font-family: monospace;\n}\n\n/* 错误提示样式 */\n.text-gray-600 {\n  color: #6b7280;\n}\n\n.dark .text-gray-600 {\n  color: #9ca3af;\n}\n\n/* 确保元素在深色模式下正常显示 */\n.dark .aspect-video {\n  background-color: #1f2937;\n}\n\n.dark .bg-gray-900 {\n  background-color: #111827;\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}