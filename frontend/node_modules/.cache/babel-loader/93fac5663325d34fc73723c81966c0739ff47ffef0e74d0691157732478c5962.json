{"ast":null,"code":"export default {\n  name: 'DigitalTwin',\n  data() {\n    return {\n      viewer: null,\n      tileset: null,\n      loading: false,\n      error: '',\n      wireframe: false,\n      scale: 1.0,\n      rotation: 0,\n      modelState: '未加载',\n      modelPath: '/models/Model_0/tileset.json',\n      // 默认模型路径\n      resizeObserver: null,\n      debugInfo: '',\n      // 添加当前尺寸跟踪，避免不必要的调整\n      currentWidth: 0,\n      currentHeight: 0,\n      debouncedForceResize: null,\n      // 新增点选相关属性\n      pointSelectionEnabled: false,\n      selectedPoint: null,\n      clickHandler: null\n    };\n  },\n  async mounted() {\n    // 等待DOM更新完成后再初始化Cesium\n    this.$nextTick(async () => {\n      // 等待一小段时间确保DOM完全渲染\n      setTimeout(async () => {\n        // 等待Cesium资源加载完成后再初始化\n        await this.initCesium();\n\n        // 初始化 ResizeObserver\n        this.initResizeObserver();\n\n        // 自动加载默认模型\n        await this.loadModel();\n      }, 200);\n    });\n  },\n  beforeUnmount() {\n    if (this.viewer) {\n      this.viewer.destroy();\n    }\n    // 清理 ResizeObserver\n    if (this.resizeObserver) {\n      this.resizeObserver.disconnect();\n    }\n    // 移除窗口大小调整事件监听\n    window.removeEventListener('resize', this.handleWindowResize);\n    // 清理防抖函数的定时器\n    if (this.debouncedForceResize && this.debouncedForceResize.timeout) {\n      clearTimeout(this.debouncedForceResize.timeout);\n    }\n    // 清理点选相关的资源\n    if (this.clickHandler) {\n      this.clickHandler.destroy();\n    }\n  },\n  methods: {\n    async initCesium() {\n      try {\n        // 动态导入Cesium\n        const Cesium = await import('cesium');\n\n        // 设置Cesium的access token为空（因为我们使用的是本地资源）\n        Cesium.Ion.defaultAccessToken = '';\n\n        // 使用引用获取包装器元素\n        const wrapper = this.$refs.cesiumWrapper;\n        if (!wrapper) {\n          throw new Error('找不到 cesiumWrapper 元素');\n        }\n\n        // 移除已存在的Cesium容器（如果有）\n        const existingContainer = document.getElementById('cesiumContainer');\n        if (existingContainer) {\n          existingContainer.remove();\n        }\n\n        // 使用原生DOM操作创建容器，避免Vue响应式影响\n        const container = document.createElement('div');\n        container.id = 'cesiumContainer';\n\n        // 重要：在添加到DOM前先设置好样式\n        container.style.width = '100%';\n        container.style.height = '100%';\n        container.style.position = 'relative';\n        container.style.margin = '0';\n        container.style.padding = '0';\n        container.style.overflow = 'hidden';\n        container.style.zIndex = '1';\n\n        // 先将容器添加到DOM中\n        wrapper.appendChild(container);\n\n        // 确保容器有正确的尺寸\n        const width = wrapper.offsetWidth;\n        const height = wrapper.offsetHeight;\n        if (width <= 0 || height <= 0) {\n          throw new Error(`无效的容器尺寸: ${width}x${height}`);\n        }\n        console.log('初始化Cesium容器尺寸:', width, 'x', height);\n\n        // 初始化Cesium Viewer - 添加一些关键配置以确保正确的大小调整\n        this.viewer = new Cesium.Viewer(container, {\n          animation: false,\n          baseLayerPicker: false,\n          fullscreenButton: false,\n          vrButton: false,\n          geocoder: false,\n          homeButton: false,\n          infoBox: false,\n          sceneModePicker: false,\n          selectionIndicator: false,\n          timeline: false,\n          navigationHelpButton: false,\n          navigationInstructionsInitiallyVisible: false,\n          scene3DOnly: true,\n          shadows: true,\n          shouldAnimate: true,\n          creditContainer: document.createElement('div'),\n          // 关键配置：避免Cesium自动添加resize监听器，由我们自己控制\n          automaticallyTrackDataSourceClocks: false,\n          // 提高渲染性能\n          orderIndependentTranslucency: true,\n          // 确保canvas元素可以正确调整大小\n          contextOptions: {\n            alpha: true,\n            stencil: true\n          }\n        });\n\n        // 确保canvas元素的尺寸正确设置\n        if (this.viewer && this.viewer.canvas) {\n          this.viewer.canvas.style.width = '100%';\n          this.viewer.canvas.style.height = '100%';\n        }\n\n        // 设置初始视角\n        this.viewer.camera.setView({\n          destination: Cesium.Cartesian3.fromDegrees(116.3913, 39.9075, 1000),\n          orientation: {\n            heading: Cesium.Math.toRadians(0),\n            pitch: Cesium.Math.toRadians(-30),\n            roll: 0.0\n          }\n        });\n      } catch (err) {\n        this.error = '初始化Cesium失败: ' + err.message;\n        console.error('Cesium initialization error:', err);\n      }\n    },\n    // 防抖函数\n    debounce(func, wait) {\n      let timeout;\n      return function executedFunction(...args) {\n        const later = () => {\n          clearTimeout(timeout);\n          func(...args);\n        };\n        clearTimeout(timeout);\n        timeout = setTimeout(later, wait);\n      };\n    },\n    initResizeObserver() {\n      const wrapper = this.$refs.cesiumWrapper;\n      if (!wrapper) return;\n\n      // 移除任何现有的ResizeObserver，防止多个实例\n      if (this.resizeObserver) {\n        this.resizeObserver.disconnect();\n      }\n\n      // 创建更宽松的防抖函数\n      this.debouncedForceResize = this.debounce(() => {\n        if (this.viewer) {\n          console.log('防抖后调用forceResize');\n          this.forceResize();\n        }\n      }, 100); // 增加到100ms，给DOM更多时间稳定\n\n      // 创建 ResizeObserver 实例，但避免在回调中立即修改DOM\n      this.resizeObserver = new ResizeObserver(entries => {\n        // 记录尺寸变化，但不直接在回调中修改\n        if (entries.length > 0) {\n          const entry = entries[0];\n          const width = entry.contentRect.width;\n          const height = entry.contentRect.height;\n          console.log(`ResizeObserver检测到尺寸变化: ${width}x${height}`);\n        }\n        // 使用防抖函数延迟处理\n        this.debouncedForceResize();\n      });\n\n      // 只观察包装器元素\n      this.resizeObserver.observe(wrapper, {\n        box: 'content-box' // 观察内容盒大小\n      });\n\n      // 添加窗口调整大小事件监听\n      window.addEventListener('resize', this.handleWindowResize);\n\n      // 初始时立即调用一次调整大小\n      setTimeout(() => {\n        this.forceResize();\n      }, 100);\n    },\n    handleWindowResize() {\n      if (this.viewer) {\n        // 利用已定义的防抖函数\n        this.debouncedForceResize();\n      }\n    },\n    // 强制调整Cesium容器大小\n    forceResize() {\n      try {\n        console.log('开始强制调整大小...');\n        const wrapper = this.$refs.cesiumWrapper;\n        const container = document.getElementById('cesiumContainer');\n        if (!wrapper || !container || !this.viewer) {\n          console.warn('无法调整大小：缺少必要元素');\n          return;\n        }\n\n        // 强制重新计算布局\n        void wrapper.offsetHeight;\n\n        // 获取包装器的实际尺寸\n        const width = wrapper.offsetWidth;\n        const height = wrapper.offsetHeight;\n\n        // 避免无效尺寸\n        if (width <= 0 || height <= 0) {\n          console.warn('无效的容器尺寸，跳过调整:', width, 'x', height);\n          return;\n        }\n        console.log('获取到的包装器尺寸:', width, 'x', height);\n\n        // 更新调试信息\n        this.debugInfo = `Wrapper: ${width}x${height}`;\n\n        // 关键修改：使用百分比而非像素值，让CSS自动处理\n        container.style.width = '100%';\n        container.style.height = '100%';\n\n        // 确保canvas元素也使用百分比\n        if (this.viewer && this.viewer.canvas) {\n          this.viewer.canvas.style.width = '100%';\n          this.viewer.canvas.style.height = '100%';\n          console.log('设置canvas样式为100%宽高');\n        }\n\n        // 直接强制重新创建视图，而不是简单调用resize\n        if (this.viewer) {\n          console.log('调用scene.resize()和viewer.resize()');\n          // 先调用scene.resize()\n          this.viewer.scene.resize();\n          // 再调用viewer.resize()\n          this.viewer.resize();\n\n          // 强制重排和重绘\n          void container.offsetHeight;\n\n          // 延迟一帧再resize一次，确保生效\n          requestAnimationFrame(() => {\n            console.log('requestAnimationFrame中再次调用resize');\n            if (this.viewer) {\n              this.viewer.scene.resize();\n              this.viewer.resize();\n            }\n          });\n        }\n\n        // 更新调试信息\n        setTimeout(() => {\n          if (container && this.viewer && this.viewer.canvas) {\n            this.debugInfo = `Wrapper: ${width}x${height}, Canvas: ${this.viewer.canvas.clientWidth}x${this.viewer.canvas.clientHeight}`;\n          }\n        }, 100);\n        console.log('强制调整大小完成');\n      } catch (error) {\n        console.error('调整大小失败:', error);\n      }\n    },\n    // 检查容器尺寸（更新为适应新结构）\n    checkContainerSizes() {\n      const wrapper = this.$refs.cesiumWrapper;\n      const container = document.getElementById('cesiumContainer');\n      const mainContent = wrapper ? wrapper.closest('.main-content') : null;\n      if (wrapper && container) {\n        this.debugInfo = `Wrapper: ${wrapper.offsetWidth}x${wrapper.offsetHeight}, Container: ${container.offsetWidth}x${container.offsetHeight}`;\n        console.log('容器尺寸:', {\n          wrapper: {\n            width: wrapper.offsetWidth,\n            height: wrapper.offsetHeight\n          },\n          container: {\n            width: container.offsetWidth,\n            height: container.offsetHeight\n          },\n          mainContent: mainContent ? {\n            width: mainContent.offsetWidth,\n            height: mainContent.offsetHeight\n          } : null\n        });\n      }\n    },\n    async loadModel() {\n      if (!this.viewer || !this.modelPath) return;\n      this.loading = true;\n      this.error = '';\n      try {\n        // 动态导入Cesium\n        const Cesium = await import('cesium');\n\n        // 检查模型路径是否存在\n        try {\n          console.log('检查模型路径:', this.modelPath);\n          const response = await fetch(this.modelPath, {\n            method: 'HEAD'\n          });\n          if (!response.ok) {\n            throw new Error(`模型文件不存在或无法访问: ${this.modelPath} (状态码: ${response.status})`);\n          }\n          console.log('模型文件存在，状态码:', response.status);\n        } catch (err) {\n          throw new Error(`无法访问模型文件: ${err.message}`);\n        }\n\n        // 如果已有模型，先移除\n        if (this.tileset) {\n          console.log('移除现有模型');\n          this.viewer.scene.primitives.remove(this.tileset);\n          this.tileset = null;\n        }\n        console.log('开始加载模型:', this.modelPath);\n\n        // 加载3D Tiles数据集\n        this.tileset = await Cesium.Cesium3DTileset.fromUrl(this.modelPath);\n        console.log('模型对象创建成功:', this.tileset);\n\n        // 监听模型加载完成事件\n        if (this.tileset.readyPromise) {\n          console.log('等待模型准备完成...');\n          this.tileset.readyPromise.then(() => {\n            console.log('模型加载完成');\n            this.modelState = '已加载';\n            this.flyToModel();\n          }).catch(error => {\n            console.error('模型准备失败:', error);\n            this.error = '模型准备失败: ' + error.message;\n            this.modelState = '加载失败';\n          });\n        } else {\n          // 如果没有readyPromise，直接设置状态\n          console.log('模型已添加到场景');\n          this.modelState = '已加载';\n          this.flyToModel();\n        }\n\n        // 添加模型到场景\n        console.log('将模型添加到场景');\n        this.viewer.scene.primitives.add(this.tileset);\n        console.log('模型添加到场景完成');\n      } catch (err) {\n        console.error('模型加载失败:', err);\n        this.error = '模型加载失败: ' + err.message;\n        this.modelState = '加载失败';\n      } finally {\n        this.loading = false;\n      }\n    },\n    removeModel() {\n      if (this.tileset) {\n        this.viewer.scene.primitives.remove(this.tileset);\n        this.tileset = null;\n        this.modelState = '已移除';\n      }\n    },\n    flyToModel() {\n      if (this.viewer && this.tileset) {\n        this.viewer.flyTo(this.tileset);\n      }\n    },\n    async resetView() {\n      if (this.viewer) {\n        // 重置到初始视角\n        const Cesium = await import('cesium');\n        this.viewer.camera.setView({\n          destination: Cesium.Cartesian3.fromDegrees(116.3913, 39.9075, 1000),\n          orientation: {\n            heading: Cesium.Math.toRadians(0),\n            pitch: Cesium.Math.toRadians(-30),\n            roll: 0.0\n          }\n        });\n      }\n    },\n    toggleWireframe() {\n      if (!this.tileset) return;\n      this.wireframe = !this.wireframe;\n      this.tileset.debugWireframe = this.wireframe;\n    },\n    updateScale(value) {\n      if (!this.tileset) return;\n\n      // 应用缩放\n      console.log('更新模型缩放:', value);\n    },\n    updateRotation(value) {\n      if (!this.tileset) return;\n\n      // 应用旋转\n      console.log('更新模型旋转:', value);\n    },\n    // 新增点选相关方法\n    togglePointSelection() {\n      this.pointSelectionEnabled = !this.pointSelectionEnabled;\n      if (this.pointSelectionEnabled) {\n        this.enablePointSelection();\n      } else {\n        this.disablePointSelection();\n      }\n    },\n    async enablePointSelection() {\n      const Cesium = await import('cesium');\n\n      // 移除已有的点击事件处理器（如果存在）\n      if (this.clickHandler) {\n        this.clickHandler.destroy();\n      }\n\n      // 创建新的点击事件处理器\n      this.clickHandler = new Cesium.ScreenSpaceEventHandler(this.viewer.canvas);\n      this.clickHandler.setInputAction(async click => {\n        try {\n          // 优先使用射线检测获取精确位置\n          const ray = this.viewer.camera.getPickRay(click.position);\n          const intersection = this.viewer.scene.pickFromRay(ray, [this.tileset]);\n          if (intersection) {\n            const cartesian = intersection.position;\n\n            // 转换为经纬度坐标\n            const cartographic = Cesium.Cartographic.fromCartesian(cartesian);\n            const longitude = Cesium.Math.toDegrees(cartographic.longitude);\n            const latitude = Cesium.Math.toDegrees(cartographic.latitude);\n            const height = cartographic.height;\n\n            // 保存选中的点\n            this.selectedPoint = {\n              x: longitude,\n              y: latitude,\n              z: height,\n              cartesian: cartesian\n            };\n            console.log('从模型获取的精确点位:', this.selectedPoint);\n            return;\n          }\n\n          // 如果射线检测失败，尝试使用pick方法\n          const pickedObject = this.viewer.scene.pick(click.position);\n\n          // 检查是否有拾取到对象\n          if (pickedObject) {\n            console.log('拾取到对象:', pickedObject);\n            // 获取精确的拾取位置\n            let cartesian;\n\n            // 尝试从pick对象获取位置\n            if (pickedObject.position) {\n              if (typeof pickedObject.position === 'function') {\n                cartesian = pickedObject.position();\n              } else {\n                cartesian = pickedObject.position;\n              }\n            }\n\n            // 对于Cesium3DTileFeature对象，使用getProperty方法获取位置信息\n            if (!cartesian && pickedObject instanceof Cesium.Cesium3DTileFeature) {\n              // 尝试从feature获取位置信息\n              try {\n                // 这里我们使用射线检测，因为直接从feature获取精确位置比较复杂\n                const ray = this.viewer.camera.getPickRay(click.position);\n                const intersection = this.viewer.scene.pickFromRay(ray, [this.tileset]);\n                if (intersection) {\n                  cartesian = intersection.position;\n                }\n              } catch (e) {\n                console.log('无法从Cesium3DTileFeature获取位置:', e);\n              }\n            }\n\n            // 如果上面的方法没有获取到坐标，使用射线检测\n            if (!cartesian) {\n              const ray = this.viewer.camera.getPickRay(click.position);\n              const intersection = this.viewer.scene.pickFromRay(ray, [this.tileset]);\n              if (intersection) {\n                cartesian = intersection.position;\n              }\n            }\n\n            // 如果仍然没有获取到坐标，使用射线与地形的交点\n            if (!cartesian) {\n              const ray = this.viewer.camera.getPickRay(click.position);\n              cartesian = this.viewer.scene.globe.pick(ray, this.viewer.scene);\n            }\n            if (cartesian) {\n              // 转换为经纬度坐标\n              const cartographic = Cesium.Cartographic.fromCartesian(cartesian);\n              const longitude = Cesium.Math.toDegrees(cartographic.longitude);\n              const latitude = Cesium.Math.toDegrees(cartographic.latitude);\n              const height = cartographic.height;\n\n              // 保存选中的点\n              this.selectedPoint = {\n                x: longitude,\n                y: latitude,\n                z: height,\n                cartesian: cartesian\n              };\n              console.log('从模型获取的精确点位:', this.selectedPoint);\n            } else {\n              console.log('无法从模型获取精确点位');\n            }\n          } else {\n            console.log('点击的位置没有拾取到对象');\n\n            // 即使没有拾取到对象，也尝试获取射线与地球表面的交点\n            const ray = this.viewer.camera.getPickRay(click.position);\n            const cartesian = this.viewer.scene.globe.pick(ray, this.viewer.scene);\n            if (cartesian) {\n              // 转换为经纬度坐标\n              const cartographic = Cesium.Cartographic.fromCartesian(cartesian);\n              const longitude = Cesium.Math.toDegrees(cartographic.longitude);\n              const latitude = Cesium.Math.toDegrees(cartographic.latitude);\n              const height = cartographic.height;\n\n              // 保存选中的点\n              this.selectedPoint = {\n                x: longitude,\n                y: latitude,\n                z: height,\n                cartesian: cartesian\n              };\n              console.log('从地球表面获取的点位:', this.selectedPoint);\n            }\n          }\n        } catch (error) {\n          console.error('点选过程中出错:', error);\n        }\n      }, Cesium.ScreenSpaceEventType.LEFT_CLICK);\n    },\n    disablePointSelection() {\n      if (this.clickHandler) {\n        this.clickHandler.destroy();\n        this.clickHandler = null;\n      }\n    },\n    clearSelectedPoint() {\n      this.selectedPoint = null;\n    },\n    // 辅助方法：将模型定位到特定的地理坐标\n    async positionModelAtCoordinates(tileset, longitude, latitude, height = 0) {\n      // 这个方法可以在模型加载后调用，将模型放置在正确的地理坐标上\n      // 注意：如果模型文件本身已经包含了正确的地理位置信息，则不需要手动设置\n      const Cesium = window.Cesium || (await import('cesium'));\n\n      // 创建目标位置的笛卡尔坐标\n      const position = Cesium.Cartesian3.fromDegrees(longitude, latitude, height);\n\n      // 创建北向东向向上的参考帧\n      const orientation = Cesium.Transforms.headingPitchRollQuaternion(position, new Cesium.HeadingPitchRoll(0, 0, 0));\n\n      // 创建定位矩阵\n      const modelMatrix = Cesium.Matrix4.fromTranslationQuaternionRotationScale(position, orientation, new Cesium.Cartesian3(1, 1, 1), new Cesium.Matrix4());\n\n      // 应用到模型\n      tileset.modelMatrix = modelMatrix;\n    }\n  }\n};","map":{"version":3,"names":["name","data","viewer","tileset","loading","error","wireframe","scale","rotation","modelState","modelPath","resizeObserver","debugInfo","currentWidth","currentHeight","debouncedForceResize","pointSelectionEnabled","selectedPoint","clickHandler","mounted","$nextTick","setTimeout","initCesium","initResizeObserver","loadModel","beforeUnmount","destroy","disconnect","window","removeEventListener","handleWindowResize","timeout","clearTimeout","methods","Cesium","Ion","defaultAccessToken","wrapper","$refs","cesiumWrapper","Error","existingContainer","document","getElementById","remove","container","createElement","id","style","width","height","position","margin","padding","overflow","zIndex","appendChild","offsetWidth","offsetHeight","console","log","Viewer","animation","baseLayerPicker","fullscreenButton","vrButton","geocoder","homeButton","infoBox","sceneModePicker","selectionIndicator","timeline","navigationHelpButton","navigationInstructionsInitiallyVisible","scene3DOnly","shadows","shouldAnimate","creditContainer","automaticallyTrackDataSourceClocks","orderIndependentTranslucency","contextOptions","alpha","stencil","canvas","camera","setView","destination","Cartesian3","fromDegrees","orientation","heading","Math","toRadians","pitch","roll","err","message","debounce","func","wait","executedFunction","args","later","forceResize","ResizeObserver","entries","length","entry","contentRect","observe","box","addEventListener","warn","scene","resize","requestAnimationFrame","clientWidth","clientHeight","checkContainerSizes","mainContent","closest","response","fetch","method","ok","status","primitives","Cesium3DTileset","fromUrl","readyPromise","then","flyToModel","catch","add","removeModel","flyTo","resetView","toggleWireframe","debugWireframe","updateScale","value","updateRotation","togglePointSelection","enablePointSelection","disablePointSelection","ScreenSpaceEventHandler","setInputAction","click","ray","getPickRay","intersection","pickFromRay","cartesian","cartographic","Cartographic","fromCartesian","longitude","toDegrees","latitude","x","y","z","pickedObject","pick","Cesium3DTileFeature","e","globe","ScreenSpaceEventType","LEFT_CLICK","clearSelectedPoint","positionModelAtCoordinates","Transforms","headingPitchRollQuaternion","HeadingPitchRoll","modelMatrix","Matrix4","fromTranslationQuaternionRotationScale"],"sources":["D:\\projects\\FlightHub-2-Frontend-Standalone-Component\\frontend\\src\\views\\DigitalTwin.vue"],"sourcesContent":["<template>\n  <div class=\"digital-twin h-screen flex flex-col\">\n    <!-- 顶部导航 - 简化结构 -->\n    <div class=\"header bg-white border-b flex items-center justify-between px-4 h-16 flex-shrink-0\">\n      <div class=\"flex items-center\">\n        <h1 class=\"text-xl font-bold\">数字孪生系统</h1>\n      </div>\n      <div class=\"flex items-center gap-2\">\n        <el-button @click=\"resetView\">重置视角</el-button>\n        <el-button @click=\"toggleWireframe\">{{ wireframe ? '实体模式' : '线框模式' }}</el-button>\n        <!-- 调试信息 -->\n        <div v-if=\"debugInfo\" class=\"text-xs bg-gray-200 p-1 rounded\">\n          {{ debugInfo }}\n        </div>\n      </div>\n    </div>\n    \n    <!-- 主内容区 -->\n    <div class=\"main-content flex flex-1 overflow-hidden\">\n      <!-- 3D模型视图区域 - 简化嵌套结构 -->\n      <div class=\"model-view flex-1 flex flex-col\">\n        <!-- 视图控制栏 -->\n        <div class=\"view-controls p-2 bg-gray-100 border-b flex items-center justify-between\">\n          <span class=\"text-lg font-medium\">3D模型视图</span>\n          <div class=\"flex items-center gap-2\">\n            <el-input \n              v-model=\"modelPath\" \n              placeholder=\"输入模型路径，如: /models/Model_0/tileset.json\" \n              size=\"small\" \n              style=\"width: 350px\"\n            />\n            <el-button @click=\"loadModel\" size=\"small\">加载模型</el-button>\n            <el-button @click=\"forceResize\" size=\"small\">强制调整大小</el-button>\n            <!-- 新增点位选择按钮 -->\n            <el-button @click=\"togglePointSelection\" size=\"small\" :type=\"pointSelectionEnabled ? 'primary' : ''\">\n              {{ pointSelectionEnabled ? '退出点选模式' : '点选模式' }}\n            </el-button>\n          </div>\n        </div>\n        \n        <!-- Cesium容器 - 直接使用div而非多层嵌套 -->\n        <div ref=\"cesiumWrapper\" class=\"cesium-wrapper flex-1 relative\">\n          <!-- Cesium容器会动态创建 -->\n          \n          <!-- 加载指示器 -->\n          <div v-if=\"loading\" class=\"absolute inset-0 flex items-center justify-center bg-black bg-opacity-50 z-10\">\n            <el-spinner size=\"large\" />\n            <span class=\"ml-2 text-white\">正在加载模型...</span>\n          </div>\n          \n          <!-- 错误信息 -->\n          <div v-if=\"error\" class=\"absolute inset-0 flex items-center justify-center bg-black bg-opacity-50 z-10\">\n            <el-alert\n              :title=\"error\"\n              type=\"error\"\n              show-icon\n              class=\"w-96\"\n            />\n          </div>\n        </div>\n      </div>\n      \n      <!-- 右侧面板 -->\n      <div class=\"side-panel w-60 bg-white border-l p-4 overflow-y-auto\">\n        <!-- 模型控制面板 -->\n        <div class=\"panel-section mb-6\">\n          <h3 class=\"text-base font-medium mb-3\">模型控制</h3>\n          <div class=\"space-y-4\">\n            <div>\n              <label class=\"block text-sm font-medium mb-1\">模型缩放</label>\n              <el-slider \n                v-model=\"scale\" \n                :min=\"0.1\" \n                :max=\"5\" \n                :step=\"0.1\" \n                @change=\"updateScale\"\n                show-input\n              />\n            </div>\n            \n            <div>\n              <label class=\"block text-sm font-medium mb-1\">旋转角度</label>\n              <el-slider \n                v-model=\"rotation\" \n                :min=\"0\" \n                :max=\"360\" \n                @change=\"updateRotation\"\n                show-input\n              />\n            </div>\n            \n            <div class=\"grid grid-cols-2 gap-2\">\n              <el-button @click=\"removeModel\">移除模型</el-button>\n              <el-button @click=\"flyToModel\">飞向模型</el-button>\n            </div>\n          </div>\n        </div>\n        \n        <!-- 点位信息面板 -->\n        <div class=\"panel-section mb-6\" v-if=\"selectedPoint\">\n          <h3 class=\"text-base font-medium mb-3\">点位信息</h3>\n          <div class=\"space-y-2 text-sm\">\n            <div class=\"flex justify-between\">\n              <span class=\"text-gray-500\">X:</span>\n              <span>{{ selectedPoint.x.toFixed(3) }}</span>\n            </div>\n            <div class=\"flex justify-between\">\n              <span class=\"text-gray-500\">Y:</span>\n              <span>{{ selectedPoint.y.toFixed(3) }}</span>\n            </div>\n            <div class=\"flex justify-between\">\n              <span class=\"text-gray-500\">Z:</span>\n              <span>{{ selectedPoint.z.toFixed(3) }}</span>\n            </div>\n            <div class=\"mt-2\">\n              <el-button @click=\"clearSelectedPoint\" size=\"small\">清除点位</el-button>\n            </div>\n          </div>\n        </div>\n        \n        <!-- 模型信息面板 -->\n        <div class=\"panel-section mb-6\">\n          <h3 class=\"text-base font-medium mb-3\">模型信息</h3>\n          <div class=\"space-y-2 text-sm\">\n            <div class=\"flex justify-between\">\n              <span class=\"text-gray-500\">模型格式:</span>\n              <span>3D Tiles</span>\n            </div>\n            <div class=\"flex justify-between\">\n              <span class=\"text-gray-500\">模型状态:</span>\n              <span>{{ modelState }}</span>\n            </div>\n            <div class=\"flex justify-between\">\n              <span class=\"text-gray-500\">加载路径:</span>\n              <span class=\"text-xs\">{{ modelPath || '未指定' }}</span>\n            </div>\n          </div>\n        </div>\n        \n        <!-- 使用说明 -->\n        <div class=\"panel-section\">\n          <h3 class=\"text-base font-medium mb-3\">使用说明</h3>\n          <div class=\"text-xs text-gray-500 space-y-2\">\n            <p>1. 将3D Tiles数据集放入 <code>public/models/</code> 目录</p>\n            <p>2. 在上方输入框中输入模型路径</p>\n            <p>3. 点击\"加载模型\"按钮加载3D模型</p>\n            <p>4. 点击\"点选模式\"按钮可在模型上选择点位</p>\n            <p>5. 在点选模式下点击模型可获取真实世界经纬度坐标</p>\n            <p>6. 当前默认模型路径: <code>/models/Model_0/tileset.json</code></p>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'DigitalTwin',\n  data() {\n    return {\n      viewer: null,\n      tileset: null,\n      loading: false,\n      error: '',\n      wireframe: false,\n      scale: 1.0,\n      rotation: 0,\n      modelState: '未加载',\n      modelPath: '/models/Model_0/tileset.json', // 默认模型路径\n      resizeObserver: null,\n      debugInfo: '',\n      // 添加当前尺寸跟踪，避免不必要的调整\n      currentWidth: 0,\n      currentHeight: 0,\n      debouncedForceResize: null,\n      // 新增点选相关属性\n      pointSelectionEnabled: false,\n      selectedPoint: null,\n      clickHandler: null\n    }\n  },\n  async mounted() {\n    // 等待DOM更新完成后再初始化Cesium\n    this.$nextTick(async () => {\n      // 等待一小段时间确保DOM完全渲染\n      setTimeout(async () => {\n        // 等待Cesium资源加载完成后再初始化\n        await this.initCesium()\n        \n        // 初始化 ResizeObserver\n        this.initResizeObserver()\n        \n        // 自动加载默认模型\n        await this.loadModel()\n      }, 200)\n    })\n  },\n  beforeUnmount() {\n    if (this.viewer) {\n      this.viewer.destroy()\n    }\n    // 清理 ResizeObserver\n    if (this.resizeObserver) {\n      this.resizeObserver.disconnect()\n    }\n    // 移除窗口大小调整事件监听\n    window.removeEventListener('resize', this.handleWindowResize)\n    // 清理防抖函数的定时器\n    if (this.debouncedForceResize && this.debouncedForceResize.timeout) {\n      clearTimeout(this.debouncedForceResize.timeout)\n    }\n    // 清理点选相关的资源\n    if (this.clickHandler) {\n      this.clickHandler.destroy();\n    }\n  },\n  methods: {\n    async initCesium() {\n      try {\n        // 动态导入Cesium\n        const Cesium = await import('cesium')\n        \n        // 设置Cesium的access token为空（因为我们使用的是本地资源）\n        Cesium.Ion.defaultAccessToken = ''\n        \n        // 使用引用获取包装器元素\n        const wrapper = this.$refs.cesiumWrapper\n        if (!wrapper) {\n          throw new Error('找不到 cesiumWrapper 元素')\n        }\n        \n        // 移除已存在的Cesium容器（如果有）\n        const existingContainer = document.getElementById('cesiumContainer')\n        if (existingContainer) {\n          existingContainer.remove()\n        }\n        \n        // 使用原生DOM操作创建容器，避免Vue响应式影响\n        const container = document.createElement('div')\n        container.id = 'cesiumContainer'\n        \n        // 重要：在添加到DOM前先设置好样式\n        container.style.width = '100%'\n        container.style.height = '100%'\n        container.style.position = 'relative'\n        container.style.margin = '0'\n        container.style.padding = '0'\n        container.style.overflow = 'hidden'\n        container.style.zIndex = '1'\n        \n        // 先将容器添加到DOM中\n        wrapper.appendChild(container)\n        \n        // 确保容器有正确的尺寸\n        const width = wrapper.offsetWidth\n        const height = wrapper.offsetHeight\n        \n        if (width <= 0 || height <= 0) {\n          throw new Error(`无效的容器尺寸: ${width}x${height}`)\n        }\n        \n        console.log('初始化Cesium容器尺寸:', width, 'x', height)\n        \n        // 初始化Cesium Viewer - 添加一些关键配置以确保正确的大小调整\n        this.viewer = new Cesium.Viewer(container, {\n          animation: false,\n          baseLayerPicker: false,\n          fullscreenButton: false,\n          vrButton: false,\n          geocoder: false,\n          homeButton: false,\n          infoBox: false,\n          sceneModePicker: false,\n          selectionIndicator: false,\n          timeline: false,\n          navigationHelpButton: false,\n          navigationInstructionsInitiallyVisible: false,\n          scene3DOnly: true,\n          shadows: true,\n          shouldAnimate: true,\n          creditContainer: document.createElement('div'),\n          // 关键配置：避免Cesium自动添加resize监听器，由我们自己控制\n          automaticallyTrackDataSourceClocks: false,\n          // 提高渲染性能\n          orderIndependentTranslucency: true,\n          // 确保canvas元素可以正确调整大小\n          contextOptions: {\n            alpha: true,\n            stencil: true\n          }\n        })\n        \n        // 确保canvas元素的尺寸正确设置\n        if (this.viewer && this.viewer.canvas) {\n          this.viewer.canvas.style.width = '100%'\n          this.viewer.canvas.style.height = '100%'\n        }\n\n        // 设置初始视角\n        this.viewer.camera.setView({\n          destination: Cesium.Cartesian3.fromDegrees(116.3913, 39.9075, 1000),\n          orientation: {\n            heading: Cesium.Math.toRadians(0),\n            pitch: Cesium.Math.toRadians(-30),\n            roll: 0.0\n          }\n        })\n      } catch (err) {\n        this.error = '初始化Cesium失败: ' + err.message\n        console.error('Cesium initialization error:', err)\n      }\n    },\n    \n    // 防抖函数\n    debounce(func, wait) {\n      let timeout;\n      return function executedFunction(...args) {\n        const later = () => {\n          clearTimeout(timeout);\n          func(...args);\n        };\n        clearTimeout(timeout);\n        timeout = setTimeout(later, wait);\n      };\n    },\n    \n    initResizeObserver() {\n      const wrapper = this.$refs.cesiumWrapper\n      if (!wrapper) return\n      \n      // 移除任何现有的ResizeObserver，防止多个实例\n      if (this.resizeObserver) {\n        this.resizeObserver.disconnect()\n      }\n      \n      // 创建更宽松的防抖函数\n      this.debouncedForceResize = this.debounce(() => {\n        if (this.viewer) {\n          console.log('防抖后调用forceResize')\n          this.forceResize()\n        }\n      }, 100) // 增加到100ms，给DOM更多时间稳定\n      \n      // 创建 ResizeObserver 实例，但避免在回调中立即修改DOM\n      this.resizeObserver = new ResizeObserver(entries => {\n        // 记录尺寸变化，但不直接在回调中修改\n        if (entries.length > 0) {\n          const entry = entries[0]\n          const width = entry.contentRect.width\n          const height = entry.contentRect.height\n          console.log(`ResizeObserver检测到尺寸变化: ${width}x${height}`)\n        }\n        // 使用防抖函数延迟处理\n        this.debouncedForceResize()\n      })\n      \n      // 只观察包装器元素\n      this.resizeObserver.observe(wrapper, {\n        box: 'content-box' // 观察内容盒大小\n      })\n      \n      // 添加窗口调整大小事件监听\n      window.addEventListener('resize', this.handleWindowResize)\n      \n      // 初始时立即调用一次调整大小\n      setTimeout(() => {\n        this.forceResize()\n      }, 100)\n    },\n    \n    handleWindowResize() {\n      if (this.viewer) {\n        // 利用已定义的防抖函数\n        this.debouncedForceResize()\n      }\n    },\n    \n    // 强制调整Cesium容器大小\n    forceResize() {\n      try {\n        console.log('开始强制调整大小...')\n        const wrapper = this.$refs.cesiumWrapper\n        const container = document.getElementById('cesiumContainer')\n        \n        if (!wrapper || !container || !this.viewer) {\n          console.warn('无法调整大小：缺少必要元素')\n          return\n        }\n        \n        // 强制重新计算布局\n        void wrapper.offsetHeight\n        \n        // 获取包装器的实际尺寸\n        const width = wrapper.offsetWidth\n        const height = wrapper.offsetHeight\n        \n        // 避免无效尺寸\n        if (width <= 0 || height <= 0) {\n          console.warn('无效的容器尺寸，跳过调整:', width, 'x', height)\n          return\n        }\n        \n        console.log('获取到的包装器尺寸:', width, 'x', height)\n        \n        // 更新调试信息\n        this.debugInfo = `Wrapper: ${width}x${height}`\n        \n        // 关键修改：使用百分比而非像素值，让CSS自动处理\n        container.style.width = '100%'\n        container.style.height = '100%'\n        \n        // 确保canvas元素也使用百分比\n        if (this.viewer && this.viewer.canvas) {\n          this.viewer.canvas.style.width = '100%'\n          this.viewer.canvas.style.height = '100%'\n          console.log('设置canvas样式为100%宽高')\n        }\n        \n        // 直接强制重新创建视图，而不是简单调用resize\n        if (this.viewer) {\n          console.log('调用scene.resize()和viewer.resize()')\n          // 先调用scene.resize()\n          this.viewer.scene.resize()\n          // 再调用viewer.resize()\n          this.viewer.resize()\n          \n          // 强制重排和重绘\n          void container.offsetHeight\n          \n          // 延迟一帧再resize一次，确保生效\n          requestAnimationFrame(() => {\n            console.log('requestAnimationFrame中再次调用resize')\n            if (this.viewer) {\n              this.viewer.scene.resize()\n              this.viewer.resize()\n            }\n          })\n        }\n        \n        // 更新调试信息\n        setTimeout(() => {\n          if (container && this.viewer && this.viewer.canvas) {\n            this.debugInfo = `Wrapper: ${width}x${height}, Canvas: ${this.viewer.canvas.clientWidth}x${this.viewer.canvas.clientHeight}`\n          }\n        }, 100)\n        \n        console.log('强制调整大小完成')\n      } catch (error) {\n        console.error('调整大小失败:', error)\n      }\n    },\n    \n    // 检查容器尺寸（更新为适应新结构）\n    checkContainerSizes() {\n      const wrapper = this.$refs.cesiumWrapper;\n      const container = document.getElementById('cesiumContainer');\n      const mainContent = wrapper ? wrapper.closest('.main-content') : null;\n      \n      if (wrapper && container) {\n        this.debugInfo = `Wrapper: ${wrapper.offsetWidth}x${wrapper.offsetHeight}, Container: ${container.offsetWidth}x${container.offsetHeight}`;\n        console.log('容器尺寸:', {\n          wrapper: { width: wrapper.offsetWidth, height: wrapper.offsetHeight },\n          container: { width: container.offsetWidth, height: container.offsetHeight },\n          mainContent: mainContent ? { width: mainContent.offsetWidth, height: mainContent.offsetHeight } : null\n        });\n      }\n    },\n    \n    async loadModel() {\n      if (!this.viewer || !this.modelPath) return\n      \n      this.loading = true\n      this.error = ''\n      \n      try {\n        // 动态导入Cesium\n        const Cesium = await import('cesium')\n        \n        // 检查模型路径是否存在\n        try {\n          console.log('检查模型路径:', this.modelPath)\n          const response = await fetch(this.modelPath, { method: 'HEAD' })\n          if (!response.ok) {\n            throw new Error(`模型文件不存在或无法访问: ${this.modelPath} (状态码: ${response.status})`)\n          }\n          console.log('模型文件存在，状态码:', response.status)\n        } catch (err) {\n          throw new Error(`无法访问模型文件: ${err.message}`)\n        }\n        \n        // 如果已有模型，先移除\n        if (this.tileset) {\n          console.log('移除现有模型')\n          this.viewer.scene.primitives.remove(this.tileset)\n          this.tileset = null\n        }\n        \n        console.log('开始加载模型:', this.modelPath)\n        \n        // 加载3D Tiles数据集\n        this.tileset = await Cesium.Cesium3DTileset.fromUrl(this.modelPath)\n        console.log('模型对象创建成功:', this.tileset)\n        \n        // 监听模型加载完成事件\n        if (this.tileset.readyPromise) {\n          console.log('等待模型准备完成...')\n          this.tileset.readyPromise.then(() => {\n            console.log('模型加载完成')\n            this.modelState = '已加载'\n            this.flyToModel()\n          }).catch(error => {\n            console.error('模型准备失败:', error)\n            this.error = '模型准备失败: ' + error.message\n            this.modelState = '加载失败'\n          })\n        } else {\n          // 如果没有readyPromise，直接设置状态\n          console.log('模型已添加到场景')\n          this.modelState = '已加载'\n          this.flyToModel()\n        }\n        \n        // 添加模型到场景\n        console.log('将模型添加到场景')\n        this.viewer.scene.primitives.add(this.tileset)\n        \n        console.log('模型添加到场景完成')\n      } catch (err) {\n        console.error('模型加载失败:', err)\n        this.error = '模型加载失败: ' + err.message\n        this.modelState = '加载失败'\n      } finally {\n        this.loading = false\n      }\n    },\n    removeModel() {\n      if (this.tileset) {\n        this.viewer.scene.primitives.remove(this.tileset)\n        this.tileset = null\n        this.modelState = '已移除'\n      }\n    },\n    flyToModel() {\n      if (this.viewer && this.tileset) {\n        this.viewer.flyTo(this.tileset)\n      }\n    },\n    async resetView() {\n      if (this.viewer) {\n        // 重置到初始视角\n        const Cesium = await import('cesium')\n        this.viewer.camera.setView({\n          destination: Cesium.Cartesian3.fromDegrees(116.3913, 39.9075, 1000),\n          orientation: {\n            heading: Cesium.Math.toRadians(0),\n            pitch: Cesium.Math.toRadians(-30),\n            roll: 0.0\n          }\n        })\n      }\n    },\n    toggleWireframe() {\n      if (!this.tileset) return\n      \n      this.wireframe = !this.wireframe\n      this.tileset.debugWireframe = this.wireframe\n    },\n    updateScale(value) {\n      if (!this.tileset) return\n      \n      // 应用缩放\n      console.log('更新模型缩放:', value)\n    },\n    updateRotation(value) {\n      if (!this.tileset) return\n      \n      // 应用旋转\n      console.log('更新模型旋转:', value)\n    },\n    \n    // 新增点选相关方法\n    togglePointSelection() {\n      this.pointSelectionEnabled = !this.pointSelectionEnabled;\n      \n      if (this.pointSelectionEnabled) {\n        this.enablePointSelection();\n      } else {\n        this.disablePointSelection();\n      }\n    },\n    \n    async enablePointSelection() {\n      const Cesium = await import('cesium');\n      \n      // 移除已有的点击事件处理器（如果存在）\n      if (this.clickHandler) {\n        this.clickHandler.destroy();\n      }\n      \n      // 创建新的点击事件处理器\n      this.clickHandler = new Cesium.ScreenSpaceEventHandler(this.viewer.canvas);\n      this.clickHandler.setInputAction(async (click) => {\n        try {\n          // 优先使用射线检测获取精确位置\n          const ray = this.viewer.camera.getPickRay(click.position);\n          const intersection = this.viewer.scene.pickFromRay(ray, [this.tileset]);\n          \n          if (intersection) {\n            const cartesian = intersection.position;\n            \n            // 转换为经纬度坐标\n            const cartographic = Cesium.Cartographic.fromCartesian(cartesian);\n            const longitude = Cesium.Math.toDegrees(cartographic.longitude);\n            const latitude = Cesium.Math.toDegrees(cartographic.latitude);\n            const height = cartographic.height;\n            \n            // 保存选中的点\n            this.selectedPoint = {\n              x: longitude,\n              y: latitude,\n              z: height,\n              cartesian: cartesian\n            };\n            \n            console.log('从模型获取的精确点位:', this.selectedPoint);\n            return;\n          }\n          \n          // 如果射线检测失败，尝试使用pick方法\n          const pickedObject = this.viewer.scene.pick(click.position);\n          \n          // 检查是否有拾取到对象\n          if (pickedObject) {\n            console.log('拾取到对象:', pickedObject);\n            // 获取精确的拾取位置\n            let cartesian;\n            \n            // 尝试从pick对象获取位置\n            if (pickedObject.position) {\n              if (typeof pickedObject.position === 'function') {\n                cartesian = pickedObject.position();\n              } else {\n                cartesian = pickedObject.position;\n              }\n            }\n            \n            // 对于Cesium3DTileFeature对象，使用getProperty方法获取位置信息\n            if (!cartesian && pickedObject instanceof Cesium.Cesium3DTileFeature) {\n              // 尝试从feature获取位置信息\n              try {\n                // 这里我们使用射线检测，因为直接从feature获取精确位置比较复杂\n                const ray = this.viewer.camera.getPickRay(click.position);\n                const intersection = this.viewer.scene.pickFromRay(ray, [this.tileset]);\n                \n                if (intersection) {\n                  cartesian = intersection.position;\n                }\n              } catch (e) {\n                console.log('无法从Cesium3DTileFeature获取位置:', e);\n              }\n            }\n            \n            // 如果上面的方法没有获取到坐标，使用射线检测\n            if (!cartesian) {\n              const ray = this.viewer.camera.getPickRay(click.position);\n              const intersection = this.viewer.scene.pickFromRay(ray, [this.tileset]);\n              \n              if (intersection) {\n                cartesian = intersection.position;\n              }\n            }\n            \n            // 如果仍然没有获取到坐标，使用射线与地形的交点\n            if (!cartesian) {\n              const ray = this.viewer.camera.getPickRay(click.position);\n              cartesian = this.viewer.scene.globe.pick(ray, this.viewer.scene);\n            }\n            \n            if (cartesian) {\n              // 转换为经纬度坐标\n              const cartographic = Cesium.Cartographic.fromCartesian(cartesian);\n              const longitude = Cesium.Math.toDegrees(cartographic.longitude);\n              const latitude = Cesium.Math.toDegrees(cartographic.latitude);\n              const height = cartographic.height;\n              \n              // 保存选中的点\n              this.selectedPoint = {\n                x: longitude,\n                y: latitude,\n                z: height,\n                cartesian: cartesian\n              };\n              \n              console.log('从模型获取的精确点位:', this.selectedPoint);\n            } else {\n              console.log('无法从模型获取精确点位');\n            }\n          } else {\n            console.log('点击的位置没有拾取到对象');\n            \n            // 即使没有拾取到对象，也尝试获取射线与地球表面的交点\n            const ray = this.viewer.camera.getPickRay(click.position);\n            const cartesian = this.viewer.scene.globe.pick(ray, this.viewer.scene);\n            \n            if (cartesian) {\n              // 转换为经纬度坐标\n              const cartographic = Cesium.Cartographic.fromCartesian(cartesian);\n              const longitude = Cesium.Math.toDegrees(cartographic.longitude);\n              const latitude = Cesium.Math.toDegrees(cartographic.latitude);\n              const height = cartographic.height;\n              \n              // 保存选中的点\n              this.selectedPoint = {\n                x: longitude,\n                y: latitude,\n                z: height,\n                cartesian: cartesian\n              };\n              \n              console.log('从地球表面获取的点位:', this.selectedPoint);\n            }\n          }\n        } catch (error) {\n          console.error('点选过程中出错:', error);\n        }\n      }, Cesium.ScreenSpaceEventType.LEFT_CLICK);\n    },\n    \n    disablePointSelection() {\n      if (this.clickHandler) {\n        this.clickHandler.destroy();\n        this.clickHandler = null;\n      }\n    },\n    \n    clearSelectedPoint() {\n      this.selectedPoint = null;\n    },\n    \n    // 辅助方法：将模型定位到特定的地理坐标\n    async positionModelAtCoordinates(tileset, longitude, latitude, height = 0) {\n      // 这个方法可以在模型加载后调用，将模型放置在正确的地理坐标上\n      // 注意：如果模型文件本身已经包含了正确的地理位置信息，则不需要手动设置\n      const Cesium = window.Cesium || (await import('cesium'));\n      \n      // 创建目标位置的笛卡尔坐标\n      const position = Cesium.Cartesian3.fromDegrees(longitude, latitude, height);\n      \n      // 创建北向东向向上的参考帧\n      const orientation = Cesium.Transforms.headingPitchRollQuaternion(\n        position,\n        new Cesium.HeadingPitchRoll(0, 0, 0)\n      );\n      \n      // 创建定位矩阵\n      const modelMatrix = Cesium.Matrix4.fromTranslationQuaternionRotationScale(\n        position,\n        orientation,\n        new Cesium.Cartesian3(1, 1, 1),\n        new Cesium.Matrix4()\n      );\n      \n      // 应用到模型\n      tileset.modelMatrix = modelMatrix;\n    }\n  }\n}\n</script>\n\n<style scoped>\n/* 基础布局样式 */\n.digital-twin {\n  width: 100%;\n  height: 100vh;\n  box-sizing: border-box;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n}\n\n.header {\n  z-index: 10;\n}\n\n.main-content {\n  display: flex;\n  flex: 1;\n  overflow: hidden;\n}\n\n.model-view {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  min-width: 0; /* 防止flex子元素溢出 */\n}\n\n.view-controls {\n  flex-shrink: 0;\n}\n\n.cesium-wrapper {\n  flex: 1;\n  position: relative;\n  min-height: 0; /* 防止flex子元素溢出 */\n}\n\n.side-panel {\n  flex-shrink: 0;\n  min-height: 0; /* 防止flex子元素溢出 */\n}\n\n/* 面板部分样式 */\n.panel-section {\n  padding-bottom: 1rem;\n  border-bottom: 1px solid #eee;\n}\n\n.panel-section:last-child {\n  border-bottom: none;\n  padding-bottom: 0;\n}\n\n/* Cesium容器样式 - 通过JS动态设置，这里只设置基础样式 */\n#cesiumContainer {\n  position: absolute;\n  top: 0;\n  left: 0;\n  margin: 0;\n  padding: 0;\n  overflow: hidden;\n  z-index: 1;\n}\n\ncode {\n  background-color: #f1f1f1;\n  padding: 2px 4px;\n  border-radius: 3px;\n}\n\n/* 强制所有元素正确计算大小 */\n* {\n  box-sizing: border-box;\n}\n\n/* 确保弹性布局中的文本不会导致溢出 */\nspan, p {\n  word-break: break-word;\n  overflow-wrap: break-word;\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}