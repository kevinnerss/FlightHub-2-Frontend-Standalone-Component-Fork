{"ast":null,"code":"import defined from \"../Core/defined.js\";\nimport FeatureDetection from \"../Core/FeatureDetection.js\";\nimport RuntimeError from \"../Core/RuntimeError.js\";\nimport TaskProcessor from \"../Core/TaskProcessor.js\";\n\n/** * A sorter for Gaussian splats that uses a task processor to handle sorting in parallel.\n * This class is responsible for initializing the task processor and scheduling sorting tasks.\n * * @constructor\n * @private\n */\nfunction GaussianSplatSorter() {}\nGaussianSplatSorter._maxSortingConcurrency = Math.max(FeatureDetection.hardwareConcurrency - 1, 1);\nGaussianSplatSorter._sorterTaskProcessor = undefined;\nGaussianSplatSorter._taskProcessorReady = false;\nGaussianSplatSorter._error = undefined;\nGaussianSplatSorter._getSorterTaskProcessor = function () {\n  if (!defined(GaussianSplatSorter._sorterTaskProcessor)) {\n    const processor = new TaskProcessor(\"gaussianSplatSorter\", GaussianSplatSorter._maxSortingConcurrency);\n    processor.initWebAssemblyModule({\n      wasmBinaryFile: \"ThirdParty/wasm_splats_bg.wasm\"\n    }).then(function (result) {\n      if (result) {\n        GaussianSplatSorter._taskProcessorReady = true;\n      } else {\n        GaussianSplatSorter._error = new RuntimeError(\"Gaussian splat sorter could not be initialized.\");\n      }\n    }).catch(error => {\n      GaussianSplatSorter._error = error;\n    });\n    GaussianSplatSorter._sorterTaskProcessor = processor;\n  }\n  return GaussianSplatSorter._sorterTaskProcessor;\n};\n/**\n * Sorts Gaussian splats using a radix sort algorithm. Sorted by distance from the camera.\n * A new list of indexes is returned, which can be used to render the splats in the correct order.\n *\n * @param {Object} parameters - The parameters for sorting Gaussian splat indexes.\n * @param {Object} parameters.primitive - The primitive containing positions and modelView matrices.\n * @returns {Promise|undefined} A promise that resolves to the sorted indexes or undefined if the task cannot be scheduled.\n * @exception {RuntimeError} Sorter could not be initialized.\n * @private\n */\nGaussianSplatSorter.radixSortIndexes = function (parameters) {\n  const sorterTaskProcessor = GaussianSplatSorter._getSorterTaskProcessor();\n  if (defined(GaussianSplatSorter._error)) {\n    throw GaussianSplatSorter._error;\n  }\n  if (!GaussianSplatSorter._taskProcessorReady) {\n    return;\n  }\n  return sorterTaskProcessor.scheduleTask(parameters, [parameters.primitive.positions.buffer]);\n};\nexport default GaussianSplatSorter;","map":{"version":3,"names":["defined","FeatureDetection","RuntimeError","TaskProcessor","GaussianSplatSorter","_maxSortingConcurrency","Math","max","hardwareConcurrency","_sorterTaskProcessor","undefined","_taskProcessorReady","_error","_getSorterTaskProcessor","processor","initWebAssemblyModule","wasmBinaryFile","then","result","catch","error","radixSortIndexes","parameters","sorterTaskProcessor","scheduleTask","primitive","positions","buffer"],"sources":["D:/projects/FlightHub-2-Frontend-Standalone-Component/frontend/node_modules/@cesium/engine/Source/Scene/GaussianSplatSorter.js"],"sourcesContent":["import defined from \"../Core/defined.js\";\nimport FeatureDetection from \"../Core/FeatureDetection.js\";\nimport RuntimeError from \"../Core/RuntimeError.js\";\nimport TaskProcessor from \"../Core/TaskProcessor.js\";\n\n/** * A sorter for Gaussian splats that uses a task processor to handle sorting in parallel.\n * This class is responsible for initializing the task processor and scheduling sorting tasks.\n * * @constructor\n * @private\n */\nfunction GaussianSplatSorter() {}\n\nGaussianSplatSorter._maxSortingConcurrency = Math.max(\n  FeatureDetection.hardwareConcurrency - 1,\n  1,\n);\n\nGaussianSplatSorter._sorterTaskProcessor = undefined;\nGaussianSplatSorter._taskProcessorReady = false;\nGaussianSplatSorter._error = undefined;\nGaussianSplatSorter._getSorterTaskProcessor = function () {\n  if (!defined(GaussianSplatSorter._sorterTaskProcessor)) {\n    const processor = new TaskProcessor(\n      \"gaussianSplatSorter\",\n      GaussianSplatSorter._maxSortingConcurrency,\n    );\n    processor\n      .initWebAssemblyModule({\n        wasmBinaryFile: \"ThirdParty/wasm_splats_bg.wasm\",\n      })\n      .then(function (result) {\n        if (result) {\n          GaussianSplatSorter._taskProcessorReady = true;\n        } else {\n          GaussianSplatSorter._error = new RuntimeError(\n            \"Gaussian splat sorter could not be initialized.\",\n          );\n        }\n      })\n      .catch((error) => {\n        GaussianSplatSorter._error = error;\n      });\n    GaussianSplatSorter._sorterTaskProcessor = processor;\n  }\n\n  return GaussianSplatSorter._sorterTaskProcessor;\n};\n/**\n * Sorts Gaussian splats using a radix sort algorithm. Sorted by distance from the camera.\n * A new list of indexes is returned, which can be used to render the splats in the correct order.\n *\n * @param {Object} parameters - The parameters for sorting Gaussian splat indexes.\n * @param {Object} parameters.primitive - The primitive containing positions and modelView matrices.\n * @returns {Promise|undefined} A promise that resolves to the sorted indexes or undefined if the task cannot be scheduled.\n * @exception {RuntimeError} Sorter could not be initialized.\n * @private\n */\nGaussianSplatSorter.radixSortIndexes = function (parameters) {\n  const sorterTaskProcessor = GaussianSplatSorter._getSorterTaskProcessor();\n  if (defined(GaussianSplatSorter._error)) {\n    throw GaussianSplatSorter._error;\n  }\n\n  if (!GaussianSplatSorter._taskProcessorReady) {\n    return;\n  }\n\n  return sorterTaskProcessor.scheduleTask(parameters, [\n    parameters.primitive.positions.buffer,\n  ]);\n};\n\nexport default GaussianSplatSorter;\n"],"mappings":"AAAA,OAAOA,OAAO,MAAM,oBAAoB;AACxC,OAAOC,gBAAgB,MAAM,6BAA6B;AAC1D,OAAOC,YAAY,MAAM,yBAAyB;AAClD,OAAOC,aAAa,MAAM,0BAA0B;;AAEpD;AACA;AACA;AACA;AACA;AACA,SAASC,mBAAmBA,CAAA,EAAG,CAAC;AAEhCA,mBAAmB,CAACC,sBAAsB,GAAGC,IAAI,CAACC,GAAG,CACnDN,gBAAgB,CAACO,mBAAmB,GAAG,CAAC,EACxC,CACF,CAAC;AAEDJ,mBAAmB,CAACK,oBAAoB,GAAGC,SAAS;AACpDN,mBAAmB,CAACO,mBAAmB,GAAG,KAAK;AAC/CP,mBAAmB,CAACQ,MAAM,GAAGF,SAAS;AACtCN,mBAAmB,CAACS,uBAAuB,GAAG,YAAY;EACxD,IAAI,CAACb,OAAO,CAACI,mBAAmB,CAACK,oBAAoB,CAAC,EAAE;IACtD,MAAMK,SAAS,GAAG,IAAIX,aAAa,CACjC,qBAAqB,EACrBC,mBAAmB,CAACC,sBACtB,CAAC;IACDS,SAAS,CACNC,qBAAqB,CAAC;MACrBC,cAAc,EAAE;IAClB,CAAC,CAAC,CACDC,IAAI,CAAC,UAAUC,MAAM,EAAE;MACtB,IAAIA,MAAM,EAAE;QACVd,mBAAmB,CAACO,mBAAmB,GAAG,IAAI;MAChD,CAAC,MAAM;QACLP,mBAAmB,CAACQ,MAAM,GAAG,IAAIV,YAAY,CAC3C,iDACF,CAAC;MACH;IACF,CAAC,CAAC,CACDiB,KAAK,CAAEC,KAAK,IAAK;MAChBhB,mBAAmB,CAACQ,MAAM,GAAGQ,KAAK;IACpC,CAAC,CAAC;IACJhB,mBAAmB,CAACK,oBAAoB,GAAGK,SAAS;EACtD;EAEA,OAAOV,mBAAmB,CAACK,oBAAoB;AACjD,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAL,mBAAmB,CAACiB,gBAAgB,GAAG,UAAUC,UAAU,EAAE;EAC3D,MAAMC,mBAAmB,GAAGnB,mBAAmB,CAACS,uBAAuB,CAAC,CAAC;EACzE,IAAIb,OAAO,CAACI,mBAAmB,CAACQ,MAAM,CAAC,EAAE;IACvC,MAAMR,mBAAmB,CAACQ,MAAM;EAClC;EAEA,IAAI,CAACR,mBAAmB,CAACO,mBAAmB,EAAE;IAC5C;EACF;EAEA,OAAOY,mBAAmB,CAACC,YAAY,CAACF,UAAU,EAAE,CAClDA,UAAU,CAACG,SAAS,CAACC,SAAS,CAACC,MAAM,CACtC,CAAC;AACJ,CAAC;AAED,eAAevB,mBAAmB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}