{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.array-buffer.detached.js\";\nimport \"core-js/modules/es.array-buffer.transfer.js\";\nimport \"core-js/modules/es.array-buffer.transfer-to-fixed-length.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.reduce.js\";\nimport \"core-js/modules/es.typed-array.with.js\";\nimport \"core-js/modules/esnext.uint8-array.set-from-base64.js\";\nimport \"core-js/modules/esnext.uint8-array.set-from-hex.js\";\nimport \"core-js/modules/esnext.uint8-array.to-base64.js\";\nimport \"core-js/modules/esnext.uint8-array.to-hex.js\";\nimport defined from \"../Core/defined.js\";\nimport Resource from \"../Core/Resource.js\";\nimport GltfLoader from \"./GltfLoader.js\";\nimport RuntimeError from \"../Core/RuntimeError.js\";\nimport Axis from \"./Axis.js\";\nimport GaussianSplatPrimitive from \"./GaussianSplatPrimitive.js\";\nimport destroyObject from \"../Core/destroyObject.js\";\nimport ModelUtility from \"./Model/ModelUtility.js\";\nimport VertexAttributeSemantic from \"./VertexAttributeSemantic.js\";\nimport deprecationWarning from \"../Core/deprecationWarning.js\";\n\n/**\n * Represents the contents of a glTF or glb using the {@link https://github.com/CesiumGS/glTF/tree/draft-splat-spz/extensions/2.0/Khronos/KHR_gaussian_splatting | KHR_gaussian_splatting} and {@link https://github.com/CesiumGS/glTF/tree/draft-splat-spz/extensions/2.0/Khronos/KHR_gaussian_splatting_compression_spz_2 | KHR_gaussian_splatting_compression_spz_2} extensions.\n * <p>\n * Implements the {@link Cesium3DTileContent} interface.\n * </p>\n *\n * @alias GaussianSplat3DTileContent\n * @constructor\n */\nfunction GaussianSplat3DTileContent(loader, tileset, tile, resource) {\n  this._tileset = tileset;\n  this._tile = tile;\n  this._resource = resource;\n  this._loader = loader;\n  if (!defined(this._tileset.gaussianSplatPrimitive)) {\n    this._tileset.gaussianSplatPrimitive = new GaussianSplatPrimitive({\n      tileset: this._tileset\n    });\n  }\n\n  /**\n   * Local copy of the position attribute buffer that has been transformed into root tile space. Originals are kept in the gltf loader.\n   * Used for rendering\n   * @type {undefined|Float32Array}\n   * @private\n   */\n  this._positions = undefined;\n\n  /**\n   * Local copy of the rotation attribute buffer that has been transformed into root tile space. Originals are kept in the gltf loader.\n   * Used for rendering\n   * @type {undefined|Float32Array}\n   * @private\n   */\n  this._rotations = undefined;\n\n  /**\n   * Local copy of the scale attribute buffer that has been transformed into root tile space. Originals are kept in the gltf loader.\n   * Used for rendering\n   * @type {undefined|Float32Array}\n   * @private\n   */\n  this._scales = undefined;\n\n  /**\n   * glTF primitive data that contains the Gaussian splat data needed for rendering.\n   * @type {undefined|Primitive}\n   * @private\n   */\n  this.gltfPrimitive = undefined;\n\n  /**\n   * Transform matrix to turn model coordinates into world coordinates.\n   * @type {undefined|Matrix4}\n   * @private\n   */\n  this.worldTransform = undefined;\n\n  /**\n   * Gets or sets if any feature's property changed.  Used to\n   * optimized applying a style when a feature's property changed.\n   * <p>\n   * This is used to implement the <code>Cesium3DTileContent</code> interface, but is\n   * not part of the public Cesium API.\n   * </p>\n   *\n   * @type {boolean}\n   *\n   * @private\n   */\n  this.featurePropertiesDirty = false;\n  this._metadata = undefined;\n  this._group = undefined;\n  this._ready = false;\n  /**\n   * Indicates whether or not the local coordinates of the tile have been transformed\n   * @type {boolean}\n   * @private\n   */\n  this._transformed = false;\n\n  /**\n   * The degree of the spherical harmonics used for the Gaussian splats.\n   * @type {number}\n   * @private\n   */\n  this._sphericalHarmonicsDegree = 0;\n\n  /**\n   * The number of spherical harmonic coefficients used for the Gaussian splats.\n   * @type {number}\n   * @private\n   */\n  this._sphericalHarmonicsCoefficientCount = 0;\n\n  /**\n   * Spherical Harmonic data that has been packed for use in a texture or shader.\n   * @type {undefined|Uint32Array}\n   * @private\n   */\n  this._packedSphericalHarmonicsData = undefined;\n}\n\n/**\n * Performs checks to ensure that the provided tileset has the Gaussian Splatting extensions.\n *\n * @param {Cesium3DTileset} tileset The tileset to check for the extensions.\n * @returns {boolean} Returns <code>true</code> if the necessary extensions are included in the tileset.\n * @static\n */\nGaussianSplat3DTileContent.tilesetRequiresGaussianSplattingExt = function (tileset) {\n  let hasGaussianSplatExtension = false;\n  let hasLegacyGaussianSplatExtension = false;\n  if (tileset.isGltfExtensionRequired instanceof Function) {\n    hasGaussianSplatExtension = tileset.isGltfExtensionRequired(\"KHR_gaussian_splatting\") && tileset.isGltfExtensionRequired(\"KHR_gaussian_splatting_compression_spz_2\");\n    hasLegacyGaussianSplatExtension = tileset.isGltfExtensionRequired(\"KHR_spz_gaussian_splats_compression\");\n  }\n  if (hasLegacyGaussianSplatExtension) {\n    deprecationWarning(\"KHR_spz_gaussian_splats_compression\", \"Support for the original KHR_spz_gaussian_splats_compression extension has been deprecated in favor \" + \"of the up to date KHR_gaussian_splatting and KHR_gaussian_splatting_compression_spz_2 extensions and will be \" + \"removed in CesiumJS 1.135.\\n\\nPlease retile your tileset with the KHR_gaussian_splatting and \" + \"KHR_gaussian_splatting_compression_spz_2 extensions.\");\n  }\n  return hasGaussianSplatExtension || hasLegacyGaussianSplatExtension;\n};\nObject.defineProperties(GaussianSplat3DTileContent.prototype, {\n  /**\n   * Gets the number of features in the tile. Currently this is always zero.\n   *\n   * @memberof GaussianSplat3DTileContent.prototype\n   *\n   * @type {number}\n   * @readonly\n   */\n  featuresLength: {\n    get: function () {\n      return 0;\n    }\n  },\n  /**\n   * Equal to the number of Gaussian splats in the tile. Each splat is represented by a median point and a set of attributes, so we can\n   * treat this as the number of points in the tile.\n   *\n   * @memberof GaussianSplat3DTileContent.prototype\n   *\n   * @type {number}\n   * @readonly\n   */\n  pointsLength: {\n    get: function () {\n      return this.gltfPrimitive.attributes[0].count;\n    }\n  },\n  /**\n   * Gets the number of triangles in the tile. Currently this is always zero because Gaussian splats are not represented as triangles in the tile content.\n   * <p>\n   * @memberof GaussianSplat3DTileContent.prototype\n   *\n   * @type {number}\n   * @readonly\n   */\n  trianglesLength: {\n    get: function () {\n      return 0;\n    }\n  },\n  /**\n   * The number of bytes used by the geometry attributes of this content.\n   * <p>\n   * @memberof GaussianSplat3DTileContent.prototype\n   * @type {number}\n   * @readonly\n   */\n  geometryByteLength: {\n    get: function () {\n      return this.gltfPrimitive.attributes.reduce((totalLength, attribute) => {\n        return totalLength + attribute.byteLength;\n      }, 0);\n    }\n  },\n  /**\n   * The number of bytes used by the textures of this content.\n   * <p>\n   * @memberof GaussianSplat3DTileContent.prototype\n   * @type {number}\n   * @readonly\n   */\n  texturesByteLength: {\n    get: function () {\n      const texture = this._tileset.gaussianSplatPrimitive.gaussianSplatTexture;\n      const selectedTileLength = this._tileset.gaussianSplatPrimitive.selectedTileLength;\n      if (!defined(texture) || selectedTileLength === 0) {\n        return 0;\n      }\n      return texture.sizeInBytes / selectedTileLength;\n    }\n  },\n  /**\n   * Gets the amount of memory used by the batch table textures and any binary\n   * metadata properties not accounted for in geometryByteLength or\n   * texturesByteLength\n   * <p>\n   * @memberof GaussianSplat3DTileContent.prototype\n   *\n   * @type {number}\n   * @readonly\n   */\n  batchTableByteLength: {\n    // eslint-disable-next-line getter-return\n    get: function () {\n      return 0;\n    }\n  },\n  /**\n   * Gets the array of {@link Cesium3DTileContent} objects for contents that contain other contents, such as composite tiles. The inner contents may in turn have inner contents, such as a composite tile that contains a composite tile.\n   *\n   * @see {@link https://github.com/CesiumGS/3d-tiles/tree/main/specification/TileFormats/Composite|Composite specification}\n   *\n   * @memberof GaussianSplat3DTileContent.prototype\n   *\n   * @type {Array}\n   * @readonly\n   */\n  innerContents: {\n    get: function () {\n      return undefined;\n    }\n  },\n  /**\n   * Returns true when the tile's content is ready to render; otherwise false\n   *\n   * @memberof GaussianSplat3DTileContent.prototype\n   *\n   * @type {boolean}\n   * @readonly\n   */\n  ready: {\n    get: function () {\n      return this._ready;\n    }\n  },\n  /**\n   * Returns true when the tile's content is transformed to world coordinates; otherwise false\n   * <p>\n   * @memberof GaussianSplat3DTileContent.prototype\n   * @type {boolean}\n   * @readonly\n   */\n  transformed: {\n    get: function () {\n      return this._transformed;\n    }\n  },\n  /**\n   * The tileset that this content belongs to.\n   * <p>\n   * @memberof GaussianSplat3DTileContent.prototype\n   * @type {Cesium3DTileset}\n   * @readonly\n   */\n  tileset: {\n    get: function () {\n      return this._tileset;\n    }\n  },\n  /**\n   * The tile that this content belongs to.\n   * <p>\n   * @memberof GaussianSplat3DTileContent.prototype\n   * @type {Cesium3DTile}\n   * @readonly\n   */\n  tile: {\n    get: function () {\n      return this._tile;\n    }\n  },\n  /**\n   * The resource that this content was loaded from.\n   * <p>\n   * @memberof GaussianSplat3DTileContent.prototype\n   * @type {Resource}\n   * @readonly\n   */\n  url: {\n    get: function () {\n      return this._resource.getUrlComponent(true);\n    }\n  },\n  /**\n   * Gets the batch table for this content.\n   * <p>\n   * This is used to implement the <code>Cesium3DTileContent</code> interface, but is\n   * not part of the public Cesium API.\n   * </p>\n   *\n   * @type {Cesium3DTileBatchTable}\n   * @readonly\n   *\n   * @private\n   */\n  batchTable: {\n    get: function () {\n      return undefined;\n    }\n  },\n  /**\n   * Gets the metadata for this content, whether it is available explicitly or via\n   * implicit tiling. If there is no metadata, this property should be undefined.\n   * <p>\n   * This is used to implement the <code>Cesium3DTileContent</code> interface, but is\n   * not part of the public Cesium API.\n   * </p>\n   *\n   * @type {ImplicitMetadataView|undefined}\n   *\n   * @private\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   */\n  metadata: {\n    get: function () {\n      return this._metadata;\n    },\n    set: function (value) {\n      this._metadata = value;\n    }\n  },\n  /**\n   * Gets the group for this content if the content has metadata (3D Tiles 1.1) or\n   * if it uses the <code>3DTILES_metadata</code> extension. If neither are present,\n   * this property should be undefined.\n   * <p>\n   * This is used to implement the <code>Cesium3DTileContent</code> interface, but is\n   * not part of the public Cesium API.\n   * </p>\n   *\n   * @type {Cesium3DTileContentGroup|undefined}\n   *\n   * @private\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   */\n  group: {\n    get: function () {\n      return this._group;\n    },\n    set: function (value) {\n      this._group = value;\n    }\n  },\n  /**\n   * Get the transformed positions of this tile's Gaussian splats.\n   * @type {undefined|Float32Array}\n   * @private\n   */\n  positions: {\n    get: function () {\n      return this._positions;\n    }\n  },\n  /**\n   * Get the transformed rotations of this tile's Gaussian splats.\n   * @type {undefined|Float32Array}\n   * @private\n   */\n  rotations: {\n    get: function () {\n      return this._rotations;\n    }\n  },\n  /**\n   * Get the transformed scales of this tile's Gaussian splats.\n   * @type {undefined|Float32Array}\n   * @private\n   */\n  scales: {\n    get: function () {\n      return this._scales;\n    }\n  },\n  /**\n   * The number of spherical harmonic coefficients used for the Gaussian splats.\n   * @type {number}\n   * @private\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   */\n  sphericalHarmonicsCoefficientCount: {\n    get: function () {\n      return this._sphericalHarmonicsCoefficientCount;\n    }\n  },\n  /**\n   * The degree of the spherical harmonics used for the Gaussian splats.\n   * @type {number}\n   * @private\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   */\n  sphericalHarmonicsDegree: {\n    get: function () {\n      return this._sphericalHarmonicsDegree;\n    }\n  },\n  /**\n   * The packed spherical harmonic data for the Gaussian splats for use a shader or texture.\n   * @type {number}\n   * @private\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   */\n  packedSphericalHarmonicsData: {\n    get: function () {\n      return this._packedSphericalHarmonicsData;\n    }\n  }\n});\nfunction getShAttributePrefix(attribute) {\n  const prefix = attribute.startsWith(\"KHR_gaussian_splatting:\") ? \"KHR_gaussian_splatting:\" : \"_\";\n  return `${prefix}SH_DEGREE_`;\n}\n\n/**\n * Determine Spherical Harmonics degree and coefficient count from attributes\n * @param {Attribute[]} attributes - The list of glTF attributes.\n * @returns {object} An object containing the degree (l) and coefficient (n).\n * @private\n */\nfunction degreeAndCoefFromAttributes(attributes) {\n  const shAttributes = attributes.filter(attr => attr.name.includes(\"SH_DEGREE_\"));\n  switch (shAttributes.length) {\n    default:\n    case 0:\n      return {\n        l: 0,\n        n: 0\n      };\n    case 3:\n      return {\n        l: 1,\n        n: 9\n      };\n    case 8:\n      return {\n        l: 2,\n        n: 24\n      };\n    case 15:\n      return {\n        l: 3,\n        n: 45\n      };\n  }\n}\n\n/**\n * Converts a 32-bit floating point number to a 16-bit floating point number.\n * @param {number} float32 input\n * @returns {number} Half precision float\n * @private\n */\nconst buffer = new ArrayBuffer(4);\nconst floatView = new Float32Array(buffer);\nconst intView = new Uint32Array(buffer);\nfunction float32ToFloat16(float32) {\n  floatView[0] = float32;\n  const bits = intView[0];\n  const sign = bits >> 31 & 0x1;\n  const exponent = bits >> 23 & 0xff;\n  const mantissa = bits & 0x7fffff;\n  let half;\n  if (exponent === 0xff) {\n    half = sign << 15 | 0x1f << 10 | (mantissa ? 0x200 : 0);\n  } else if (exponent === 0) {\n    half = sign << 15;\n  } else {\n    const newExponent = exponent - 127 + 15;\n    if (newExponent >= 31) {\n      half = sign << 15 | 0x1f << 10;\n    } else if (newExponent <= 0) {\n      half = sign << 15;\n    } else {\n      half = sign << 15 | newExponent << 10 | mantissa >>> 13;\n    }\n  }\n  return half;\n}\n\n/**\n * Extracts the spherical harmonic degree and coefficient from the attribute name.\n * @param {string} attribute - The attribute name.\n * @returns {object} An object containing the degree (l) and coefficient (n).\n * @private\n */\nfunction extractSHDegreeAndCoef(attribute) {\n  const prefix = getShAttributePrefix(attribute);\n  const separator = \"_COEF_\";\n  const lStart = prefix.length;\n  const coefIndex = attribute.indexOf(separator, lStart);\n  const l = parseInt(attribute.slice(lStart, coefIndex), 10);\n  const n = parseInt(attribute.slice(coefIndex + separator.length), 10);\n  return {\n    l,\n    n\n  };\n}\n\n/**\n * Packs spherical harmonic data into half-precision floats.\n * @param {GaussianSplat3DTileContent} tileContent - The tile content containing the spherical harmonic data.\n * @returns {Uint32Array} - The Float16 packed spherical harmonic data.\n * @private\n */\nfunction packSphericalHarmonicsData(tileContent) {\n  const degree = tileContent.sphericalHarmonicsDegree;\n  const coefs = tileContent.sphericalHarmonicsCoefficientCount;\n  const totalLength = tileContent.pointsLength * (coefs * (2 / 3)); //3 packs into 2\n  const packedData = new Uint32Array(totalLength);\n  const shAttributes = tileContent.gltfPrimitive.attributes.filter(attr => attr.name.includes(\"SH_DEGREE_\"));\n  let stride = 0;\n  const base = [0, 9, 24];\n  switch (degree) {\n    case 1:\n      stride = 9;\n      break;\n    case 2:\n      stride = 24;\n      break;\n    case 3:\n      stride = 45;\n      break;\n  }\n  shAttributes.sort((a, b) => {\n    if (a.name < b.name) {\n      return -1;\n    }\n    if (a.name > b.name) {\n      return 1;\n    }\n    return 0;\n  });\n  const packedStride = stride * (2 / 3);\n  for (let i = 0; i < shAttributes.length; i++) {\n    const {\n      l,\n      n\n    } = extractSHDegreeAndCoef(shAttributes[i].name);\n    for (let j = 0; j < tileContent.pointsLength; j++) {\n      //interleave the data\n      const packedBase = base[l - 1] * 2 / 3;\n      const idx = j * packedStride + packedBase + n * 2;\n      const src = j * 3;\n      packedData[idx] = float32ToFloat16(shAttributes[i].typedArray[src]) | float32ToFloat16(shAttributes[i].typedArray[src + 1]) << 16;\n      packedData[idx + 1] = float32ToFloat16(shAttributes[i].typedArray[src + 2]);\n    }\n  }\n  return packedData;\n}\n\n/**\n * Creates a new instance of {@link GaussianSplat3DTileContent} from a glTF or glb resource.\n *\n * @param {Cesium3DTileset} tileset - The tileset that this content belongs to.\n * @param {Cesium3DTile} tile - The tile that this content belongs to.\n * @param {Resource|string} resource - The resource or URL of the glTF or glb file.\n * @param {object|Uint8Array} gltf - The glTF JSON object or a Uint8Array containing the glb binary data.\n * @returns {GaussianSplat3DTileContent} A new GaussianSplat3DTileContent instance.\n * @throws {RuntimeError} If the glTF or glb fails to load.\n * @private\n */\nGaussianSplat3DTileContent.fromGltf = async function (tileset, tile, resource, gltf) {\n  const basePath = resource;\n  const baseResource = Resource.createIfNeeded(basePath);\n  const loaderOptions = {\n    releaseGltfJson: false,\n    upAxis: Axis.Y,\n    forwardAxis: Axis.Z\n  };\n  if (defined(gltf.asset)) {\n    loaderOptions.gltfJson = gltf;\n    loaderOptions.baseResource = baseResource;\n    loaderOptions.gltfResource = baseResource;\n  } else if (gltf instanceof Uint8Array) {\n    loaderOptions.typedArray = gltf;\n    loaderOptions.baseResource = baseResource;\n    loaderOptions.gltfResource = baseResource;\n  } else {\n    loaderOptions.gltfResource = Resource.createIfNeeded(gltf);\n  }\n  const loader = new GltfLoader(loaderOptions);\n  try {\n    await loader.load();\n  } catch (error) {\n    loader.destroy();\n    throw new RuntimeError(`Failed to load glTF: ${error.message}`);\n  }\n  return new GaussianSplat3DTileContent(loader, tileset, tile, resource);\n};\n\n/**\n * Updates the content of the tile and prepares it for rendering.\n * @param {Cesium3DTileset}￼Data attribution\n * @param {FrameState} frameState - The current frame state.\n * @private\n */\nGaussianSplat3DTileContent.prototype.update = function (primitive, frameState) {\n  const loader = this._loader;\n  if (this._ready) {\n    if (!this._transformed && primitive.root.content.ready) {\n      GaussianSplatPrimitive.transformTile(this._tile);\n      this._transformed = true;\n    }\n    return;\n  }\n  frameState.afterRender.push(() => true);\n  if (!defined(loader)) {\n    this._ready = true;\n    return;\n  }\n  if (this._resourcesLoaded) {\n    this.gltfPrimitive = loader.components.scene.nodes[0].primitives[0];\n    this.worldTransform = loader.components.scene.nodes[0].matrix;\n    this._ready = true;\n    this._positions = new Float32Array(ModelUtility.getAttributeBySemantic(this.gltfPrimitive, VertexAttributeSemantic.POSITION).typedArray);\n    this._rotations = new Float32Array(ModelUtility.getAttributeBySemantic(this.gltfPrimitive, VertexAttributeSemantic.ROTATION).typedArray);\n    this._scales = new Float32Array(ModelUtility.getAttributeBySemantic(this.gltfPrimitive, VertexAttributeSemantic.SCALE).typedArray);\n    const {\n      l,\n      n\n    } = degreeAndCoefFromAttributes(this.gltfPrimitive.attributes);\n    this._sphericalHarmonicsDegree = l;\n    this._sphericalHarmonicsCoefficientCount = n;\n    this._packedSphericalHarmonicsData = packSphericalHarmonicsData(this);\n    return;\n  }\n  this._resourcesLoaded = loader.process(frameState);\n};\n/**\n * Returns whether the feature has this property.\n *\n * @param {number} batchId The batchId for the feature.\n * @param {string} name The case-sensitive name of the property.\n * @returns {boolean} <code>true</code> if the feature has this property; otherwise, <code>false</code>.\n */\nGaussianSplat3DTileContent.prototype.hasProperty = function (batchId, name) {\n  return false;\n};\n\n/**\n * Returns the {@link Cesium3DTileFeature} object for the feature with the\n * given <code>batchId</code>.  This object is used to get and modify the\n * feature's properties.\n * <p>\n * Features in a tile are ordered by <code>batchId</code>, an index used to retrieve their metadata from the batch table.\n * </p>\n *\n * @see {@link https://github.com/CesiumGS/3d-tiles/tree/main/specification/TileFormats/BatchTable}.\n *\n * @param {number} batchId The batchId for the feature.\n * @returns {Cesium3DTileFeature} The corresponding {@link Cesium3DTileFeature} object.\n *\n * @exception {DeveloperError} batchId must be between zero and {@link Cesium3DTileContent#featuresLength} - 1.\n */\nGaussianSplat3DTileContent.prototype.getFeature = function (batchId) {\n  return undefined;\n};\n/**\n     * Called when {@link Cesium3DTileset#debugColorizeTiles} changes.\n     * <p>\n     * This is used to implement the <code>Cesium3DTileContent</code> interface, but is\n     * not part of the public Cesium API.\n     * </p>\n     *\n     * @param {boolean} enabled Whether to enable or disable debug settings.\n     * @returns {Cesium3DTileFeature} The corresponding {@link Cesium3DTileFeature} object.\n\n     * @private\n     */\nGaussianSplat3DTileContent.prototype.applyDebugSettings = function (enabled, color) {};\n/**\n * Apply a style to the content\n * <p>\n * This is used to implement the <code>Cesium3DTileContent</code> interface, but is\n * not part of the public Cesium API.\n * </p>\n *\n * @param {Cesium3DTileStyle} style The style.\n *\n * @private\n */\nGaussianSplat3DTileContent.prototype.applyStyle = function (style) {};\n/**\n * Find an intersection between a ray and the tile content surface that was rendered. The ray must be given in world coordinates.\n *\n * @param {Ray} ray The ray to test for intersection.\n * @param {FrameState} frameState The frame state.\n * @param {Cartesian3|undefined} [result] The intersection or <code>undefined</code> if none was found.\n * @returns {Cartesian3|undefined} The intersection or <code>undefined</code> if none was found.\n *\n * @private\n */\nGaussianSplat3DTileContent.prototype.pick = function (ray, frameState, result) {\n  return undefined;\n};\n/**\n * Returns true if this object was destroyed; otherwise, false.\n * <br /><br />\n * If this object was destroyed, it should not be used; calling any function other than\n * <code>isDestroyed</code> will result in a {@link DeveloperError} exception.\n * <p>\n * This is used to implement the <code>Cesium3DTileContent</code> interface, but is\n * not part of the public Cesium API.\n * </p>\n *\n * @returns {boolean} <code>true</code> if this object was destroyed; otherwise, <code>false</code>.\n *\n * @see Cesium3DTileContent#destroy\n *\n * @private\n */\nGaussianSplat3DTileContent.prototype.isDestroyed = function () {\n  return this.isDestroyed;\n};\n\n/**\n * Frees the resources used by this object.\n * @private\n */\nGaussianSplat3DTileContent.prototype.destroy = function () {\n  this.splatPrimitive = undefined;\n  if (defined(this._tileset.gaussianSplatPrimitive) && !this._tileset.gaussianSplatPrimitive.isDestroyed()) {\n    this._tileset.gaussianSplatPrimitive.destroy();\n  }\n  this._tileset.gaussianSplatPrimitive = undefined;\n  this._tile = undefined;\n  this._tileset = undefined;\n  this._resource = undefined;\n  this._ready = false;\n  this._group = undefined;\n  this._metadata = undefined;\n  this._resourcesLoaded = false;\n  if (defined(this._loader)) {\n    this._loader.destroy();\n    this._loader = undefined;\n  }\n  return destroyObject(this);\n};\nexport default GaussianSplat3DTileContent;","map":{"version":3,"names":["defined","Resource","GltfLoader","RuntimeError","Axis","GaussianSplatPrimitive","destroyObject","ModelUtility","VertexAttributeSemantic","deprecationWarning","GaussianSplat3DTileContent","loader","tileset","tile","resource","_tileset","_tile","_resource","_loader","gaussianSplatPrimitive","_positions","undefined","_rotations","_scales","gltfPrimitive","worldTransform","featurePropertiesDirty","_metadata","_group","_ready","_transformed","_sphericalHarmonicsDegree","_sphericalHarmonicsCoefficientCount","_packedSphericalHarmonicsData","tilesetRequiresGaussianSplattingExt","hasGaussianSplatExtension","hasLegacyGaussianSplatExtension","isGltfExtensionRequired","Function","Object","defineProperties","prototype","featuresLength","get","pointsLength","attributes","count","trianglesLength","geometryByteLength","reduce","totalLength","attribute","byteLength","texturesByteLength","texture","gaussianSplatTexture","selectedTileLength","sizeInBytes","batchTableByteLength","innerContents","ready","transformed","url","getUrlComponent","batchTable","metadata","set","value","group","positions","rotations","scales","sphericalHarmonicsCoefficientCount","sphericalHarmonicsDegree","packedSphericalHarmonicsData","getShAttributePrefix","prefix","startsWith","degreeAndCoefFromAttributes","shAttributes","filter","attr","name","includes","length","l","n","buffer","ArrayBuffer","floatView","Float32Array","intView","Uint32Array","float32ToFloat16","float32","bits","sign","exponent","mantissa","half","newExponent","extractSHDegreeAndCoef","separator","lStart","coefIndex","indexOf","parseInt","slice","packSphericalHarmonicsData","tileContent","degree","coefs","packedData","stride","base","sort","a","b","packedStride","i","j","packedBase","idx","src","typedArray","fromGltf","gltf","basePath","baseResource","createIfNeeded","loaderOptions","releaseGltfJson","upAxis","Y","forwardAxis","Z","asset","gltfJson","gltfResource","Uint8Array","load","error","destroy","message","update","primitive","frameState","root","content","transformTile","afterRender","push","_resourcesLoaded","components","scene","nodes","primitives","matrix","getAttributeBySemantic","POSITION","ROTATION","SCALE","process","hasProperty","batchId","getFeature","applyDebugSettings","enabled","color","applyStyle","style","pick","ray","result","isDestroyed","splatPrimitive"],"sources":["D:/projects/FlightHub-2-Frontend-Standalone-Component/frontend/node_modules/@cesium/engine/Source/Scene/GaussianSplat3DTileContent.js"],"sourcesContent":["import defined from \"../Core/defined.js\";\nimport Resource from \"../Core/Resource.js\";\nimport GltfLoader from \"./GltfLoader.js\";\nimport RuntimeError from \"../Core/RuntimeError.js\";\nimport Axis from \"./Axis.js\";\nimport GaussianSplatPrimitive from \"./GaussianSplatPrimitive.js\";\nimport destroyObject from \"../Core/destroyObject.js\";\nimport ModelUtility from \"./Model/ModelUtility.js\";\nimport VertexAttributeSemantic from \"./VertexAttributeSemantic.js\";\nimport deprecationWarning from \"../Core/deprecationWarning.js\";\n\n/**\n * Represents the contents of a glTF or glb using the {@link https://github.com/CesiumGS/glTF/tree/draft-splat-spz/extensions/2.0/Khronos/KHR_gaussian_splatting | KHR_gaussian_splatting} and {@link https://github.com/CesiumGS/glTF/tree/draft-splat-spz/extensions/2.0/Khronos/KHR_gaussian_splatting_compression_spz_2 | KHR_gaussian_splatting_compression_spz_2} extensions.\n * <p>\n * Implements the {@link Cesium3DTileContent} interface.\n * </p>\n *\n * @alias GaussianSplat3DTileContent\n * @constructor\n */\nfunction GaussianSplat3DTileContent(loader, tileset, tile, resource) {\n  this._tileset = tileset;\n  this._tile = tile;\n  this._resource = resource;\n  this._loader = loader;\n\n  if (!defined(this._tileset.gaussianSplatPrimitive)) {\n    this._tileset.gaussianSplatPrimitive = new GaussianSplatPrimitive({\n      tileset: this._tileset,\n    });\n  }\n\n  /**\n   * Local copy of the position attribute buffer that has been transformed into root tile space. Originals are kept in the gltf loader.\n   * Used for rendering\n   * @type {undefined|Float32Array}\n   * @private\n   */\n  this._positions = undefined;\n\n  /**\n   * Local copy of the rotation attribute buffer that has been transformed into root tile space. Originals are kept in the gltf loader.\n   * Used for rendering\n   * @type {undefined|Float32Array}\n   * @private\n   */\n  this._rotations = undefined;\n\n  /**\n   * Local copy of the scale attribute buffer that has been transformed into root tile space. Originals are kept in the gltf loader.\n   * Used for rendering\n   * @type {undefined|Float32Array}\n   * @private\n   */\n  this._scales = undefined;\n\n  /**\n   * glTF primitive data that contains the Gaussian splat data needed for rendering.\n   * @type {undefined|Primitive}\n   * @private\n   */\n  this.gltfPrimitive = undefined;\n\n  /**\n   * Transform matrix to turn model coordinates into world coordinates.\n   * @type {undefined|Matrix4}\n   * @private\n   */\n  this.worldTransform = undefined;\n\n  /**\n   * Gets or sets if any feature's property changed.  Used to\n   * optimized applying a style when a feature's property changed.\n   * <p>\n   * This is used to implement the <code>Cesium3DTileContent</code> interface, but is\n   * not part of the public Cesium API.\n   * </p>\n   *\n   * @type {boolean}\n   *\n   * @private\n   */\n  this.featurePropertiesDirty = false;\n\n  this._metadata = undefined;\n  this._group = undefined;\n  this._ready = false;\n  /**\n   * Indicates whether or not the local coordinates of the tile have been transformed\n   * @type {boolean}\n   * @private\n   */\n  this._transformed = false;\n\n  /**\n   * The degree of the spherical harmonics used for the Gaussian splats.\n   * @type {number}\n   * @private\n   */\n  this._sphericalHarmonicsDegree = 0;\n\n  /**\n   * The number of spherical harmonic coefficients used for the Gaussian splats.\n   * @type {number}\n   * @private\n   */\n  this._sphericalHarmonicsCoefficientCount = 0;\n\n  /**\n   * Spherical Harmonic data that has been packed for use in a texture or shader.\n   * @type {undefined|Uint32Array}\n   * @private\n   */\n  this._packedSphericalHarmonicsData = undefined;\n}\n\n/**\n * Performs checks to ensure that the provided tileset has the Gaussian Splatting extensions.\n *\n * @param {Cesium3DTileset} tileset The tileset to check for the extensions.\n * @returns {boolean} Returns <code>true</code> if the necessary extensions are included in the tileset.\n * @static\n */\nGaussianSplat3DTileContent.tilesetRequiresGaussianSplattingExt = function (\n  tileset,\n) {\n  let hasGaussianSplatExtension = false;\n  let hasLegacyGaussianSplatExtension = false;\n  if (tileset.isGltfExtensionRequired instanceof Function) {\n    hasGaussianSplatExtension =\n      tileset.isGltfExtensionRequired(\"KHR_gaussian_splatting\") &&\n      tileset.isGltfExtensionRequired(\n        \"KHR_gaussian_splatting_compression_spz_2\",\n      );\n\n    hasLegacyGaussianSplatExtension = tileset.isGltfExtensionRequired(\n      \"KHR_spz_gaussian_splats_compression\",\n    );\n  }\n\n  if (hasLegacyGaussianSplatExtension) {\n    deprecationWarning(\n      \"KHR_spz_gaussian_splats_compression\",\n      \"Support for the original KHR_spz_gaussian_splats_compression extension has been deprecated in favor \" +\n        \"of the up to date KHR_gaussian_splatting and KHR_gaussian_splatting_compression_spz_2 extensions and will be \" +\n        \"removed in CesiumJS 1.135.\\n\\nPlease retile your tileset with the KHR_gaussian_splatting and \" +\n        \"KHR_gaussian_splatting_compression_spz_2 extensions.\",\n    );\n  }\n\n  return hasGaussianSplatExtension || hasLegacyGaussianSplatExtension;\n};\n\nObject.defineProperties(GaussianSplat3DTileContent.prototype, {\n  /**\n   * Gets the number of features in the tile. Currently this is always zero.\n   *\n   * @memberof GaussianSplat3DTileContent.prototype\n   *\n   * @type {number}\n   * @readonly\n   */\n  featuresLength: {\n    get: function () {\n      return 0;\n    },\n  },\n\n  /**\n   * Equal to the number of Gaussian splats in the tile. Each splat is represented by a median point and a set of attributes, so we can\n   * treat this as the number of points in the tile.\n   *\n   * @memberof GaussianSplat3DTileContent.prototype\n   *\n   * @type {number}\n   * @readonly\n   */\n  pointsLength: {\n    get: function () {\n      return this.gltfPrimitive.attributes[0].count;\n    },\n  },\n  /**\n   * Gets the number of triangles in the tile. Currently this is always zero because Gaussian splats are not represented as triangles in the tile content.\n   * <p>\n   * @memberof GaussianSplat3DTileContent.prototype\n   *\n   * @type {number}\n   * @readonly\n   */\n  trianglesLength: {\n    get: function () {\n      return 0;\n    },\n  },\n  /**\n   * The number of bytes used by the geometry attributes of this content.\n   * <p>\n   * @memberof GaussianSplat3DTileContent.prototype\n   * @type {number}\n   * @readonly\n   */\n  geometryByteLength: {\n    get: function () {\n      return this.gltfPrimitive.attributes.reduce((totalLength, attribute) => {\n        return totalLength + attribute.byteLength;\n      }, 0);\n    },\n  },\n  /**\n   * The number of bytes used by the textures of this content.\n   * <p>\n   * @memberof GaussianSplat3DTileContent.prototype\n   * @type {number}\n   * @readonly\n   */\n  texturesByteLength: {\n    get: function () {\n      const texture = this._tileset.gaussianSplatPrimitive.gaussianSplatTexture;\n      const selectedTileLength =\n        this._tileset.gaussianSplatPrimitive.selectedTileLength;\n      if (!defined(texture) || selectedTileLength === 0) {\n        return 0;\n      }\n      return texture.sizeInBytes / selectedTileLength;\n    },\n  },\n  /**\n   * Gets the amount of memory used by the batch table textures and any binary\n   * metadata properties not accounted for in geometryByteLength or\n   * texturesByteLength\n   * <p>\n   * @memberof GaussianSplat3DTileContent.prototype\n   *\n   * @type {number}\n   * @readonly\n   */\n  batchTableByteLength: {\n    // eslint-disable-next-line getter-return\n    get: function () {\n      return 0;\n    },\n  },\n  /**\n   * Gets the array of {@link Cesium3DTileContent} objects for contents that contain other contents, such as composite tiles. The inner contents may in turn have inner contents, such as a composite tile that contains a composite tile.\n   *\n   * @see {@link https://github.com/CesiumGS/3d-tiles/tree/main/specification/TileFormats/Composite|Composite specification}\n   *\n   * @memberof GaussianSplat3DTileContent.prototype\n   *\n   * @type {Array}\n   * @readonly\n   */\n  innerContents: {\n    get: function () {\n      return undefined;\n    },\n  },\n\n  /**\n   * Returns true when the tile's content is ready to render; otherwise false\n   *\n   * @memberof GaussianSplat3DTileContent.prototype\n   *\n   * @type {boolean}\n   * @readonly\n   */\n  ready: {\n    get: function () {\n      return this._ready;\n    },\n  },\n\n  /**\n   * Returns true when the tile's content is transformed to world coordinates; otherwise false\n   * <p>\n   * @memberof GaussianSplat3DTileContent.prototype\n   * @type {boolean}\n   * @readonly\n   */\n  transformed: {\n    get: function () {\n      return this._transformed;\n    },\n  },\n\n  /**\n   * The tileset that this content belongs to.\n   * <p>\n   * @memberof GaussianSplat3DTileContent.prototype\n   * @type {Cesium3DTileset}\n   * @readonly\n   */\n  tileset: {\n    get: function () {\n      return this._tileset;\n    },\n  },\n  /**\n   * The tile that this content belongs to.\n   * <p>\n   * @memberof GaussianSplat3DTileContent.prototype\n   * @type {Cesium3DTile}\n   * @readonly\n   */\n  tile: {\n    get: function () {\n      return this._tile;\n    },\n  },\n  /**\n   * The resource that this content was loaded from.\n   * <p>\n   * @memberof GaussianSplat3DTileContent.prototype\n   * @type {Resource}\n   * @readonly\n   */\n  url: {\n    get: function () {\n      return this._resource.getUrlComponent(true);\n    },\n  },\n  /**\n   * Gets the batch table for this content.\n   * <p>\n   * This is used to implement the <code>Cesium3DTileContent</code> interface, but is\n   * not part of the public Cesium API.\n   * </p>\n   *\n   * @type {Cesium3DTileBatchTable}\n   * @readonly\n   *\n   * @private\n   */\n  batchTable: {\n    get: function () {\n      return undefined;\n    },\n  },\n  /**\n   * Gets the metadata for this content, whether it is available explicitly or via\n   * implicit tiling. If there is no metadata, this property should be undefined.\n   * <p>\n   * This is used to implement the <code>Cesium3DTileContent</code> interface, but is\n   * not part of the public Cesium API.\n   * </p>\n   *\n   * @type {ImplicitMetadataView|undefined}\n   *\n   * @private\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   */\n  metadata: {\n    get: function () {\n      return this._metadata;\n    },\n    set: function (value) {\n      this._metadata = value;\n    },\n  },\n  /**\n   * Gets the group for this content if the content has metadata (3D Tiles 1.1) or\n   * if it uses the <code>3DTILES_metadata</code> extension. If neither are present,\n   * this property should be undefined.\n   * <p>\n   * This is used to implement the <code>Cesium3DTileContent</code> interface, but is\n   * not part of the public Cesium API.\n   * </p>\n   *\n   * @type {Cesium3DTileContentGroup|undefined}\n   *\n   * @private\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   */\n  group: {\n    get: function () {\n      return this._group;\n    },\n    set: function (value) {\n      this._group = value;\n    },\n  },\n\n  /**\n   * Get the transformed positions of this tile's Gaussian splats.\n   * @type {undefined|Float32Array}\n   * @private\n   */\n  positions: {\n    get: function () {\n      return this._positions;\n    },\n  },\n  /**\n   * Get the transformed rotations of this tile's Gaussian splats.\n   * @type {undefined|Float32Array}\n   * @private\n   */\n  rotations: {\n    get: function () {\n      return this._rotations;\n    },\n  },\n\n  /**\n   * Get the transformed scales of this tile's Gaussian splats.\n   * @type {undefined|Float32Array}\n   * @private\n   */\n  scales: {\n    get: function () {\n      return this._scales;\n    },\n  },\n\n  /**\n   * The number of spherical harmonic coefficients used for the Gaussian splats.\n   * @type {number}\n   * @private\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   */\n  sphericalHarmonicsCoefficientCount: {\n    get: function () {\n      return this._sphericalHarmonicsCoefficientCount;\n    },\n  },\n  /**\n   * The degree of the spherical harmonics used for the Gaussian splats.\n   * @type {number}\n   * @private\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   */\n  sphericalHarmonicsDegree: {\n    get: function () {\n      return this._sphericalHarmonicsDegree;\n    },\n  },\n\n  /**\n   * The packed spherical harmonic data for the Gaussian splats for use a shader or texture.\n   * @type {number}\n   * @private\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   */\n  packedSphericalHarmonicsData: {\n    get: function () {\n      return this._packedSphericalHarmonicsData;\n    },\n  },\n});\n\nfunction getShAttributePrefix(attribute) {\n  const prefix = attribute.startsWith(\"KHR_gaussian_splatting:\")\n    ? \"KHR_gaussian_splatting:\"\n    : \"_\";\n  return `${prefix}SH_DEGREE_`;\n}\n\n/**\n * Determine Spherical Harmonics degree and coefficient count from attributes\n * @param {Attribute[]} attributes - The list of glTF attributes.\n * @returns {object} An object containing the degree (l) and coefficient (n).\n * @private\n */\nfunction degreeAndCoefFromAttributes(attributes) {\n  const shAttributes = attributes.filter((attr) =>\n    attr.name.includes(\"SH_DEGREE_\"),\n  );\n\n  switch (shAttributes.length) {\n    default:\n    case 0:\n      return { l: 0, n: 0 };\n    case 3:\n      return { l: 1, n: 9 };\n    case 8:\n      return { l: 2, n: 24 };\n    case 15:\n      return { l: 3, n: 45 };\n  }\n}\n\n/**\n * Converts a 32-bit floating point number to a 16-bit floating point number.\n * @param {number} float32 input\n * @returns {number} Half precision float\n * @private\n */\nconst buffer = new ArrayBuffer(4);\nconst floatView = new Float32Array(buffer);\nconst intView = new Uint32Array(buffer);\n\nfunction float32ToFloat16(float32) {\n  floatView[0] = float32;\n  const bits = intView[0];\n\n  const sign = (bits >> 31) & 0x1;\n  const exponent = (bits >> 23) & 0xff;\n  const mantissa = bits & 0x7fffff;\n\n  let half;\n\n  if (exponent === 0xff) {\n    half = (sign << 15) | (0x1f << 10) | (mantissa ? 0x200 : 0);\n  } else if (exponent === 0) {\n    half = sign << 15;\n  } else {\n    const newExponent = exponent - 127 + 15;\n    if (newExponent >= 31) {\n      half = (sign << 15) | (0x1f << 10);\n    } else if (newExponent <= 0) {\n      half = sign << 15;\n    } else {\n      half = (sign << 15) | (newExponent << 10) | (mantissa >>> 13);\n    }\n  }\n\n  return half;\n}\n\n/**\n * Extracts the spherical harmonic degree and coefficient from the attribute name.\n * @param {string} attribute - The attribute name.\n * @returns {object} An object containing the degree (l) and coefficient (n).\n * @private\n */\nfunction extractSHDegreeAndCoef(attribute) {\n  const prefix = getShAttributePrefix(attribute);\n  const separator = \"_COEF_\";\n\n  const lStart = prefix.length;\n  const coefIndex = attribute.indexOf(separator, lStart);\n\n  const l = parseInt(attribute.slice(lStart, coefIndex), 10);\n  const n = parseInt(attribute.slice(coefIndex + separator.length), 10);\n\n  return { l, n };\n}\n\n/**\n * Packs spherical harmonic data into half-precision floats.\n * @param {GaussianSplat3DTileContent} tileContent - The tile content containing the spherical harmonic data.\n * @returns {Uint32Array} - The Float16 packed spherical harmonic data.\n * @private\n */\nfunction packSphericalHarmonicsData(tileContent) {\n  const degree = tileContent.sphericalHarmonicsDegree;\n  const coefs = tileContent.sphericalHarmonicsCoefficientCount;\n  const totalLength = tileContent.pointsLength * (coefs * (2 / 3)); //3 packs into 2\n  const packedData = new Uint32Array(totalLength);\n\n  const shAttributes = tileContent.gltfPrimitive.attributes.filter((attr) =>\n    attr.name.includes(\"SH_DEGREE_\"),\n  );\n  let stride = 0;\n  const base = [0, 9, 24];\n  switch (degree) {\n    case 1:\n      stride = 9;\n      break;\n    case 2:\n      stride = 24;\n      break;\n    case 3:\n      stride = 45;\n      break;\n  }\n  shAttributes.sort((a, b) => {\n    if (a.name < b.name) {\n      return -1;\n    }\n    if (a.name > b.name) {\n      return 1;\n    }\n\n    return 0;\n  });\n  const packedStride = stride * (2 / 3);\n  for (let i = 0; i < shAttributes.length; i++) {\n    const { l, n } = extractSHDegreeAndCoef(shAttributes[i].name);\n    for (let j = 0; j < tileContent.pointsLength; j++) {\n      //interleave the data\n      const packedBase = (base[l - 1] * 2) / 3;\n      const idx = j * packedStride + packedBase + n * 2;\n      const src = j * 3;\n      packedData[idx] =\n        float32ToFloat16(shAttributes[i].typedArray[src]) |\n        (float32ToFloat16(shAttributes[i].typedArray[src + 1]) << 16);\n      packedData[idx + 1] = float32ToFloat16(\n        shAttributes[i].typedArray[src + 2],\n      );\n    }\n  }\n  return packedData;\n}\n\n/**\n * Creates a new instance of {@link GaussianSplat3DTileContent} from a glTF or glb resource.\n *\n * @param {Cesium3DTileset} tileset - The tileset that this content belongs to.\n * @param {Cesium3DTile} tile - The tile that this content belongs to.\n * @param {Resource|string} resource - The resource or URL of the glTF or glb file.\n * @param {object|Uint8Array} gltf - The glTF JSON object or a Uint8Array containing the glb binary data.\n * @returns {GaussianSplat3DTileContent} A new GaussianSplat3DTileContent instance.\n * @throws {RuntimeError} If the glTF or glb fails to load.\n * @private\n */\nGaussianSplat3DTileContent.fromGltf = async function (\n  tileset,\n  tile,\n  resource,\n  gltf,\n) {\n  const basePath = resource;\n  const baseResource = Resource.createIfNeeded(basePath);\n\n  const loaderOptions = {\n    releaseGltfJson: false,\n    upAxis: Axis.Y,\n    forwardAxis: Axis.Z,\n  };\n\n  if (defined(gltf.asset)) {\n    loaderOptions.gltfJson = gltf;\n    loaderOptions.baseResource = baseResource;\n    loaderOptions.gltfResource = baseResource;\n  } else if (gltf instanceof Uint8Array) {\n    loaderOptions.typedArray = gltf;\n    loaderOptions.baseResource = baseResource;\n    loaderOptions.gltfResource = baseResource;\n  } else {\n    loaderOptions.gltfResource = Resource.createIfNeeded(gltf);\n  }\n\n  const loader = new GltfLoader(loaderOptions);\n\n  try {\n    await loader.load();\n  } catch (error) {\n    loader.destroy();\n    throw new RuntimeError(`Failed to load glTF: ${error.message}`);\n  }\n\n  return new GaussianSplat3DTileContent(loader, tileset, tile, resource);\n};\n\n/**\n * Updates the content of the tile and prepares it for rendering.\n * @param {Cesium3DTileset}￼Data attribution\n * @param {FrameState} frameState - The current frame state.\n * @private\n */\nGaussianSplat3DTileContent.prototype.update = function (primitive, frameState) {\n  const loader = this._loader;\n\n  if (this._ready) {\n    if (!this._transformed && primitive.root.content.ready) {\n      GaussianSplatPrimitive.transformTile(this._tile);\n      this._transformed = true;\n    }\n\n    return;\n  }\n\n  frameState.afterRender.push(() => true);\n\n  if (!defined(loader)) {\n    this._ready = true;\n    return;\n  }\n\n  if (this._resourcesLoaded) {\n    this.gltfPrimitive = loader.components.scene.nodes[0].primitives[0];\n    this.worldTransform = loader.components.scene.nodes[0].matrix;\n    this._ready = true;\n\n    this._positions = new Float32Array(\n      ModelUtility.getAttributeBySemantic(\n        this.gltfPrimitive,\n        VertexAttributeSemantic.POSITION,\n      ).typedArray,\n    );\n\n    this._rotations = new Float32Array(\n      ModelUtility.getAttributeBySemantic(\n        this.gltfPrimitive,\n        VertexAttributeSemantic.ROTATION,\n      ).typedArray,\n    );\n\n    this._scales = new Float32Array(\n      ModelUtility.getAttributeBySemantic(\n        this.gltfPrimitive,\n        VertexAttributeSemantic.SCALE,\n      ).typedArray,\n    );\n\n    const { l, n } = degreeAndCoefFromAttributes(this.gltfPrimitive.attributes);\n    this._sphericalHarmonicsDegree = l;\n    this._sphericalHarmonicsCoefficientCount = n;\n\n    this._packedSphericalHarmonicsData = packSphericalHarmonicsData(this);\n\n    return;\n  }\n\n  this._resourcesLoaded = loader.process(frameState);\n};\n/**\n * Returns whether the feature has this property.\n *\n * @param {number} batchId The batchId for the feature.\n * @param {string} name The case-sensitive name of the property.\n * @returns {boolean} <code>true</code> if the feature has this property; otherwise, <code>false</code>.\n */\nGaussianSplat3DTileContent.prototype.hasProperty = function (batchId, name) {\n  return false;\n};\n\n/**\n * Returns the {@link Cesium3DTileFeature} object for the feature with the\n * given <code>batchId</code>.  This object is used to get and modify the\n * feature's properties.\n * <p>\n * Features in a tile are ordered by <code>batchId</code>, an index used to retrieve their metadata from the batch table.\n * </p>\n *\n * @see {@link https://github.com/CesiumGS/3d-tiles/tree/main/specification/TileFormats/BatchTable}.\n *\n * @param {number} batchId The batchId for the feature.\n * @returns {Cesium3DTileFeature} The corresponding {@link Cesium3DTileFeature} object.\n *\n * @exception {DeveloperError} batchId must be between zero and {@link Cesium3DTileContent#featuresLength} - 1.\n */\nGaussianSplat3DTileContent.prototype.getFeature = function (batchId) {\n  return undefined;\n};\n/**\n     * Called when {@link Cesium3DTileset#debugColorizeTiles} changes.\n     * <p>\n     * This is used to implement the <code>Cesium3DTileContent</code> interface, but is\n     * not part of the public Cesium API.\n     * </p>\n     *\n     * @param {boolean} enabled Whether to enable or disable debug settings.\n     * @returns {Cesium3DTileFeature} The corresponding {@link Cesium3DTileFeature} object.\n\n     * @private\n     */\nGaussianSplat3DTileContent.prototype.applyDebugSettings = function (\n  enabled,\n  color,\n) {};\n/**\n * Apply a style to the content\n * <p>\n * This is used to implement the <code>Cesium3DTileContent</code> interface, but is\n * not part of the public Cesium API.\n * </p>\n *\n * @param {Cesium3DTileStyle} style The style.\n *\n * @private\n */\nGaussianSplat3DTileContent.prototype.applyStyle = function (style) {};\n/**\n * Find an intersection between a ray and the tile content surface that was rendered. The ray must be given in world coordinates.\n *\n * @param {Ray} ray The ray to test for intersection.\n * @param {FrameState} frameState The frame state.\n * @param {Cartesian3|undefined} [result] The intersection or <code>undefined</code> if none was found.\n * @returns {Cartesian3|undefined} The intersection or <code>undefined</code> if none was found.\n *\n * @private\n */\nGaussianSplat3DTileContent.prototype.pick = function (ray, frameState, result) {\n  return undefined;\n};\n/**\n * Returns true if this object was destroyed; otherwise, false.\n * <br /><br />\n * If this object was destroyed, it should not be used; calling any function other than\n * <code>isDestroyed</code> will result in a {@link DeveloperError} exception.\n * <p>\n * This is used to implement the <code>Cesium3DTileContent</code> interface, but is\n * not part of the public Cesium API.\n * </p>\n *\n * @returns {boolean} <code>true</code> if this object was destroyed; otherwise, <code>false</code>.\n *\n * @see Cesium3DTileContent#destroy\n *\n * @private\n */\nGaussianSplat3DTileContent.prototype.isDestroyed = function () {\n  return this.isDestroyed;\n};\n\n/**\n * Frees the resources used by this object.\n * @private\n */\nGaussianSplat3DTileContent.prototype.destroy = function () {\n  this.splatPrimitive = undefined;\n\n  if (\n    defined(this._tileset.gaussianSplatPrimitive) &&\n    !this._tileset.gaussianSplatPrimitive.isDestroyed()\n  ) {\n    this._tileset.gaussianSplatPrimitive.destroy();\n  }\n  this._tileset.gaussianSplatPrimitive = undefined;\n\n  this._tile = undefined;\n  this._tileset = undefined;\n  this._resource = undefined;\n  this._ready = false;\n  this._group = undefined;\n  this._metadata = undefined;\n  this._resourcesLoaded = false;\n\n  if (defined(this._loader)) {\n    this._loader.destroy();\n    this._loader = undefined;\n  }\n\n  return destroyObject(this);\n};\n\nexport default GaussianSplat3DTileContent;\n"],"mappings":"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CA;AACA;AACA;AACA;AACA;EACElB,OAAO,EAAE;IACP+B,GAAG,EAAE,SAAAA,CAAA,EAAY;MACf,OAAO,IAAI,CAAC5B,QAAQ;IACtB;EACF,CAAC;EACD;AACF;AACA;AACA;AACA;AACA;AACA;EACEF,IAAI,EAAE;IACJ8B,GAAG,EAAE,SAAAA,CAAA,EAAY;MACf,OAAO,IAAI,CAAC3B,KAAK;IACnB;EACF,CAAC;EACD;AACF;AACA;AACA;AACA;AACA;AACA;EACE8C,GAAG,EAAE;IACHnB,GAAG,EAAE,SAAAA,CAAA,EAAY;MACf,OAAO,IAAI,CAAC1B,SAAS,CAAC8C,eAAe,CAAC,IAAI,CAAC;IAC7C;EACF,CAAC;EACD;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACEC,UAAU,EAAE;IACVrB,GAAG,EAAE,SAAAA,CAAA,EAAY;MACf,OAAOtB,SAAS;IAClB;EACF,CAAC;EACD;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACE4C,QAAQ,EAAE;IACRtB,GAAG,EAAE,SAAAA,CAAA,EAAY;MACf,OAAO,IAAI,CAAChB,SAAS;IACvB,CAAC;IACDuC,GAAG,EAAE,SAAAA,CAAUC,KAAK,EAAE;MACpB,IAAI,CAACxC,SAAS,GAAGwC,KAAK;IACxB;EACF,CAAC;EACD;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACEC,KAAK,EAAE;IACLzB,GAAG,EAAE,SAAAA,CAAA,EAAY;MACf,OAAO,IAAI,CAACf,MAAM;IACpB,CAAC;IACDsC,GAAG,EAAE,SAAAA,CAAUC,KAAK,EAAE;MACpB,IAAI,CAACvC,MAAM,GAAGuC,KAAK;IACrB;EACF,CAAC;EAED;AACF;AACA;AACA;AACA;EACEE,SAAS,EAAE;IACT1B,GAAG,EAAE,SAAAA,CAAA,EAAY;MACf,OAAO,IAAI,CAACvB,UAAU;IACxB;EACF,CAAC;EACD;AACF;AACA;AACA;AACA;EACEkD,SAAS,EAAE;IACT3B,GAAG,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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}