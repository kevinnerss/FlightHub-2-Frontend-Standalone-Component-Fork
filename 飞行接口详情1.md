
# 获取飞行任务信息

## OpenAPI Specification

```yaml
openapi: 3.0.1
info:
  title: ''
  description: ''
  version: 1.0.0
paths:
  /openapi/v0.1/flight-task/{task_uuid}:
    get:
      summary: 获取飞行任务信息
      deprecated: false
      description: 获取飞行任务信息，开启航线任务飞行后，可通过此接口获取任务信息，任务运行过程中的状态，以及任务产生的媒体文件信息等。
      tags:
        - 任务管理
      parameters:
        - name: task_uuid
          in: path
          description: 任务UUID，创建飞行任务成功后，会返回任务UUID。
          required: true
          example: 89328e80-04ee-4089-9482-6bb00ec6bede
          schema:
            type: string
        - name: X-Request-Id
          in: header
          description: 请求唯一标识
          required: false
          example: '{{$string.uuid}}'
          schema:
            type: string
            format: uuid
            default: '{{$string.uuid}}'
        - name: X-Language
          in: header
          description: ''
          example: zh
          schema:
            type: string
            enum:
              - zh
              - en
            x-apifox-enum:
              - value: zh
                name: ''
                description: 简体中文
              - value: en
                name: ''
                description: 英文
        - name: X-Project-Uuid
          in: header
          description: 项目编号
          example: '{{X-Project-Uuid}}'
          schema:
            type: string
            default: '{{X-Project-Uuid}}'
        - name: X-User-Token
          in: header
          description: X-User-Token
          required: false
          example: '{x-user-token}'
          schema:
            type: string
            default: '{x-user-token}'
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    description: 非0代表异常
                  message:
                    type: string
                    description: 消息提示
                  data:
                    type: object
                    properties:
                      name:
                        type: string
                        description: 任务名称
                      uuid:
                        type: string
                        description: 任务UUID
                      task_type:
                        type: string
                        description: 任务类型：当前仅支持即时任务
                        enum:
                          - immediate
                        x-apifox-enum:
                          - value: immediate
                            name: ''
                            description: 立即任务
                      status:
                        type: string
                        enum:
                          - waiting
                          - starting_failure
                          - executing
                          - paused
                          - terminated
                          - success
                          - suspended
                          - timeout
                        x-apifox-enum:
                          - value: waiting
                            name: ''
                            description: 待开始
                          - value: starting_failure
                            name: ''
                            description: 启动失败
                          - value: executing
                            name: ''
                            description: 执行中
                          - value: paused
                            name: ''
                            description: 暂停
                          - value: terminated
                            name: ''
                            description: 终止
                          - value: success
                            name: ''
                            description: 成功
                          - value: suspended
                            name: ''
                            description: 挂起
                          - value: timeout
                            name: ''
                            description: 超时
                      sn:
                        type: string
                        description: 机场sn
                      wayline_uuid:
                        type: string
                        description: 航线uuid
                      begin_at:
                        type: string
                        description: 任务计划执行时间
                      end_at:
                        type: string
                        description: 任务计划结束时间
                      out_of_control_action_in_flight:
                        type: string
                        description: 丢失信号后无人机动作
                        enum:
                          - return_home
                          - continue_task
                        x-apifox-enum:
                          - value: return_home
                            name: ''
                            description: 返航
                          - value: continue_task
                            name: ''
                            description: 继续执行
                      rth_altitude:
                        type: integer
                        description: 返航高度
                      rth_mode:
                        type: string
                        description: 返航模式
                        enum:
                          - optimal
                          - preset
                        x-apifox-enum:
                          - value: optimal
                            name: ''
                            description: 智能高度
                          - value: preset
                            name: ''
                            description: 设定高度
                      resumable_status:
                        type: string
                        description: 自动断点续飞
                        enum:
                          - auto
                          - manual
                        x-apifox-enum:
                          - value: auto
                            name: ''
                            description: 自动断点续飞
                          - value: manual
                            name: ''
                            description: 手动断点续飞
                      folder_info:
                        type: object
                        properties:
                          folder_id:
                            type: integer
                            description: 资源文件夹编号
                          expected_file_count:
                            type: integer
                            description: 任务产生的媒体数量
                          uploaded_file_count:
                            type: integer
                            description: 已经上传到司空的媒体数量
                        required:
                          - folder_id
                          - expected_file_count
                          - uploaded_file_count
                        x-apifox-orders:
                          - folder_id
                          - expected_file_count
                          - uploaded_file_count
                      repeat_type:
                        type: string
                        description: 任务重复模式
                        enum:
                          - nonrepeating
                          - daily
                          - weekly
                          - absolute_monthly
                          - relative_monthly
                        x-apifox-enum:
                          - value: nonrepeating
                            name: ''
                            description: 不重复 默认
                          - value: daily
                            name: ''
                            description: 每几天
                          - value: weekly
                            name: ''
                            description: 每几周
                          - value: absolute_monthly
                            name: ''
                            description: 每几月（按日期）
                          - value: relative_monthly
                            name: ''
                            description: 每几月(按星期)
                      interval:
                        type: integer
                        description: '重复间隔时间: 最小1'
                        minimum: 1
                      days_of_month:
                        type: array
                        items:
                          type: integer
                          minimum: 1
                          maximum: 31
                        description: 每月执行日数组，每月第几天，1-31
                      days_of_week:
                        type: array
                        items:
                          type: integer
                          minimum: 0
                          maximum: 6
                        description: 每周执行日数组，每周第几天，0-6，0=周日，1=周一
                      week_of_month:
                        type: integer
                        description: 每月第几周，1-4
                        minimum: 1
                        maximum: 4
                      recurring_task_start_time_list:
                        type: array
                        items:
                          type: integer
                        description: 重复任务的多个执行时间，秒级时间戳
                        uniqueItems: true
                      continuous_task_periods:
                        type: array
                        items:
                          type: array
                          items:
                            type: integer
                            description: 秒级时间戳
                          minItems: 2
                          maxItems: 2
                          uniqueItems: true
                          description: 时间段：[开始，结束]
                        description: 连续任务的多个执行时段
                      min_battery_capacity:
                        type: integer
                        minimum: 50
                        maximum: 100
                        description: 连续执行最低执行电量
                    required:
                      - name
                      - uuid
                      - status
                      - sn
                      - wayline_uuid
                      - begin_at
                      - end_at
                      - out_of_control_action_in_flight
                      - rth_altitude
                      - rth_mode
                      - resumable_status
                      - folder_info
                      - repeat_type
                      - interval
                      - days_of_month
                      - days_of_week
                      - week_of_month
                      - recurring_task_start_time_list
                      - continuous_task_periods
                      - min_battery_capacity
                    x-apifox-orders:
                      - name
                      - uuid
                      - task_type
                      - sn
                      - wayline_uuid
                      - rth_mode
                      - rth_altitude
                      - out_of_control_action_in_flight
                      - status
                      - resumable_status
                      - begin_at
                      - end_at
                      - folder_info
                      - repeat_type
                      - interval
                      - days_of_month
                      - days_of_week
                      - week_of_month
                      - recurring_task_start_time_list
                      - continuous_task_periods
                      - min_battery_capacity
                required:
                  - code
                  - message
                  - data
                x-apifox-orders:
                  - code
                  - message
                  - data
              example:
                code: 0
                message: success
                data:
                  name: 新建计划1
                  uuid: 0bbc74b4-5e5a-4390-9256-8e4ee08a241b
                  task_type: immediate
                  status: success
                  sn: 7CTDM3D00BZNVZ
                  wayline_uuid: 6eb90ac7-4ec8-4a2c-a470-746e7444e77c
                  begin_at: '2024-10-29T16:51:47.818707+08:00'
                  end_at: '2024-10-29T16:53:58.818707+08:00'
                  out_of_control_action_in_flight: return_home
                  rth_altitude: 100
                  rth_mode: preset
                  resumable_status: manual
          headers: {}
          x-apifox-name: 成功
        '401':
          description: ''
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    description: 非0代表异常
                  message:
                    type: string
                    description: 消息提示
                x-apifox-orders:
                  - code
                  - message
                x-apifox-refs: {}
                required:
                  - code
                  - message
              example:
                code: 200401
                message: Unauthorized
                data: null
          headers: {}
          x-apifox-name: 未授权
      security: []
      x-apifox-folder: 任务管理
      x-apifox-status: released
      x-run-in-apifox: https://app.apifox.com/web/project/5271812/apis/api-221842041-run
components:
  schemas: {}
  securitySchemes: {}
servers:
  - url: https://es-flight-api-cn.djigate.com
    description: 对外文档使用，勿动！！
security: []

```
# 获取飞行任务列表

## OpenAPI Specification

```yaml
openapi: 3.0.1
info:
  title: ''
  description: ''
  version: 1.0.0
paths:
  /openapi/v0.1/flight-task/list:
    get:
      summary: 获取飞行任务列表
      deprecated: false
      description: 获取飞行任务列表，可通过传入任务时间，任务开始时间，任务结束时间，任务类型和任务状态作为过滤器获取飞行任务列表。
      tags:
        - 任务管理
      parameters:
        - name: sn
          in: query
          description: 设备SN
          required: true
          schema:
            type: string
        - name: name
          in: query
          description: 任务名称，非必填。
          required: false
          schema:
            type: string
        - name: begin_at
          in: query
          description: 任务开始时间戳
          required: true
          schema:
            type: number
        - name: end_at
          in: query
          description: 任务结束时间戳
          required: true
          schema:
            type: number
        - name: task_type
          in: query
          description: 任务类型：immediate，timed，recurring，continuous，非必填，不填写则为全部类型
          required: false
          schema:
            type: string
            enum:
              - immediate
              - timed
              - recurring
              - continuous
            x-apifox-enum:
              - value: immediate
                name: ''
                description: 立即任务
              - value: timed
                name: ''
                description: 单次定时任务
              - value: recurring
                name: ''
                description: 重复任务
              - value: continuous
                name: ''
                description: 连续任务
        - name: status
          in: query
          description: >-
            任务状态数组：waiting,starting_failure,executing,paused,terminated,success,suspended,timeout，非必填，不填写则为全部状态
          required: false
          example:
            - ''
          schema:
            type: array
            items:
              type: string
        - name: X-Request-Id
          in: header
          description: 请求唯一标识
          required: false
          example: '{{$string.uuid}}'
          schema:
            type: string
            format: uuid
            default: '{{$string.uuid}}'
        - name: X-Language
          in: header
          description: ''
          example: zh
          schema:
            type: string
            enum:
              - zh
              - en
            x-apifox-enum:
              - value: zh
                name: ''
                description: 简体中文
              - value: en
                name: ''
                description: 英文
        - name: X-Project-Uuid
          in: header
          description: 项目编号
          example: '{{X-Project-Uuid}}'
          schema:
            type: string
            default: '{{X-Project-Uuid}}'
        - name: X-User-Token
          in: header
          description: X-User-Token
          required: false
          example: '{x-user-token}'
          schema:
            type: string
            default: '{x-user-token}'
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    description: 非0代表异常
                  message:
                    type: string
                    description: 消息提示
                  data:
                    type: object
                    properties:
                      list:
                        type: array
                        items:
                          type: object
                          properties:
                            name:
                              type: string
                              description: 任务名称
                            uuid:
                              type: string
                              description: 任务ID
                            task_type:
                              type: string
                              description: 任务类型：immediate，repeated，single_timed
                            status:
                              type: string
                              description: 任务状态
                              enum:
                                - waiting
                                - starting_failure
                                - executing
                                - paused
                                - terminated
                                - success
                                - suspended
                                - timeout
                              x-apifox-enum:
                                - value: waiting
                                  name: ''
                                  description: 待开始
                                - value: starting_failure
                                  name: ''
                                  description: 启动失败
                                - value: executing
                                  name: ''
                                  description: 执行中
                                - value: paused
                                  name: ''
                                  description: 暂停
                                - value: terminated
                                  name: ''
                                  description: 终止
                                - value: success
                                  name: ''
                                  description: 成功
                                - value: suspended
                                  name: ''
                                  description: 挂起
                                - value: timeout
                                  name: ''
                                  description: 超时
                            sn:
                              type: string
                              description: 执行任务的设备SN
                            landing_dock_sn:
                              type: string
                              description: 任务降落的设备SN，若为空则表示仅使用一个设备
                            begin_at:
                              type: string
                              description: 任务设定的开始时间
                            end_at:
                              type: string
                              description: 任务设定的结束时间
                            run_at:
                              type: string
                              description: 任务实际执行的时间
                            completed_at:
                              type: string
                              description: 任务实际完成的时间
                            wayline_uuid:
                              type: string
                              description: 任务执行航线ID
                            folder_id:
                              type: integer
                              description: 任务关联的媒体文件夹ID
                            current_waypoint_index:
                              type: integer
                              description: 任务已经飞完的航点数量
                            total_waypoints:
                              type: integer
                              description: 任务的总航点数量
                            media_upload_status:
                              type: string
                              description: 媒体上传状态：to_upload，uploading，upload_finished
                            resumable_status:
                              type: string
                              description: 断点续飞状态：‘’-不可续飞，auto-自动续飞，manual-手动续飞
                            is_break_point_resume:
                              type: boolean
                              description: 是否为断点续飞任务
                            operations:
                              type: object
                              properties:
                                operator_account:
                                  type: string
                                  description: 任务操作者账号
                              required:
                                - operator_account
                              x-apifox-orders:
                                - operator_account
                              description: 任务操作记录
                            exceptions:
                              type: object
                              properties:
                                code:
                                  type: integer
                                  description: 任务执行错误码
                                message:
                                  type: string
                                  description: 错误信息
                                happen_at:
                                  type: string
                                  description: 错误发生的时间
                                sn:
                                  type: string
                                  description: 错误发生的设备
                              required:
                                - code
                                - message
                                - happen_at
                                - sn
                              x-apifox-orders:
                                - code
                                - message
                                - happen_at
                                - sn
                              description: 异常信息
                          x-apifox-orders:
                            - name
                            - uuid
                            - task_type
                            - status
                            - sn
                            - landing_dock_sn
                            - begin_at
                            - end_at
                            - run_at
                            - completed_at
                            - wayline_uuid
                            - folder_id
                            - current_waypoint_index
                            - total_waypoints
                            - media_upload_status
                            - resumable_status
                            - is_break_point_resume
                            - operations
                            - exceptions
                    required:
                      - list
                    x-apifox-orders:
                      - list
                required:
                  - code
                  - message
                  - data
                x-apifox-orders:
                  - code
                  - message
                  - data
              example:
                code: 0
                message: OK
                data:
                  list:
                    - name: ''
                      uuid: ''
                      task_type: ''
                      status: ''
                      sn: ''
                      landing_dock_sn: ''
                      begin_at: ''
                      end_at: ''
                      run_at: ''
                      completed_at: ''
                      wayline_uuid: ''
                      folder_id: 123
                      current_waypoint_index: 1
                      total_waypoints: 3
                      media_upload_status: ''
                      resumable_status: ''
                      is_break_point_resume: true
                      operations:
                        operator_account: ''
                      exceptions:
                        code: 20000
                        message: ''
                        happen_at: ''
                        sn: ''
          headers: {}
          x-apifox-name: 成功
      security: []
      x-apifox-folder: 任务管理
      x-apifox-status: released
      x-run-in-apifox: https://app.apifox.com/web/project/5271812/apis/api-257466498-run
components:
  schemas: {}
  securitySchemes: {}
servers:
  - url: https://es-flight-api-cn.djigate.com
    description: 对外文档使用，勿动！！
security: []

```
# 获取飞行任务产生的媒体资源

## OpenAPI Specification

```yaml
openapi: 3.0.1
info:
  title: ''
  description: ''
  version: 1.0.0
paths:
  /openapi/v0.1/flight-task/{task_uuid}/media:
    get:
      summary: 获取飞行任务产生的媒体资源
      deprecated: false
      description: |-
        获取飞行任务产生的媒体资源。

        :::tip[]
        - 当前支持 image、video、ppk 类型的资源。
        - 最多返回前 10000 个资源。
        :::
      tags:
        - 任务管理
      parameters:
        - name: task_uuid
          in: path
          description: ''
          required: true
          schema:
            type: string
        - name: X-Request-Id
          in: header
          description: 请求唯一标识
          required: false
          example: '{{$string.uuid}}'
          schema:
            type: string
            format: uuid
            default: '{{$string.uuid}}'
        - name: X-Language
          in: header
          description: ''
          example: zh
          schema:
            type: string
            enum:
              - zh
              - en
            x-apifox-enum:
              - value: zh
                name: ''
                description: 简体中文
              - value: en
                name: ''
                description: 英文
        - name: X-Project-Uuid
          in: header
          description: 项目编号
          example: '{{X-Project-Uuid}}'
          schema:
            type: string
            default: '{{X-Project-Uuid}}'
        - name: X-User-Token
          in: header
          description: X-User-Token
          required: false
          example: '{x-user-token}'
          schema:
            type: string
            default: '{x-user-token}'
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    description: 非0代表异常
                  message:
                    type: string
                    description: 消息提示
                  data:
                    type: object
                    properties:
                      list:
                        type: array
                        items:
                          type: object
                          properties:
                            uuid:
                              type: string
                              description: 媒体文件的UUID
                            name:
                              type: string
                              description: 媒体文件的名称
                            file_type:
                              type: string
                              description: 媒体文件的后缀
                            suffix:
                              type: string
                              description: 媒体文件的后缀
                            size:
                              type: integer
                              description: 媒体文件大小
                            preview_url:
                              type: string
                              title: 预览图片链接
                              description: |-
                                - image:  200*200 小图;
                                - video: 200*200 小图;
                                - ppk: 空;
                            original_url:
                              type: string
                              title: 原图下载链接
                            create_at:
                              type: string
                              description: 媒体文件创建时间
                            update_at:
                              type: string
                              description: 媒体文件更新时间
                          required:
                            - uuid
                            - name
                            - file_type
                            - suffix
                            - size
                            - preview_url
                            - original_url
                            - create_at
                            - update_at
                          x-apifox-orders:
                            - uuid
                            - name
                            - file_type
                            - suffix
                            - size
                            - preview_url
                            - original_url
                            - create_at
                            - update_at
                    required:
                      - list
                    x-apifox-orders:
                      - list
                required:
                  - code
                  - message
                  - data
                x-apifox-orders:
                  - code
                  - message
                  - data
              example:
                code: 0
                message: success
                data:
                  list:
                    - uuid: d47f920a-4116-4c24-90c6-cabaecbf4212
                      name: DJI_20241029165242_0001_T
                      file_type: image
                      suffix: .jpeg
                      size: 1163264
                      preview_url: >-
                        http://47.96.144.147:30802/file-storage-privatization/thumbnail/v1/w200_h200/671d29c2-6c1a-4829-8afe-03ce73ac3056/0bbc74b4-5e5a-4390-9256-8e4ee08a241b/DJI_202410291651_019_0bbc74b4-5e5a-4390-9256-8e4ee08a241b-flyto/DJI_20241029165242_0001_T.jpeg?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=minio_admin%2F20241030%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20241030T034044Z&X-Amz-Expires=900&X-Amz-SignedHeaders=host&response-expires=Thu%2C%2031%20Oct%202024%2003%3A40%3A44%20GMT&x-id=GetObject&X-Amz-Signature=45e47c789323392c29f01765579ae83183a810f5ecbe45d7ea62f69d7a38a225
                      original_url: >-
                        http://47.96.144.147:30802/file-storage-privatization/671d29c2-6c1a-4829-8afe-03ce73ac3056/0bbc74b4-5e5a-4390-9256-8e4ee08a241b/DJI_202410291651_019_0bbc74b4-5e5a-4390-9256-8e4ee08a241b-flyto/DJI_20241029165242_0001_T.jpeg?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=minio_admin%2F20241030%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20241030T034044Z&X-Amz-Expires=900&X-Amz-SignedHeaders=host&response-content-disposition=attachment%3Bfilename%3D%22DJI_20241029165242_0001_T.jpeg%22&response-expires=Thu%2C%2031%20Oct%202024%2003%3A40%3A44%20GMT&x-id=GetObject&X-Amz-Signature=8b13f5c0ec5cbce6adb78a9f6bf9a393881b17e3c4e7d3f9a25cc4cd30a2f099
                      create_at: '2024-10-29T16:52:42+08:00'
                      update_at: '2024-10-29T16:52:55.180675+08:00'
          headers: {}
          x-apifox-name: 成功
      security: []
      x-apifox-folder: 任务管理
      x-apifox-status: released
      x-run-in-apifox: https://app.apifox.com/web/project/5271812/apis/api-225707532-run
components:
  schemas: {}
  securitySchemes: {}
servers:
  - url: https://es-flight-api-cn.djigate.com
    description: 对外文档使用，勿动！！
security: []

```
